--// SERVICES
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer

--// EXECUTOR REQUEST FUNCTION
local Request = (syn and syn.request)
	or http_request
	or request
	or (fluxus and fluxus.request)

if not Request then
	player:Kick("Executor not supported")
	return
end

--// API URL
local API_URL = "https://han2343.pythonanywhere.com/check"

--// KEY HARUS DIISI DARI LUAR SCRIPT
if typeof(script_key) ~= "string" or script_key == "" then
	player:Kick("‚ùå Key is required")
	return
end

--// FUNCTION NOTIFIKASI
local function ShowNotification(text)
	local playerGui = player:WaitForChild("PlayerGui")
	if playerGui:FindFirstChild("NexaNotify") then
		playerGui.NexaNotify:Destroy()
	end

	local gui = Instance.new("ScreenGui", playerGui)
	gui.Name = "NexaNotify"

	local frame = Instance.new("Frame", gui)
	frame.Size = UDim2.new(0, 300, 0, 60)
	frame.Position = UDim2.new(0.5, 0, 0, -80)
	frame.AnchorPoint = Vector2.new(0.5, 0)
	frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	frame.BorderColor3 = Color3.fromRGB(60, 60, 60)
	Instance.new("UICorner", frame)

	local label = Instance.new("TextLabel", frame)
	label.Size = UDim2.new(1, -20, 1, 0)
	label.Position = UDim2.new(0, 10, 0, 0)
	label.BackgroundTransparency = 1
	label.TextWrapped = true
	label.Font = Enum.Font.Code
	label.TextSize = 14
	label.TextColor3 = Color3.fromRGB(255, 130, 0)
	label.Text = text

	TweenService:Create(frame, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {
		Position = UDim2.new(0.5, 0, 0, 40)
	}):Play()

	task.delay(2, function()
		TweenService:Create(frame, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {
			Position = UDim2.new(0.5, 0, 0, -80)
		}):Play()
		task.wait(0.3)
		gui:Destroy()
	end)
end

--// REQUEST CHECK KE SERVER
local response = Request({
	Url = API_URL .. "?user_id=" .. player.UserId .. "&key=" .. script_key,
	Method = "GET",
	Headers = {
		["Content-Type"] = "application/json"
	}
})

if not response or not response.Body then
	ShowNotification("‚ùå Gagal terhubung ke server.")
	task.wait(2)
	player:Kick("‚ùå Failed to connect to server")
	return
end

local data = nil
local success, err = pcall(function()
	data = HttpService:JSONDecode(response.Body)
end)
if not success then
	ShowNotification("‚ùå Response server tidak valid.")
	task.wait(2)
	player:Kick("‚ùå Invalid server response")
	return
end

if not data.allowed then
	if data.reason == "user_not_whitelisted" then
		ShowNotification("‚ùå Kamu bukan pengguna Premium.")
		task.wait(2)
		player:Kick("‚ùå You are not whitelisted.")
	elseif data.reason == "invalid_key" then
		ShowNotification("‚ùå Key Premium salah.")
		task.wait(2)
		player:Kick("‚ùå Invalid key.")
	else
		ShowNotification("‚ùå Akses ditolak.")
		task.wait(2)
		player:Kick("‚ùå Access denied.")
	end
	return
end

--// VALID
ShowNotification("üíé Lifetime Premium Access Granted!")
task.wait(1)

pcall(function()
	loadstring(game:HttpGet(
		"https://raw.githubusercontent.com/fewnbhefbevfhevfdfveh/ckhsuciceifgeufhefveyfg/refs/heads/main/jduwgfPREMIUM"
	))()
end)
