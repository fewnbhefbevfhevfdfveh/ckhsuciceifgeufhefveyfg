loadstring(game:HttpGet("https://raw.githubusercontent.com/fewnbhefbevfhevfdfveh/ckhsuciceifgeufhefveyfg/refs/heads/main/fwefefhef%20Gui%20Update"))()
loadstring(game:HttpGet("https://raw.githubusercontent.com/fewnbhefbevfhevfdfveh/ckhsuciceifgeufhefveyfg/refs/heads/main/Webhook%20Fish%20Gui%20dywfywgfwyfvwydgvy"))()
loadstring(game:HttpGet("https://raw.githubusercontent.com/xwvufdwgqudwyfwdvwedyuvwd/gbewufbeufbeugfvr/refs/heads/main/Semua"))()
local MacLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Enow-Development/maclib-extended/refs/heads/main/maclib.lua"))()

-- Deklarasi service dan variabel utama (tidak diubah) jangan di ubah ubah sama sekali
local workspace = workspace
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local LocalPlayer = player -- alias supaya sama dengan LocalPlayer
local MenuRings = workspace["!!! MENU RINGS"]
local PlayerGui = player:WaitForChild("PlayerGui")


-- Anti Afk
local SHOW_EVERY = 15 * 60 -- 15 menit
local SHOW_TIME = 3        -- tampil 3 detik

local UserInputService = game:GetService("UserInputService")

local function showCursor()
    UserInputService.MouseIconEnabled = true
    task.wait(SHOW_TIME)
    UserInputService.MouseIconEnabled = false
end

task.spawn(function()
    while task.wait(SHOW_EVERY) do
        showCursor()
    end
end)


local GameData = {
    -- ================== [View Bobbers] ==================
    Players = game:GetService("Players"),
    RunService = game:GetService("RunService"),
    Camera = workspace.CurrentCamera,
    Player = nil, -- nanti diisi
    UserIdString = nil, -- nanti diisi
    CosmeticFolder = workspace:WaitForChild("CosmeticFolder"),
    ViewBobbersEnabled = false,

   -- ================== [Codes] ==================

    Codes = {
        "1BILLION",
        "LUCKYTOTEM",
        "EXPANSION",
        "CRYSTALS"
    },

   -- ================== [Server Info Discord] ==================

    InviteCode = "ECxQFc97F5",
    DiscordAPI = "",
    ServerInfoParagraph = nil,
    AutoRefresh = false,

    -- ==================[Jenis Ikan v1]==================

        TierMap = {
        [1] = "Common",
        [2] = "Uncommon",
        [3] = "Rare",
        [4] = "Epic",
        [5] = "Legendary",
        [6] = "Mythic",
        [7] = "SECRET"
    },

    TierList = { "Common","Uncommon","Rare","Epic","Legendary","Mythic","SECRET" },

    FishCounter = {
        Common = 0,
        Uncommon = 0,
        Rare = 0,
        Epic = 0,
        Legendary = 0,
        Mythic = 0,
        SECRET = 0
    },

    -- ==================[Jenis Ikan v2]==================
        -- WEBHOOK
    WebhookURL = "",
    WebhookActive = false,
    SelectedTiers = {},
    TierList = {"All","Common","Uncommon","Rare","Epic","Legendary","Mythic","SECRET"},

    -- SERVICES
    Service = {
        Players = game:GetService("Players"),
        ReplicatedStorage = game:GetService("ReplicatedStorage"),
        HttpService = game:GetService("HttpService"),
    },

    -- EXECUTOR REQUEST
    Request = (syn and syn.request)
        or http_request
        or (fluxus and fluxus.request)
        or (krnl and request),

    -- Fishing1 SYSTEM DATA
    TierMap = {
        [1] = "Common",
        [2] = "Uncommon",
        [3] = "Rare",
        [4] = "Epic",
        [5] = "Legendary",
        [6] = "Mythic",
        [7] = "SECRET"
    },

    FishCounter = {
        Common = 0,
        Uncommon = 0,
        Rare = 0,
        Epic = 0,
        Legendary = 0,
        Mythic = 0,
        SECRET = 0
    },

    TierColor = {
        Common = 3092790,
        Uncommon = 5294200,
        Rare = 2061822,
        Epic = 11730944,
        Legendary = 15844367,
        Mythic = 14423100,
        SECRET = 16711853
    },

    LastFishData = nil,

    -- RUN-TIME UI STORAGE
    UI = {},

    -- ================== [Instant Fishing1] ==================

    Players = game:GetService("Players"),
    ReplicatedStorage = game:GetService("ReplicatedStorage"),

    player = game:GetService("Players").LocalPlayer,
    PlayerGui = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui"),

    package = game:GetService("ReplicatedStorage").Packages._Index["sleitnick_net@0.2.0"].net,

    miniggameArgs = {-1.233184814453125, 0.9972056628181873, 1763291794.158201},

    autoFishing1Enabled = false,
    isFishing1 = false,

    castDelay = 1.5,
    completedDelay = 1,

    lastCatchTime = os.clock(),
    antiStuckTime = 10,

    -- ================== [Rod] ==================
    RodIDs = {
        ["Starter Rod"] = 1, ["Luck Rod"] = 79, ["Carbon Rod"] = 76,
        ["Grass Rod"] = 85, ["Demascus Rod"] = 77, ["Ice Rod"] = 78,
        ["Lucky Rod"] = 4, ["Midnight Rod"] = 80, ["Steampunk Rod"] = 6,
        ["Chrome Rod"] = 7, ["Fluorescent Rod"] = 255, ["Astral Rod"] = 5,
        ["Angler Rod"] = 168, ["Ares Rod"] = 126, ["Bamboo Rod"] = 258,
        ["Toy Rod"] = 84, ["Lava Rod"] = 2, ["Hazmat Rod"] = 256,
        ["Ghostfinn Rod"] = 169, ["Element Rod"] = 257, ["Angelic Rod"] = 124,
        ["Gold Rod"] = 8, ["Hyper Rod"] = 9
    },

    -- ================== [Bait] ==================
    BaitIDs = {
        ["Starter Bait"] = 1, ["Luck Bait"] = 2, ["Midnight Bait"] = 3,
        ["Gold Bait"] = 4, ["Hyper Bait"] = 5, ["Chroma Bait"] = 6,
        ["Dark Matter Bait"] = 8, ["Beach Ball Bait"] = 9, ["Topwater Bait"] = 10,
        ["Corrupt Bait"] = 15, ["Aether Bait"] = 16, ["Nature Bait"] = 17,
        ["Singularity Bait"] = 18, ["Royal Bait"] = 19, ["Floral Bait"] = 20
    },

    -- ================== [Boat] ==================
    BoatList = {
        ["Small Boat"] = 1, ["Kayak"] = 2, ["Jetski"] = 3, ["Highfield Boat"] = 4,
        ["Speed Boat"] = 5, ["Fishing1 Boat"] = 6, ["Mini Yacht"] = 14,
        ["Mini Hoverboat"] = 15, ["Hyper Boat"] = 7, ["Dinky Fishing1 Boat"] = 20,
        ["Aura Boat"] = 17, ["Burger Boat"] = 18, ["Mega Hovercraft"] = 19,
        ["Froen Boat"] = 11, ["Cruiser Boat"] = 13, ["Rubber Ducky"] = 16
    },

    -- ================== [Quest] ==================
    Quests = {
        ["Deep Sea"] = {
            Label = MenuRings["Deep Sea Tracker"].Board.Gui.Content:WaitForChild("Label1"),
            PosBelum100 = CFrame.new(-3598.26392, -275.770294, -1641.81677, 0.980732918, 0, -0.195353389, 0, 1, 0, 0.195353389, 0, 0.980732918),
            PosSudah100 = CFrame.new(-3711.07275, -133.551468, -946.792786, 0.496201038, 0, 0.868207633, 0, 1, 0, -0.868207633, 0, 0.496201038)
        },
        ["Element"] = {
            Label = MenuRings["Element Tracker"].Board.Gui.Content:WaitForChild("Label2"),
            PosBelum100 = CFrame.new(2117.75146, -91.1985855, -700.854065, 0.931628525, 0, -0.363411963, 0, 1, 0, 0.363411963, 0, 0.931628525),
            PosSudah100 = CFrame.new(1556.35583, 4.37400525, -605.774841, -0.154411227, 0, 0.988006651, 0, 1, 0, -0.988006651, 0, -0.154411227)
        },
        ["Aura Boat"] = {
            PosTarget = CFrame.new(88.2434769, 9.53157043, 2685.2605),
            MinLevel = 200
        }
    },

    -- ================== [Island] ==================
    Islands = {
    ["Kohana"] = CFrame.new(-642.243561, 16.0354481, 624.918884, 0.999580681, 0, -0.0289562326, 0, 1, 0, 0.0289562326, 0, 0.999580681),
    ["Winter Fest"] = CFrame.new(1687.93079, 6.8625145, 3309.67725, 0.96799022, -3.6394315e-08, -0.250987828, 1.06909646e-08, 1, -1.0377223e-07, 0.250987828, 9.77672059e-08, 0.96799022),
    ["Lost Isle"] = CFrame.new(-3660.07031, 26.1918774, -933.131897, -0.77232331, -7.22959044e-08, -0.635229647, -1.90984206e-08, 1, -9.05904614e-08, 0.635229647, -5.7833244e-08, -0.77232331),
    ["Isoteric Island"] = CFrame.new(2029.47913, 27.3972206, 1393.52319, 0.438848287, -3.30229497e-08, -0.89856118, 8.09404801e-08, 1, 2.55982613e-09, 0.89856118, -7.34489944e-08, 0.438848287),
    ["Crater Island"] = CFrame.new(973.268372, 7.36203814, 4879.09277, 0.99999994, -1.67766032e-08, -0.000279307278, 1.67553038e-08, 1, -7.62482344e-08, 0.000279307278, 7.62435519e-08, 0.99999994),
    ["Coral Reefs"] = CFrame.new(-3134.98511, 20.9564934, 2167.80566, 0.610140502, 5.54546098e-08, -0.792293251, -1.07331415e-08, 1, 6.17270004e-08, 0.792293251, -2.91583468e-08, 0.610140502),
    ["Kohana Volcano"] = CFrame.new(-525.122925, 24.0000591, 187.470749, 0.702778041, -1.4945584e-08, 0.711409211, 1.59372149e-09, 1, 1.18378477e-08, -0.711409211, -1.17821113e-08, 0.702778041),
    ["Fisherman Island"] = CFrame.new(33.5687256, 17.0335217, 2834.95557, 0.999833524, -8.21432367e-10, 0.0182459373, 2.40968401e-09, 1, 8.70248726e-08, -0.0182459373, 8.7054351e-08, 0.999833524),
    ["Esoteric Depths"] = CFrame.new(3152.74707, -1302.72986, 1438.05444, 0.442518562, -2.42594727e-08, -0.896759331, -8.6126515e-09, 1, 1.33023953e-08, 0.896759331, -2.15753335e-08, 0.442518562),
    ["Tropical Grove"] = CFrame.new(-2046.1554, 6.26801682, 3660.56006, -0.739083588, 1.74285066e-08, 0.673613727, -5.79817758e-08, 1, -8.94902854e-08, -0.673613727, -1.05198126e-07, -0.739083588),
    ["Treasure Room"] = CFrame.new(-3599.53491, -266.57373, -1566.98657),
    ["Weather Machine"] = CFrame.new(-1525.72632, 6.49999952, 1892.23645, 0.0615941137, 6.608282509e-10, -0.998101294, -6.8356556e-08, 1, 3.55628549e-09, 0.998101294, 6.84458072e-08, 0.0615941137),
    ["Sisyphus Statue"] = CFrame.new(-3692.22021, -135.574417, -1026.96167, -0.928567886, 9.83784361e-08, 0.371162564, 1.22746741e-07, 1, 4.20307664e-08, -0.371162564, 8.45874197e-08, -0.928567886),
    ["Ancient Jungle"] = CFrame.new(1275.54553, 7.85804176, -193.749756, 0.924119413, 5.65956171e-08, -0.382103801, -3.36512187e-08, 1, 6.67302302e-08, 0.382103801, -4.88084417e-08, 0.924119413),
    ["Underground Cellar Door"] = CFrame.new(1954.18994, -41.7413597, -577.574768, -0.817980289, 0.573604001, 0.0434255376, 0.572797239, 0.81913203, -0.0304316022, -0.0530269668, -1.84206292e-05, -0.998593211),
    ["Underground Cellar"] = CFrame.new(2120.27417, -93.1985779, -701.552185, -0.998591185, 0, 0.0530693457, 0, 1, 0, -0.0530693457, 0, -0.998591185),
    ["Temple Guardian"] = CFrame.new(1478.29846, 126.044891, -613.519653, -0.117893577, 0, 0.993026376, 0, 1, 0, -0.993026376, 0, -0.117893577),
    ["Mysterious Door"] = CFrame.new(1899.19629, 13.3589745, -577.593811, -0.0531117916, 0, -0.998588562, 0, 1, 0, 0.998588562, 0, -0.0531117916),
    ["Hourglass Diamond Artifact"] = CFrame.new(1485.66541, 5.41373634, -861.165161, -5.01871109e-05, 0.988927424, 0.148400292, -1, -5.01871109e-05, -3.74019146e-06, 3.74019146e-06, -0.148400292, 0.988927364),
    ["Arrow Artifact"] = CFrame.new(898.490479, 5.41373587, -361.212708, 9.11951065e-06, 0.0998446345, -0.994003104, -1, 9.11951065e-06, -8.2552433e-06, 8.2552433e-06, 0.994003104, 0.0998445749),
    ["Crescent Artifact"] = CFrame.new(1419.39148, 28.1637344, 79.5802917, 3.55243683e-05, -0.332731277, -0.943021655, -1, -3.55243683e-05, -2.51233578e-05, -2.51233578e-05, 0.943021655, -0.332731247),
    ["Diamond Artifact"] = CFrame.new(1818.72156, 5.41373634, -285.160828, -1.15633011e-05, -0.192806393, 0.981236815, -1, 1.15633011e-05, -9.53674316e-06, -9.53674316e-06, -0.981236815, -0.192806482),
    ["Sacred Temple"] = CFrame.new(1478.09546, 0.0774269104, -612.817993, 0.993017375, 0, 0.117968373, 0, 1, 0, -0.117968373, 0, 0.993017375),
    ["Crystalline Passage"] = CFrame.new(6053.09717, -538.900085, 4391.29102, -0.993590963, -1.39414302e-08, 0.10982503, 1.7823354e-10, 1, -7.10982503, 1.27797193e-07, -0.10982503, -0.993590963),
    ["Ancient Ruin"] = CFrame.new(6130.33203, -584.05603, 4632.95166, -0.171970293, -9.77156915e-08, 0.985102117, -7.319955083e-08, 1, 8.64156533e-08, -0.985102117, -5.722441259e-08, -0.171970293),
    ["Classic Island"] = CFrame.new(1258.37341, 9.999999905, 2811.14819, -0.996284008, -1.96166035e-08, 0.086129114, -2.56321329e-08, 1, -6.87372363e-08, -0.086129114, -7.068394809e-08, -0.996284008),
    ["Iron Cavern"] = CFrame.new(-8802.55762, -583.800049, 94.9271545, 0.539917707, 4.95349006e-08, -0.84171778, 2.88506321e-08, 1, 7.7355935e-08, 0.84171778, -6.60499282e-08, 0.539917707),
    ["Iron Cafe"] = CFrame.new(-8641.91016, -547.400183, 161.963455, -0.0101819877, -4.55452422e-08, -0.999948144, 1.64972356e-08, 1, -4.57155878e-08, 0.999948144, -1.69618559e-08, -0.0101819877),
    },

    -- ==================[Save Posisi] ==================
    rootFolder = "SavedPositions",
    folder = nil,

    SavedPositions = {},
    options = {},

    selectedSlot = nil,
    customSlotName = "",
    teleportEnabled = false,

    LocalPlayer = game.Players.LocalPlayer,
    char = nil,
    hrp = nil,

    SaveDropdown = nil,
    SaveButton = nil,
    DeleteButton = nil,
    RefreshButton = nil,

    bv = nil,
    bg = nil,

    -- ================== [Auto Unclock Ancient Ruin] ==================
    AutoUnlock = false,

    FishList = {
        "Goliath Tiger",
        "Crocodile",
        "Freshwater Piranha",
        "Sacred Guardian Squid"
    },

    -- ================== [Auto Unlock Iron Cafe] ==================
    AutoIronCafe = false,
    TaskIronCafe = nil,

    GuppyList = {
        "Builderman Guppy",
        "Shedletsky Guppy",
        "BFulleyes Guppy",
        "Guest Guppy"
    },

    connection = nil, -- connection event

    Services = {
        TweenService = game:GetService("TweenService"),
        UIS = game:GetService("UserInputService"),
        CoreGui = game:GetService("CoreGui")
    },

        Services = {
        Players = game:GetService("Players")
    },

    WorkspaceData = {
        Vehicles = workspace:WaitForChild("Vehicles")
    },

    StageList = {
        ["rbxassetid://112089909495700"] = "Hourglass Diamond Artifact", -- Stage 1
        ["rbxassetid://108196402536011"] = "Arrow Artifact",             -- Stage 2
        ["rbxassetid://140438616753774"] = "Crescent Artifact",          -- Stage 3
        ["rbxassetid://122936451238995"] = "Diamond Artifact",           -- Stage 4
    },

    Jungle = workspace:WaitForChild("JUNGLE INTERACTIONS"),

    ParagraphStatus = nil, -- nanti diisi setelah dibuat UI-nya

    -- Data tambahan
    targetCFrame = CFrame.new(
        6089.81396, -585.924194, 4637.24023,
        -0.800617278, 5.49377476e-08, 0.599176049,
        6.29061105e-08, 1, -7.63340946e-09,
        -0.599176049, 3.15803952e-08, -0.800617278
    ),

    enabled = false,
    
    -- Placeholder variabel lain
    label = nil,
    hrp = nil,
    paragraph = nil,
    freeze = nil,

    -- ================== [Disco Paragraph] ==================
    DiscoParagraph = nil,
    Root = workspace.ClassicEvent.DiscoEvent.DiscoBall:WaitForChild("Root"),

    DefaultCFrame = CFrame.new(-8625, -426.221008, 161.125, 1, 0, 0, 0, 1, 0, 0, 0, 1),

    IsDiscoNow = false,
    DiscoActive = false,

    -- ================== [Disco Teleport] ==================

    DiscoRoot = workspace.ClassicEvent.DiscoEvent.DiscoBall:WaitForChild("Root"),
    Players = game:GetService("Players"),

    -- ================== [Totems] ==================

    ReplicatedStorage = game:GetService("ReplicatedStorage"),

    -- ================== [Blatant V1] ==================

    RS = game:GetService("ReplicatedStorage"),
    Players = game:GetService("Players"),

    LP = nil,

    net = nil,

    RF_Charge = nil,
    RF_Start = nil,
    RF_Cancel = nil,
    RE_Finish = nil,
    RE_Equip = nil,

    enabled = false,
    CancelDelay = 1.05,
    CompleteDelay = 0.16,

    EquipTool = nil,
    FastFish = nil,
    StartLoop = nil,
    StopLoop = nil,

    -- ================== [Blatant V2] ==================

    SVC = {
        RS = game:GetService("ReplicatedStorage")
    },

    net = nil, -- nanti diisi setelah RS
    RF = {},
    RE = {},

    cutsceneController = nil,
    originalPlay = nil,
    originalStop = nil,

    EnableSkip = nil,
    Fastest = nil,
    startBlatantV2 = nil,

    -- ================== [Treasure] ==================
    Players = game:GetService("Players"),
    Player = nil,
    Character = nil,
    HRP = nil,

    AutoTreasure = false,
    AutoTreasureThread = nil,

    GetAllSunkenModels = nil,
    ProcessOneWreckage = nil,
    AutoTreasureLoop = nil,

    TempList = nil,
    TempTreasure = nil,
    TempShine = nil,
    TempPrompt = nil,

    -- ================== [Event Hunt] ==================

        --// Services
    Players = game:GetService("Players"),
    RS = game:GetService("ReplicatedStorage"),

    -- Player
    player = game:GetService("Players").LocalPlayer,
    char = nil,
    hrp = nil,

    -- Folders
    exclaimFolder = nil,

    -- Event List
    eventsList = {
        "Shark Hunt", "Ghost Shark Hunt", "Worm Hunt",
        "Black Hole", "Shocked", "Ghost Worm",
        "Meteor Rain", "Megalodon Hunt"
    },

    -- Auto settings
    SelectedAutoEvents = {},
    AutoEventPriority = {},
    AutoEventToggle = false,

    savedCFrame = nil,

    -- Runtime objects
    platform = nil,
    atEvent = false,

    -- ================== [SKip Rraity] ==================
        SVC = {
        Players = game:GetService("Players"),
        RS = game:GetService("ReplicatedStorage")
    },

    Player = nil,
    Net = nil,

    RF = {},
    RE = {},

    SkipState = {
        Enabled = false,
        Blacklist = { "Common" }
    },

    BAD_COLORS = {
        Common    = {1, 0.980392, 0.964706},
        Uncommon  = {0.764706, 1, 0.333333},
        Rare      = {0.333333, 0.635294, 1},
        Epic      = {0.678431, 0.309804, 1},
    },

    LastProcessed = {},
    PROCESS_COOLDOWN = 1.0,

    -- ================== [Fishing1 Counter] ==================

    PlayerGui = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui"),

    -- Fishing1 Notification References
    smallNotif = nil,
    display = nil,
    container = nil,
    notifications = nil,
    notifFrame = nil,

    -- Counter numbers
    successCount = 0,
    failCount = 0,

    -- Connections
    successConn = nil,
    failConn = nil,

    -- UI Objects
    Fishing1Counter = nil,

    -- Success Position
    successPos = UDim2.new(0.5, 0, 0.1, 0),

    -- ================== [Image Botton] ==================

    TweenService = game:GetService("TweenService"),
    UIS = game:GetService("UserInputService"),
    CoreGui = game:GetService("CoreGui"),

    ScreenGui = nil,
    ToggleFrame = nil,
    ToggleBtn = nil,

    Corner = nil,
    Gradient = nil,
    Glow = nil,
    Stroke = nil,

    uiVisible = true,

    Dragging = false,
    DragStart = nil,
    StartPos = nil,

    beginDrag = nil,
    updateDrag = nil,
    endDrag = nil,

    -- ================== [Walkspeed, Jump Power, Gravity] ==================

    Player = nil,
    char = nil,
    hum = nil,

    WalkspeedEnabled = false,
    WalkspeedValue = 16,

    JumpEnabled = false,
    JumpValue = 50,

    GravityEnabled = false,
    GravityValue = 196.2,

    -- ================== [Infinite Zoom] ==================

    player = game:GetService("Players").LocalPlayer,
    infiniteZoomEnabled = false,

    -- ================== [Walk On Water] ==================

    Players = game:GetService("Players"),
    RunService = game:GetService("RunService"),

    -- Player data
    player = game:GetService("Players").LocalPlayer,
    character = nil,
    hrp = nil,

    -- Water settings
    waterHeight = -1.8,

    -- Runtime objects
    waterPlatform = nil,
    connection = nil,

    -- ================== [Remove VFX] ==================

    RS = game:GetService("ReplicatedStorage"),
    RunService = game:GetService("RunService"),

    -- VFX Folder
    waterVFXFolder = nil,

    -- Stored VFX Clones
    storedVFX = {},

    -- Connections
    childAddedConn = nil,

    -- ================== [Global Settings] ==================
    userInfoState = nil,
    notifState = nil,
    blurState = nil,
    GS_UserInfo = nil,
    GS_Notifications = nil,
    GS_Blur = nil,

    -- ================== [Window Settings] ==================

    windowWidth = nil,
    windowHeight = nil,
    windowScale = nil,
    currentSize = nil,
    inputValue = nil,

    -- ================== [Toggle Status] ==================
    toggleStatus = {},
    statusLabel = nil,
    activeList = {},

    -- ================== [Anti AFK Time] ==================

    UserInputService = game:GetService("UserInputService"),

    intervalMinutes = 15,
    showSeconds = 10,

    lastInput = tick(),

    AntiAFKParagraph = nil,

    runtime = {
        totalSeconds = 0,
        minutes = 0,
        seconds = 0,
    },

    connections = {
        began = nil,
        changed = nil,
        ended = nil,
    },
}

--====================================================--
-- GAMEDATA 2 (SEMUA LOCAL DIPINDAHKAN KE SINI)
--====================================================--

local GameData2 = {
    -- Deep Sea Tracker
    board = MenuRings["Deep Sea Tracker"].Board,
    surfaceGui = nil,
    content = nil,
    labelNames = {"Label1", "Label2", "Label3", "Label4"},
    deepSeaParagraph = nil,

    -- Aura Boat Tracker
    auraParagraph = nil,

    -- Element Tracker
    boardElement = MenuRings["Element Tracker"].Board,
    contentElement = nil,
    elementLabelNames = {"Label1", "Label2", "Label3", "Label4"},
    elementParagraph = nil
}

local Window = MacLib:Window({
    Title = "NexaHub",
    Subtitle = "Fish It - Premium | V0.0.3",
    Size = UDim2.fromOffset(650, 400),
    DragStyle = 2,
    DisabledWindowControls = {},
    ShowUserInfo = true,
    Keybind = Enum.KeyCode.G,
    AcrylicBlur = true,
})

Window:SetSize(UDim2.fromOffset(650, 400))

Window:SetUserInfoState(true)
GameData.userInfoState = Window:GetUserInfoState()

GameData.GS_UserInfo = Window:GlobalSetting({
    Name = "Hide User Info",
    Default = false,
    Callback = function(state)
        GameData.userInfoState = state
        Window:SetUserInfoState(not GameData.userInfoState)
    end,
})


----------------------------------------------------
-- NOTIFICATIONS STATE
----------------------------------------------------
Window:SetNotificationsState(true)
GameData.notifState = Window:GetNotificationsState()

GameData.GS_Notifications = Window:GlobalSetting({
    Name = "Disable Notifications",
    Default = false,
    Callback = function(state)
        GameData.notifState = state
        Window:SetNotificationsState(not GameData.notifState)
    end,
})


----------------------------------------------------
-- ACRYLIC BLUR STATE
----------------------------------------------------
Window:SetAcrylicBlurState(true)
GameData.blurState = Window:GetAcrylicBlurState()

GameData.GS_Blur = Window:GlobalSetting({
    Name = "Disable Acrylic Blur",
    Default = false,
    Callback = function(state)
        GameData.blurState = state
        Window:SetAcrylicBlurState(not GameData.blurState)
    end,
})

local GameName = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name

Window:Dialog({
    Title = "Support Game " .. GameName .. " | Welcome to " .. GameName,
    Description = "Thank you for using NexaHub! Join our Discord for support and updates.",
    Buttons = {
        {
            Name = "Ok",
            Callback = function()
            end,
        }
    }
})

local tabGroups = {
	TabGroup1 = Window:TabGroup()
}

local tabs = {
    Home = tabGroups.TabGroup1:Tab({ Name = "Home", Image = "rbxassetid://103124389616816" }),
	Fishing1 = tabGroups.TabGroup1:Tab({ Name = "Fishing1", Image = "rbxassetid://97899956724998" }),
    Event = tabGroups.TabGroup1:Tab({ Name = "Event", Image = "rbxassetid://139605405636145" }),
	Quest = tabGroups.TabGroup1:Tab({ Name = "Quest", Image = "rbxassetid://70719631016787" }),
    Auto = tabGroups.TabGroup1:Tab({ Name = "Automatic", Image = "rbxassetid://100691400534443" }),
	Shop = tabGroups.TabGroup1:Tab({ Name = "Shop", Image = "rbxassetid://134257769519180" }),
	Boat = tabGroups.TabGroup1:Tab({ Name = "Boat", Image = "rbxassetid://79620448065359" }),
    Tp = tabGroups.TabGroup1:Tab({ Name = "Teleport", Image = "rbxassetid://124499210049583" }),
	Player = tabGroups.TabGroup1:Tab({ Name = "Player", Image = "rbxassetid://105274848905298" }),
	Config = tabGroups.TabGroup1:Tab({ Name = "Config", Image = "rbxassetid://111411260968321" }),
}
local sections = {
    Home = tabs.Home:Section({ Side = "Full" }),
    Home1 = tabs.Home:Section({ Side = "Full" }),

	Fishing = tabs.Fishing1:Section({ Side = "Full" }),
    Fishing1 = tabs.Fishing1:Section({ Side = "Full" }),
    Fishing2 = tabs.Fishing1:Section({ Side = "Full" }),
    Fishing3 = tabs.Fishing1:Section({ Side = "Full" }),
    Fishing4 = tabs.Fishing1:Section({ Side = "Full" }),
    Fishing5 = tabs.Fishing1:Section({ Side = "Full" }),
    Fishing6 = tabs.Fishing1:Section({ Side = "Full" }),
    Fishing7 = tabs.Fishing1:Section({ Side = "Full" }),
    Fishing8 = tabs.Fishing1:Section({ Side = "Full" }),

    Event = tabs.Event:Section({ Side = "Full" }),
    Event1 = tabs.Event:Section({ Side = "Full" }),

    Quest = tabs.Quest:Section({ Side = "Full" }),
    Quest1 = tabs.Quest:Section({ Side = "Full" }),

    Auto = tabs.Auto:Section({ Side = "Full" }),
    Auto1 = tabs.Auto:Section({ Side = "Full" }),
    Auto2 = tabs.Auto:Section({ Side = "Full" }),

    Shop = tabs.Shop:Section({ Side = "Full" }),
    Shop1 = tabs.Shop:Section({ Side = "Full" }),
    Shop2 = tabs.Shop:Section({ Side = "Full" }),
    Shop3 = tabs.Shop:Section({ Side = "Full" }),
    Shop4 = tabs.Shop:Section({ Side = "Full" }),

    Boat = tabs.Boat:Section({ Side = "Full" }),
    Boat1 = tabs.Boat:Section({ Side = "Full" }),

    Tp = tabs.Tp:Section({ Side = "Full" }),
    Tp1 = tabs.Tp:Section({ Side = "Full" }),

    Player = tabs.Player:Section({ Side = "Full" }),
    Player1 = tabs.Player:Section({ Side = "Full" }),

    Config = tabs.Config:Section({ Side = "Full" }),
}

sections.Home:Header({
	Name = "Redem Code & Reward"
})

local ReplicatedStorage = game:GetService("ReplicatedStorage")

local NetFolder = ReplicatedStorage:WaitForChild("Packages")
	:WaitForChild("_Index")
	:WaitForChild("sleitnick_net@0.2.0")
	:WaitForChild("net")

local RedeemRF = NetFolder:WaitForChild("RF/RedeemCode")

sections.Home:Button({
	Name = "Redeem All Codes",
	Callback = function()

		Window:Notify({
			Title = "Redeem",
			Description = "Redeeming all codes...",
			Lifetime = 3
		})

		for _, code in ipairs(GameData.Codes) do
			task.wait(1)

			local success, result = pcall(function()
				return RedeemRF:InvokeServer(code)
			end)

			if success then
				Window:Notify({
					Title = "Success",
					Description = "Redeemed: " .. code,
					Lifetime = 3
				})
			else
				Window:Notify({
					Title = "Failed",
					Description = "Failed redeem: " .. code,
					Lifetime = 3
				})
			end
		end

		Window:Notify({
			Title = "Done",
			Description = "All redeem codes processed.",
			Lifetime = 4
		})
	end,
})


sections.Home:Button({ 
    Name = "Auto Claim Event Reward", 
    Callback = function()
        local ReplicatedStorage = game:GetService("ReplicatedStorage")

        local remote = ReplicatedStorage
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RE/ClaimEventReward")

        for i = 1, 15 do
            remote:FireServer(i)
            task.wait(0.01) -- aman, optional
        end
    end,
})

GameData.DiscordAPI = "https://discord.com/api/v10/invites/" ..
    GameData.InviteCode ..
    "?with_counts=true&with_expiration=true"

GameData.HttpService = game:GetService("HttpService")


-- BUAT PARAGRAPH UI
GameData.ServerInfoParagraph = sections.Home:Paragraph({
    Header = "Discord Server Info",
    Body = "Click refresh to load."
}, "Info")


-- FUNGSI FETCH DISCORD API
GameData.FetchDiscordInfo = function()
    GameData.success, GameData.Response = pcall(function()
        return GameData.HttpService:JSONDecode(
            (syn and syn.request or http_request or request or fluxus and fluxus.request)({
                Url = GameData.DiscordAPI,
                Method = "GET",
                Headers = {
                    ["User-Agent"] = "RobloxBot/1.0",
                    ["Accept"] = "application/json"
                }
            }).Body
        )
    end)

    if GameData.success
        and GameData.Response
        and GameData.Response.guild
    then
        GameData.ServerInfoParagraph:UpdateHeader(
            "Discord Server: " .. GameData.Response.guild.name
        )

        GameData.ServerInfoParagraph:UpdateBody(
            "Members: " .. tostring(GameData.Response.approximate_member_count) .. "\n" ..
            "Online: " .. tostring(GameData.Response.approximate_presence_count)
        )

    else
        GameData.ServerInfoParagraph:UpdateHeader("Discord Server Info (Error)")
        GameData.ServerInfoParagraph:UpdateBody("Failed to fetch info.\nTry again.")
    end
end


-- BUTTON REFRESH MANUAL
sections.Home:Button({
    Name = "Refresh Server Info",
    Callback = function()
        GameData.ServerInfoParagraph:UpdateBody("Loading...")
        GameData.FetchDiscordInfo()
    end,
})


-- TOGGLE AUTO REFRESH (3 DETIK)
sections.Home:Toggle({
    Name = "Auto Refresh Server Info",
    Default = false,
    Callback = function(value)
        GameData.AutoRefresh = value

        Window:Notify({
            Title = "",
            Description = value and "Auto Refresh Enabled" or "Auto Refresh Disabled"
        })

        -- LOOP AUTO REFRESH
        task.spawn(function()
            while GameData.AutoRefresh do
                GameData.ServerInfoParagraph:UpdateBody("Loading...")
                GameData.FetchDiscordInfo()
                task.wait(3)
            end
        end)
    end,
}, "AutoRefreshServerInfoToggle")

sections.Home1:Paragraph({
    Header = "Update List",
    Body = [[
Tab Player:
 [+] Addded Infinite Zoom
 [+] Added Window Settings 
  - Window Size
  - Window Scale
[+] Added Global Settings 
  - Hide User Info
  - Disable Notifications
  - Disable Acrylic Blur
Tab Fishing1:
 [+] Added Blatant V1
 [+] Added Blatant V2
 [+] Added Dropdwon Select Totems
 [+] Added Auto Spawn Totems
]]
}, "Info")


sections.Fishing1:Header({
	Name = "Status Info Event"
})

-- ============================================================
-- Update HRP ketika respawn
-- ============================================================
local function UpdateHRP(char)
    local newhrp = char:WaitForChild("HumanoidRootPart", 5)
    if newhrp then
        GameData.hrp = newhrp
    end
end

if player.Character then
    UpdateHRP(player.Character)
end

player.CharacterAdded:Connect(function(char)
    task.wait(1)
    UpdateHRP(char)

    if GameData.freeze then
        GameData.freeze:Destroy()
        GameData.freeze = nil
    end
end)

-- ============================================================
-- Label Countdown dari MenuRings
-- ============================================================
GameData.label = MenuRings["Event Tracker"].Main.Gui.Content.Items.Countdown.Label

-- ============================================================
-- Paragraph WindUI (update setiap detik)
-- ============================================================
GameData.paragraph = sections.Fishing1:Paragraph({
    Header = "Lochness Monster Countdown",
    Body = GameData.label.Text
}, nil)

task.spawn(function()
    while true do
        if GameData.paragraph and GameData.label then
            GameData.paragraph:UpdateBody(GameData.label.Text)
        end
        task.wait(1)
    end
end)

-- ============================================================
-- Toggle Auto Lochness
-- ============================================================
sections.Fishing1:Toggle({
    Name = "Auto Lochness Monster",
    Default = false,
    Callback = function(value)
        GameData.enabled = value
        Window:Notify({
            Title = "Auto Lochness Monster",
            Description = (value and "Enabled " or "Disabled ") .. "Lochness Monster"
        })
    end,
}, "AutoLochnessMonsterToggle")

-- ============================================================
-- Loop utama (teleport & freeze)
-- ============================================================
task.spawn(function()
    while true do
        if GameData.enabled
        and GameData.label
        and GameData.label.Text == "0H 1M 10S"
        and GameData.hrp
        then
            -- TELEPORT
            GameData.hrp.CFrame = GameData.targetCFrame

            -- FREEZE
            GameData.freeze = Instance.new("BodyVelocity")
            GameData.freeze.Velocity = Vector3.zero
            GameData.freeze.MaxForce = Vector3.new(1e5, 1e5, 1e5)
            GameData.freeze.Parent = GameData.hrp

            task.wait(2)

            -- UNFREEZE
            if GameData.freeze then
                GameData.freeze:Destroy()
                GameData.freeze = nil
            end

            task.wait(1)
        end

        task.wait(0.1)
    end
end)

sections.Fishing1:Divider()

--------------------------
-- UI (Paragraph Only)
--------------------------
GameData.DiscoParagraph = sections.Fishing1:Paragraph({
    Header = "Status Event Disco",
    Body = "Loading..."
})

--------------------------
-- MAIN LOOP (NO TELEPORT)
--------------------------
task.spawn(function()
    while true do
        task.wait(1)

        pcall(function()
            local dist = (GameData.Root.Position - GameData.DefaultCFrame.Position).Magnitude
            GameData.IsDiscoNow = dist > 1

            -- Disco Mulai
            if GameData.IsDiscoNow and not GameData.DiscoActive then
                GameData.DiscoActive = true
                GameData.DiscoParagraph:UpdateBody("üéâ Disco BEGINS!")
            end

            -- Disco Berhenti
            if not GameData.IsDiscoNow and GameData.DiscoActive then
                GameData.DiscoActive = false
                GameData.DiscoParagraph:UpdateBody("‚ùå NO DISCO")
            end
        end)
    end
end)


GameData.LocalPlayer = GameData.Players.LocalPlayer
GameData.Character = GameData.LocalPlayer.Character or GameData.LocalPlayer.CharacterAdded:Wait()
GameData.HumanoidRootPart = GameData.Character:WaitForChild("HumanoidRootPart")

GameData.eventCF = CFrame.new(
    -8625, -532.471008, 161.125,
    1, 0, 0,
    0, 1, 0,
    0, 0, 1
)

GameData.targetTP = CFrame.new(
    -8642.99414, -547.400183, 159.353485,
    0.139343381, -2.42283136e-08, -0.99024415,
    4.18495816e-08, 1, -1.85780973e-08,
    0.99024415, -3.88525692e-08, 0.139343381
)

GameData.AutoDiscoEvent = false
GameData.savedPosition = nil
GameData.teleported = false

-- TOGGLE UI
sections.Fishing1:Toggle({
    Name = "Auto Disco Event",
    Default = false,
    Callback = function(value)
        GameData.AutoDiscoEvent = value

        Window:Notify({
            Title = "Auto Disco Event",
            Description = value and "Enabled" or "Disabled"
        })

        if not value then
            if GameData.teleported and GameData.savedPosition then
                GameData.HumanoidRootPart.CFrame = GameData.savedPosition
            end
            GameData.teleported = false
            GameData.savedPosition = nil
        end
    end,
}, "AutoDiscoToggle")

-- MAIN LOOP
task.spawn(function()
    while task.wait(0.1) do
        if GameData.AutoDiscoEvent then

            -- Event aktif ‚Üí teleport sekali
            if GameData.DiscoRoot.CFrame == GameData.eventCF and not GameData.teleported then
                GameData.savedPosition = GameData.HumanoidRootPart.CFrame
                GameData.HumanoidRootPart.CFrame = GameData.targetTP
                GameData.teleported = true
            end

            -- Event selesai ‚Üí kembalikan posisi
            if GameData.teleported and GameData.DiscoRoot.CFrame ~= GameData.eventCF then
                if GameData.savedPosition then
                    GameData.HumanoidRootPart.CFrame = GameData.savedPosition
                end
                GameData.teleported = false
                GameData.savedPosition = nil
            end

        end
    end
end)

sections.Fishing1:Header({
	Name = "Status Info Fishing1"
})

-- Label awal
GameData.statusLabel = sections.Fishing1:Label({
    Text = 'Status Offline: <font color="rgb(255,0,0)">.....</font>'
})

---------------------------------------------------------
-- Fungsi Update Label (DIPERBAIKI)
---------------------------------------------------------
GameData.UpdateStatusLabel = function()

    -- Reset list
    GameData.activeList = {}

    -- Ambil toggle ON saja
    for name, state in pairs(GameData.toggleStatus) do
        if state == true then
            table.insert(
                GameData.activeList,
                '<font color="rgb(0,255,0)">' .. name .. ' ON</font>'
            )
        end
    end

    -- Jika tidak ada toggle yang aktif
    if #GameData.activeList == 0 then
        GameData.statusLabel:UpdateName('Status Offline: <font color="rgb(255,0,0)">.....</font>')
    else
        GameData.statusLabel:UpdateName(
            'Status Online: ' .. table.concat(GameData.activeList, "|| ")
        )
    end

    GameData.statusLabel:SetVisibility(true)
end

sections.Fishing1:Divider()

GameData.smallNotif = GameData.PlayerGui:FindFirstChild("Small Notification")
GameData.display = GameData.smallNotif and GameData.smallNotif:FindFirstChild("Display")
GameData.container = GameData.display and GameData.display:FindFirstChild("Container")

GameData.notifications = GameData.PlayerGui:FindFirstChild("Text Notifications")
GameData.notifFrame = GameData.notifications and GameData.notifications:FindFirstChild("Frame")

-- Buat counter UI
-- (asumsikan `sections.Fishing1:Paragraph` tersedia di environment)
GameData.Fishing1Counter = sections.Fishing1:Paragraph({
    Header = "üé£ Fishing1 Counter",
    Body = "‚úÖ Success: 0  |  ‚ùå Failed: 0"
}, "Fishing1CounterFlag")

-- ============================================================
-- UPDATE COUNTER FUNCTION
-- ============================================================
function GameData.updateCounter()
    if GameData.Fishing1Counter and GameData.Fishing1Counter.UpdateBody then
        GameData.Fishing1Counter:UpdateBody(
            '<font color="rgb(0,255,0)">‚úÖ Success: ' .. GameData.successCount .. '</font>' ..
            '  |  ' ..
            '<font color="rgb(255,0,0)">‚ùå Failed: ' .. GameData.failCount .. '</font>'
        )
    end
end

-- ============================================================
-- SUCCESS DETECTOR
-- ============================================================
if GameData.container then
    GameData.successConn = GameData.container:GetPropertyChangedSignal("Position"):Connect(function()
        -- bandingkan dengan successPos
        if GameData.container.Position == GameData.successPos then
            GameData.successCount = GameData.successCount + 1
            GameData.updateCounter()
        end
    end)
else
    warn("Container not found; success detector not connected.")
end

-- ============================================================
-- FAIL DETECTOR
-- ============================================================
if GameData.notifFrame then
    GameData.failConn = GameData.notifFrame.ChildAdded:Connect(function(child)
        if child and child.Name == "TextTile" then
            local header = child:FindFirstChild("Header")
            if header and header:IsA("TextLabel") then

                -- Direct spawn text
                if header.Text == "The fish got away!" then
                    GameData.failCount = GameData.failCount + 1
                    GameData.updateCounter()
                end

                -- If text changes after spawn (lindungi reference header)
                header:GetPropertyChangedSignal("Text"):Connect(function()
                    -- pastikan header masih ada dan adalah TextLabel
                    if header and header:IsA("TextLabel") and header.Text == "The fish got away!" then
                        GameData.failCount = GameData.failCount + 1
                        GameData.updateCounter()
                    end
                end)
            end
        end
    end)
else
    warn("notifFrame not found; fail detector not connected.")
end

-- ============================================================
-- INITIALIZE UI
-- ============================================================
if GameData.Fishing1Counter and GameData.Fishing1Counter.SetVisibility then
    GameData.Fishing1Counter:SetVisibility(true)
end
GameData.updateCounter()

-- ============================================================
-- CLEANUP FUNCTION
-- ============================================================
function GameData.cleanup()
    if GameData.successConn then GameData.successConn:Disconnect() end
    if GameData.failConn then GameData.failConn:Disconnect() end
end

sections.Fishing1:Header({
	Name = "Fishing1 Feature"
})

-- Controllers & Packages
local Fishing1Controller = require(ReplicatedStorage.Controllers.Fishing1Controller)
local AutoFishing1Controller = require(ReplicatedStorage.Controllers.AutoFishing1Controller)
local Replion = require(ReplicatedStorage.Packages.Replion)

-- Remote Toggle
local UpdateAutoFishing1State = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/UpdateAutoFishing1State")

-- Remote Instant
local REReplicateTextEffect = ReplicatedStorage
	.Packages._Index["sleitnick_net@0.2.0"].net["RE/ReplicateTextEffect"]

local REFishing1Completed = ReplicatedStorage
	.Packages._Index["sleitnick_net@0.2.0"].net["RE/Fishing1Completed"]

-- ==========================================================
-- GLOBAL STATE
-- ==========================================================
local SelectedMode = "Click"    
local AutoClickEnabled = false
local InstantEnabled = false

local ClickSpeed = 0.05
local remoteDelay = 1
local clickThread = nil

-- ==========================================================
-- DROPDOWN MODE
-- ==========================================================
sections.Fishing1:Dropdown({
	Name = "Select Auto Fish Mode",
	Search = false,
	Multi = false,
	Required = false,
	Options = {"Click", "Instant"},
	Default = {"Click"},
	Callback = function(Value)
		SelectedMode = Value
		Window:Notify({
			Title = "Mode Updated",
			Description = "Mode set to: " .. SelectedMode
		})
	end,
}, "AutoFishModeDropdown")

-- ==========================================================
-- CLICK SPEED INPUT
-- ==========================================================
sections.Fishing1:Input({
	Name = "Click Speed",
	Placeholder = "Default: 0.05",
	AcceptedCharacters = "Numbers",
	Callback = function(value)
		local num = tonumber(value)
		if num and num > 0 then
			ClickSpeed = num
			Window:Notify({
				Title = "Speed Updated",
				Description = "Click Speed = " .. num
			})
		end
	end,
}, "AutoClickSpeedInput")

-- ==========================================================
-- CLICK FUNCTION
-- ==========================================================
local function performClick()
	Fishing1Controller:RequestFishing1MinigameClick()
	task.wait(ClickSpeed + math.random() * ClickSpeed)
end

-- ==========================================================
-- HOOK MINIGAME (MODE CLICK)
-- ==========================================================
local originalRodStarted = Fishing1Controller.Fishing1RodStarted
local originalFishing1Stopped = Fishing1Controller.Fishing1Stopped

Fishing1Controller.Fishing1RodStarted = function(self, ...)
	originalRodStarted(self, ...)
	if SelectedMode ~= "Click" then return end
	if not AutoClickEnabled then return end

	if clickThread then task.cancel(clickThread) end
	clickThread = task.spawn(function()
		while AutoClickEnabled do
			performClick()
		end
	end)
end

Fishing1Controller.Fishing1Stopped = function(self, ...)
	originalFishing1Stopped(self, ...)
	if clickThread then
		task.cancel(clickThread)
		clickThread = nil
	end
end

-- ==========================================================
-- DELAY REEL INPUT (MODE INSTANT)
-- ==========================================================
sections.Fishing1:Input({
	Name = "Delay Reel",
	Placeholder = "Default: 1",
	AcceptedCharacters = "Numbers",
	Callback = function(input)
		local num = tonumber(input)
		if num then
			remoteDelay = num
			Window:Notify({
				Title = "Delay Updated",
				Description = "Delay Reel = " .. num
			})
		end
	end,
}, "DelayReelInput")

-- ==========================================================
-- LISTEN FOR REEL (AUTO COMPLETE)
-- ==========================================================
REReplicateTextEffect.OnClientEvent:Connect(function(data)
	if SelectedMode ~= "Instant" then return end
	if not InstantEnabled then return end
	if not data or not data.TextData then return end

	local attach = data.TextData.AttachTo
	if not attach or not attach.Parent then return end

	local player = Players:GetPlayerFromCharacter(attach.Parent)
	if player ~= LocalPlayer then return end

	task.delay(remoteDelay, function()
		if InstantEnabled then
			REFishing1Completed:FireServer()
		end
	end)
end)

-- ==========================================================
-- REMOTE AUTO FISH STATE
-- ==========================================================
local function updateRemoteState(bool)
	task.spawn(function()
		pcall(function()
			UpdateAutoFishing1State:InvokeServer(bool)
		end)
	end)
end

-- ==========================================================
-- TOGGLE UTAMA
-- ==========================================================
sections.Fishing1:Toggle({
	Name = "Auto Fishing1",
	Default = false,
	Callback = function(state)

		-- Update status label (wajib)
		GameData.toggleStatus["Normal Fishing1"] = state
		GameData.UpdateStatusLabel()

		-- Kirim remote setiap toggle
        updateRemoteState(state)

		-- Mode selector
		if SelectedMode == "Click" then
			AutoClickEnabled = state
			InstantEnabled = false
		elseif SelectedMode == "Instant" then
			InstantEnabled = state
			AutoClickEnabled = false
		end

		Window:Notify({
			Title = "Auto Fishing1",
			Description = "Mode: " .. SelectedMode .. " ‚Üí " .. (state and "ON" or "OFF")
		})
	end,
}, "UniversalAutoFishToggle")


-- ========= [No Animation] =========
local stopAnimConnections = {}

local function setGameAnimationsEnabled(state)
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if not humanoid then
        return
    end

    -- Bersihkan koneksi animasi lama
    for _, conn in ipairs(stopAnimConnections) do
        conn:Disconnect()
    end
    stopAnimConnections = {}

    if state then
        -- Hentikan semua animasi yg sedang berjalan
        local animator = humanoid:FindFirstChildOfClass("Animator")
        if animator then
            for _, track in ipairs(animator:GetPlayingAnimationTracks()) do
                track:Stop(0)
            end

            -- Cegah animasi baru dimainkan
            local conn = animator.AnimationPlayed:Connect(function(track)
                task.defer(function()
                    track:Stop(0)
                end)
            end)
            table.insert(stopAnimConnections, conn)
        end
    else
        -- Re-enable: cukup matikan koneksi
        for _, conn in ipairs(stopAnimConnections) do
            conn:Disconnect()
        end
        stopAnimConnections = {}
    end

    -- Notify WindUI
    Window:Notify({
        Title = "No Animation",
        Description = (state and "Enabled " or "Disabled ") .. "No Animation"
    })
end

-- =====================================================================
-- Toggle WindUI (Format Baru)
-- =====================================================================

sections.Fishing1:Toggle({
    Name = "No Animation",
    Default = false,
    Callback = function(state)

        -- Update status toggle
        GameData.toggleStatus["No Animation"] = state
        GameData.UpdateStatusLabel()

        -- Logic asli kamu
        setGameAnimationsEnabled(state)
    end,
})


GameData.Player = GameData.SVC.Players.LocalPlayer
GameData.Net = GameData.SVC.RS.Packages._Index["sleitnick_net@0.2.0"]:WaitForChild("net")

GameData.RF.CancelFishing1 = GameData.Net:WaitForChild("RF/CancelFishing1Inputs")
GameData.RE.ReplicateTextEffect = GameData.Net:WaitForChild("RE/ReplicateTextEffect")


--========================================================--
-- UI HANDLERS
--========================================================--
sections.Fishing1:Toggle({
	Name = "Skip Rarity",
	Default = false,
	Callback = function(state)

		-- Sistem status toggle
		GameData.toggleStatus["Skip Rarity"] = state
		GameData.UpdateStatusLabel()

		-- Logic asli kamu
		GameData.SkipState.Enabled = state

		Window:Notify({
			Title = "Skip Rarity",
			Description = (state and "Enabled" or "Disabled")
		})
	end,
}, "SkipRarityToggle")


sections.Fishing1:Dropdown({
	Name = "Rarity Filters",
	Search = true,
	Multi = true,
	Required = false,
	Options = { "Common", "Uncommon", "Rare", "Epic" },
	Default = { "Common" },

	Callback = function(Value)
		local selections = {}

		for rarity, isEnabled in next, Value do
			if isEnabled then
				table.insert(selections, rarity)
			end
		end

		GameData.SkipState.Blacklist = selections
	end,
}, "BlacklistRarity")


--========================================================--
-- UTILITIES (masuk GameData)
--========================================================--
function GameData.approx(a, b, tolerance)
	return math.abs(a - b) <= (tolerance or 0.02)
end

function GameData.isColor(r, g, b, R, G, B)
	return GameData.approx(r, R) and GameData.approx(g, G) and GameData.approx(b, B)
end

function GameData.extractColorFromTextData(colorValue)
	if typeof(colorValue) == "Color3" then return colorValue end
	if typeof(colorValue) == "ColorSequence" then
		if #colorValue.Keypoints > 0 then
			return colorValue.Keypoints[1].Value
		end
	end
	return nil
end

function GameData.detectRarity(color3)
	if not color3 then return "UNKNOWN" end

	local r,g,b = color3.R, color3.G, color3.B

	for rarity, col in pairs(GameData.BAD_COLORS) do
		if GameData.isColor(r, g, b, col[1], col[2], col[3]) then
			return rarity
		end
	end

	return "UNKNOWN"
end


--========================================================--
-- MAIN FILTER LOGIC
--========================================================--
pcall(function()
	local event = GameData.RE.ReplicateTextEffect
	if event and event.OnClientEvent then

		event.OnClientEvent:Connect(function(data)
			if not GameData.SkipState.Enabled then return end
			if not (data and data.TextData and data.TextData.TextColor and data.TextData.EffectType == "Exclaim") then
				return
			end

			local head = GameData.Player.Character and GameData.Player.Character:FindFirstChild("Head")
			if not head then return end
			if data.Container ~= head then return end

			local id = tostring(data.InstanceId or data.Id or data)
			local now = tick()

			if GameData.LastProcessed[id] and now - GameData.LastProcessed[id] < GameData.PROCESS_COOLDOWN then
				return
			end
			GameData.LastProcessed[id] = now

			local color3 = GameData.extractColorFromTextData(data.TextData.TextColor)
			local rarity = GameData.detectRarity(color3)

			for _, blk in ipairs(GameData.SkipState.Blacklist) do
				if string.upper(blk) == string.upper(rarity) then
					pcall(function()
						GameData.RF.CancelFishing1:InvokeServer()
					end)
					break
				end
			end
		end)
	end
end)

-- ========= [Cancel Fishing1] =========
-- Ambil RemoteFunction CancelFishing1
local CancelFishing1 = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/CancelFishing1Inputs")

-- Button Baru Format sections.Fishing1
sections.Fishing1:Button({
	Name = "Cancel Fishing1",
	Callback = function()
		CancelFishing1:InvokeServer()
	end,
})

sections.Fishing2:Header({
	Name = "Instant Fishing1 Feature"
})

-- Remote references
GameData.ChargeFishing1Rod = GameData.package["RF/ChargeFishing1Rod"]
GameData.RequestFishing1MinigameStarted = GameData.package["RF/RequestFishing1MinigameStarted"]
GameData.REReplicateTextEffect = GameData.package["RE/ReplicateTextEffect"]
GameData.REFishing1Completed = GameData.package["RE/Fishing1Completed"]
GameData.REFishCaught = GameData.package["RE/FishCaught"]
GameData.CancelFishing1Inputs = GameData.package["RF/CancelFishing1Inputs"]

-- ==========================================================
-- SAFE WAIT
-- ==========================================================
local function SafeWait(t)
    local start = os.clock()
    while os.clock() - start < t do
        if not GameData.autoFishing1Enabled then return false end
        task.wait()
    end
    return true
end

-- ==========================================================
-- MAIN Fishing1 CYCLE
-- ==========================================================
local function StartFishing1Cycle()
    if not GameData.autoFishing1Enabled or GameData.isFishing1 then return end

    GameData.isFishing1 = true
    GameData.lastCatchTime = os.clock()

    GameData.ChargeFishing1Rod:InvokeServer()
    if not SafeWait(0.01) then return end

    GameData.RequestFishing1MinigameStarted:InvokeServer(unpack(GameData.miniggameArgs))
end

-- ==========================================================
-- ANTI-STUCK CHECKER (AUTO RESTART)
-- ==========================================================
task.spawn(function()
    while true do
        task.wait(1)

        if GameData.autoFishing1Enabled and GameData.isFishing1 then
            if os.clock() - GameData.lastCatchTime >= GameData.antiStuckTime then

                print("[Anti-Stuck] Tidak ada FishCaught selama "..GameData.antiStuckTime.." detik. Reset Fishing1...")

                pcall(function()
                    GameData.CancelFishing1Inputs:InvokeServer()
                end)

                GameData.isFishing1 = false
                task.wait(0.01)

                StartFishing1Cycle()
            end
        end
    end
end)

-- ==========================================================
-- REPLICATE TEXT EFFECT
-- ==========================================================
GameData.REReplicateTextEffect.OnClientEvent:Connect(function(data)
    if not GameData.autoFishing1Enabled or not data or not data.TextData then return end

    local attach = data.TextData.AttachTo
    if not attach or not attach.Parent then return end

    local playerFromChar = GameData.Players:GetPlayerFromCharacter(attach.Parent)
    if playerFromChar ~= GameData.player then return end

    task.spawn(function()
        if not SafeWait(GameData.completedDelay) then return end
        GameData.REFishing1Completed:FireServer()
    end)
end)

-- ==========================================================
-- FISH CAUGHT = RESTART
-- ==========================================================
GameData.REFishCaught.OnClientEvent:Connect(function(fishName, data)
    if not GameData.autoFishing1Enabled then return end

    GameData.lastCatchTime = os.clock()

    task.spawn(function()
        pcall(function()
            GameData.CancelFishing1Inputs:InvokeServer()
        end)

        GameData.isFishing1 = false
        if not SafeWait(GameData.castDelay) then return end

        StartFishing1Cycle()
    end)
end)

-- ==========================================================
-- WINDUI SETTINGS
-- ==========================================================
sections.Fishing2:Toggle({
    Name = "Instant Fishing",
    Default = false,
    Callback = function(state)

        -- Tambahan status toggle
        GameData.toggleStatus["Instant Fishing1"] = state
        GameData.UpdateStatusLabel()

        -- Logic asli kamu
        GameData.autoFishing1Enabled = state

        if state then
            StartFishing1Cycle()
        else
            GameData.isFishing1 = false
        end

        Window:Notify({
            Title = "Instant Fishing1",
            Description = state and "Enabled Instant Fishing1" or "Disabled Instant Fishing1"
        })
    end,
}, "InstantFishing1Toggle")


sections.Fishing2:Input({
    Name = "Cast Delay",
    Placeholder = "Default: 1.5",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        GameData.castDelay = tonumber(input) or 1.5

        Window:Notify({
            Title = "Cast Delay",
            Description = "Cast Delay set to: " .. tostring(GameData.castDelay)
        })
    end,
}, "InstantFishing1CastDelay")

sections.Fishing2:Input({
    Name = "Completed Delay",
    Placeholder = "Default: 1",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        GameData.completedDelay = tonumber(input) or 1

        Window:Notify({
            Title = "Completed Delay",
            Description = "Completed Delay set to: " .. tostring(GameData.completedDelay)
        })
    end,
}, "InstantFishing1CompletedDelay")

-- ADD NEW INPUT FOR ANTI-STUCK TIME
sections.Fishing2:Input({
    Name = "Anti-Stuck Time (Seconds)",
    Placeholder = "Default: 10",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        local value = tonumber(input)

        if value then
            GameData.antiStuckTime = value

            Window:Notify({
                Title = "Anti-Stuck Updated",
                Description = "Anti-Stuck time set to: " .. tostring(value) .. " seconds"
            })
        else
            Window:Notify({
                Title = "Invalid Input",
                Description = "Please enter numbers only."
            })
        end
    end,
}, "AntiStuckTimeInput")

sections.Fishing3:Header({
	Name = "Totems"
})

-- Modules
GameData.Client = require(GameData.ReplicatedStorage.Packages.Replion).Client
GameData.ItemUtility = require(GameData.ReplicatedStorage.Shared.ItemUtility)

-- Data
GameData.data = GameData.Client:WaitReplion("Data")
GameData.inventory = GameData.data:GetExpect("Inventory")

-- Remote
GameData.SpawnTotem = GameData.ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RE/SpawnTotem")

-- Totem IDs
GameData.TOTEM_IDS = {
    ["Luck Totem"] = 1,
    ["Mutation Totem"] = 2,
    ["Shiny Totem"] = 3,
}

-- State
GameData.selectedTotem = nil
GameData.autoSpawn = false
GameData.id = nil
GameData.uuid = nil


---------------------------------------------------------
-- SELECT TOTEM DROPDOWN (FIXED)
---------------------------------------------------------
sections.Fishing3:Dropdown({
    Name = "Select Totem",
    Search = true,
    Multi = false, -- Multi = false -> Value = STRING
    Required = false,
    Options = {"Luck Totem", "Mutation Totem", "Shiny Totem"},
    Default = {"Luck Totem"},
    Callback = function(Value)
        GameData.selectedTotem = Value  -- langsung ambil string
        print("Selected Totem:", GameData.selectedTotem)
    end,
}, "SelectTotemDropdown")


---------------------------------------------------------
-- AUTO SPAWN TOGGLE
---------------------------------------------------------
sections.Fishing3:Toggle({
    Name = "Auto Spawn Totem",
    Default = false,
    Callback = function(value)
        GameData.autoSpawn = value

        Window:Notify({
            Title = "Spawn Totem",
            Description = (value and "Enabled " or "Disabled ") .. "Auto Spawn Totem"
        })

        if value then
            task.spawn(function()
                while GameData.autoSpawn do
                    
                    if GameData.selectedTotem then
                        
                        GameData.id = GameData.TOTEM_IDS[GameData.selectedTotem]
                        GameData.uuid = nil

                        -- Cari totem di inventory
                        for _, totem in ipairs(GameData.inventory.Totems or {}) do
                            GameData.itemData = GameData.ItemUtility.GetItemDataFromItemType("Totems", totem.Id)

                            if GameData.itemData and GameData.itemData.Data.Id == GameData.id then
                                GameData.uuid = totem.UUID
                                break
                            end
                        end

                        -- Spawn kalau ada
                        if GameData.uuid then
                            print("Spawning:", GameData.selectedTotem, "UUID:", GameData.uuid)
                            GameData.SpawnTotem:FireServer(GameData.uuid)
                        else
                            warn("Totem not found:", GameData.selectedTotem)
                        end
                    end

                    task.wait(5)
                end
            end)
        end
    end,
}, "AutoSpawnTotemToggle")

sections.Fishing4:Header({
	Name = "Blatant V1"
})

-- SETUP LOCALPLAYER
GameData.LP = GameData.Players.LocalPlayer

-- GET NET FOLDER
GameData.net = GameData.RS.Packages._Index["sleitnick_net@0.2.0"]:WaitForChild("net")

-- REMOTES
GameData.RF_Charge = GameData.net:WaitForChild("RF/ChargeFishing1Rod")
GameData.RF_Start  = GameData.net:WaitForChild("RF/RequestFishing1MinigameStarted")
GameData.RF_Cancel = GameData.net:WaitForChild("RF/CancelFishing1Inputs")
GameData.RE_Finish = GameData.net:WaitForChild("RE/Fishing1Completed")
GameData.RE_Equip  = GameData.net:WaitForChild("RE/EquipToolFromHotbar")

-- EQUIP TOOL FUNCTION
GameData.EquipTool = function()
    pcall(function() GameData.RE_Equip:FireServer(1) end)
end

-- FAST FISH FUNCTION
GameData.FastFish = function()
    task.spawn(function()
        GameData.RF_Cancel:InvokeServer()
        task.wait(GameData.CancelDelay)

        GameData.RF_Charge:InvokeServer(workspace:GetServerTimeNow())
        GameData.RF_Start:InvokeServer(-1, 0.9964)

        task.wait(GameData.CompleteDelay)
        GameData.RE_Finish:FireServer()
    end)
end

-- START LOOP FUNCTION
GameData.StartLoop = function()
    if GameData.enabled then return end
    GameData.enabled = true

    GameData.EquipTool()

    task.spawn(function()
        while GameData.enabled do
            local tickNow = tick()
            GameData.FastFish()

            while GameData.enabled and tick() - tickNow < (_G.ReelSuper or 1.05) do
                task.wait()
            end
        end
    end)
end

-- STOP LOOP FUNCTION
GameData.StopLoop = function()
    GameData.enabled = false
end

-- UI KUZU HUB
sections.Fishing4:Toggle({
    Name = "Blatant V1",
    Default = false,
    Callback = function(state)
        if state then
            GameData.StartLoop()
            Window:Notify({ Title = "Blatant V1", Description = "Enabled Fishing1" })
        else
            GameData.StopLoop()
            Window:Notify({ Title = "Blatant V1", Description = "Disabled Fishing1" })
        end
    end,
}, "Fishing1Toggle")

sections.Fishing4:Input({
    Name = "Cancel Delay V1",
    Placeholder = "1.05",
    AcceptedCharacters = "0123456789.",
    Callback = function(txt)
        local n = tonumber(txt)
        if n and n > 0 then
            GameData.CancelDelay = n
            Window:Notify({ Title = "Blatant V1", Description = "Cancel Delay Set: "..tostring(n) })
        else
            Window:Notify({ Title = "Blatant V1", Description = "Invalid Cancel Delay!" })
        end
    end,
}, "CancelDelayInput")

sections.Fishing4:Input({
    Name = "Complete Delay V1",
    Placeholder = "0.16",
    AcceptedCharacters = "0123456789.",
    Callback = function(txt)
        local n = tonumber(txt)
        if n and n > 0 then
            GameData.CompleteDelay = n
            Window:Notify({ Title = "Blatant V1", Description = "Complete Delay Set: "..tostring(n) })
        else
            Window:Notify({ Title = "Blatant V1", Description = "Invalid Complete Delay!" })
        end
    end,
}, "CompleteDelayInput")

sections.Fishing5:Header({
	Name = "Blatant V2"
})

-- SETUP NET
GameData.net = GameData.SVC.RS.Packages._Index["sleitnick_net@0.2.0"]:WaitForChild("net")

GameData.RF = {
    ChargeFishing1Rod = GameData.net:WaitForChild("RF/ChargeFishing1Rod"),
    RequestFishing1MinigameStarted = GameData.net:WaitForChild("RF/RequestFishing1MinigameStarted"),
    CancelFishing1 = GameData.net:WaitForChild("RF/CancelFishing1Inputs")
}

GameData.RE = {
    Fishing1Completed = GameData.net:WaitForChild("RE/Fishing1Completed")
}

-- CUTSCENE CONTROLLER
do
    local ok, controller = pcall(function()
        return require(game:GetService("ReplicatedStorage").Controllers.CutsceneController)
    end)

    if ok and controller then
        GameData.cutsceneController = controller
        GameData.originalPlay = controller.Play
        GameData.originalStop = controller.Stop
    end
end

-- ENABLE SKIP SYSTEM
GameData.EnableSkip = function()
    if GameData.cutsceneController then
        if GameData.cutsceneController.ReplicateCutscene then
            GameData.cutsceneController.ReplicateCutscene.OnClientEvent:Connect(function() end)
        end
        if GameData.cutsceneController.StopCutscene then
            GameData.cutsceneController.StopCutscene.OnClientEvent:Connect(function() end)
        end

        GameData.cutsceneController.Play = function() end
        GameData.cutsceneController.Stop = function() end
    end
end

GameData.EnableSkip()

-- GLOBAL CONFIG
_G.BlatantV2 = false
_G.DelayLoopStartV2 = 0.80
_G.DelayCompleteV2 = 1

-- FASTEST FUNCTION
GameData.Fastest = function()
    task.spawn(function()
        pcall(function() GameData.RF.CancelFishing1:InvokeServer() end)
        pcall(function() GameData.RF.ChargeFishing1Rod:InvokeServer(workspace:GetServerTimeNow()) end)
        pcall(function() GameData.RF.RequestFishing1MinigameStarted:InvokeServer(-1, 0.999) end)

        task.wait(_G.DelayCompleteV2)

        pcall(function() GameData.RE.Fishing1Completed:FireServer() end)
    end)
end

-- LOOP START
GameData.startBlatantV2 = function()
    task.spawn(function()
        while _G.BlatantV2 do
            GameData.Fastest()
            task.wait(_G.DelayLoopStartV2)
        end
    end)
end

-- WINDUI
sections.Fishing5:Toggle({
    Name = "Blatant V2",
    Default = _G.BlatantV2,
    Callback = function(value)
        _G.BlatantV2 = value
        if value then
            GameData.startBlatantV2()
        end

        Window:Notify({
            Title = "Blatant V2",
            Description = value and "Enabled" or "Disabled"
        })
    end,
}, "BlatantV2Toggle")

sections.Fishing5:Input({
    Name = "Delay Cast V2",
    Placeholder = "0.80",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        local num = tonumber(input)
        if num then
            _G.DelayLoopStartV2 = num
        end
    end,
}, "DelayCastV2Input")

sections.Fishing5:Input({
    Name = "Delay Complete V2",
    Placeholder = "1",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        local num = tonumber(input)
        if num then
            _G.DelayCompleteV2 = num
        end
    end,
}, "DelayCompleteV2Input")


sections.Fishing6:Header({
	Name = "Webhook Notifier"
})

GameData.LocalPlayer         = GameData.Service.Players.LocalPlayer
GameData.ReplicatedStorage   = GameData.Service.ReplicatedStorage
GameData.HttpService         = GameData.Service.HttpService
GameData.RequestExecutor     = GameData.Request


--========================================================--
-- UI SETUP
--========================================================--

sections.Fishing6:Input({
    Name = "Webhook URL",
    Placeholder = "Masukkan Webhook",
    AcceptedCharacters = "All",
    Callback = function(input)
        GameData.WebhookURL = input
    end,
}, "WebhookURLInput")

sections.Fishing6:Toggle({
    Name = "Webhook Status",
    Default = false,
    Callback = function(value)
        GameData.WebhookActive = value
        Window:Notify({
            Title = "Webhook",
            Description = value and "Enabled Webhook" or "Disabled Webhook"
        })
    end,
}, "WebhookToggle")

sections.Fishing6:Dropdown({
	Name = "Filter Tier",
	Search = false,
	Multi = true,
	Required = false,
	Options = GameData.TierList,
	Default = {"All"},
	Callback = function(Value)

		GameData.SelectedTiers = {}

		for Tier, State in pairs(Value) do
			if State then
				table.insert(GameData.SelectedTiers, Tier)
			end
		end
	end,
}, "TierFilter")


--========================================================--
-- FORMAT FUNCTIONS
--========================================================--

GameData.FormatNumber = function(num)
    num = tonumber(num) or 0
    if num >= 1e9 then
        return string.format("%.2fb", num / 1e9)
    elseif num >= 1e6 then
        return string.format("%.2fm", num / 1e6)
    elseif num >= 1e3 then
        return string.format("%.2fk", num / 1e3)
    else
        return tostring(num)
    end
end

GameData.FormatChance = function(chance)
    chance = tonumber(chance) or 0
    return string.format("%.2f%%", chance * 100)
end


--========================================================--
-- ROBLOX THUMBNAIL
--========================================================--

GameData.GetRobloxImage = function(assetId)

    if not assetId then return nil end

    local url = "https://thumbnails.roblox.com/v1/assets?assetIds=" .. assetId .. "&size=420x420&format=Png&isCircular=false"
    local success, response = pcall(game.HttpGet, game, url)

    if success then
        local data = GameData.HttpService:JSONDecode(response)
        if data and data.data and data.data[1] and data.data[1].imageUrl then
            return data.data[1].imageUrl
        end
    end

    return nil
end


--========================================================--
-- WEBHOOK SENDER
--========================================================--

GameData.SendEmbed = function(data)
    if GameData.WebhookURL == "" then return end
    if not GameData.RequestExecutor then return end

    GameData.RequestExecutor({
        Url = GameData.WebhookURL,
        Method = "POST",
        Headers = {["Content-Type"] = "application/json"},
        Body = GameData.HttpService:JSONEncode({embeds = data.embeds})
    })
end


--========================================================--
-- FIND FISH MODULE
--========================================================--

GameData.FindFishModule = function(fishName)

    local ItemsFolder = GameData.ReplicatedStorage:WaitForChild("Items")

    for _, moduleScript in ipairs(ItemsFolder:GetChildren()) do
        if moduleScript:IsA("ModuleScript") then
            local ok, data = pcall(require, moduleScript)
            if ok and data and data.Data and data.Data.Name then
                if string.find(string.lower(fishName), string.lower(data.Data.Name)) then
                    return data
                end
            end
        end
    end

    return nil
end


--========================================================--
-- UI REFERENCES (AUTO)
--========================================================--

local notif = GameData.LocalPlayer:WaitForChild("PlayerGui"):WaitForChild("Small Notification")

GameData.UI.Container      = notif.Display.Container
GameData.UI.ItemName       = GameData.UI.Container:WaitForChild("ItemName")
GameData.UI.NewLabel       = notif.Display.NewFrame.Frame:WaitForChild("NewLabel")
GameData.UI.VectorFrame    = notif.Display.VectorFrame.Vector
GameData.UI.RarityLabel    = GameData.UI.Container:WaitForChild("Rarity")
GameData.UI.BagLabel       = GameData.LocalPlayer.PlayerGui.Inventory.Main.Top.Options.Fish.Label.BagSize


--========================================================--
-- MAIN WEBHOOK LISTENER
--========================================================--

GameData.UI.ItemName:GetPropertyChangedSignal("Text"):Connect(function()

    if not (GameData.WebhookActive and GameData.WebhookURL ~= "" and GameData.RequestExecutor) then
        return
    end

    local text = GameData.UI.ItemName.Text
    if text == "" then return end

    -- extract
    local fishName, fishWeight = text:match("^(.-)%s*%((.-)%)$")
    fishName = fishName or text
    fishWeight = fishWeight or "Unknown"

    local fishData = GameData.FindFishModule(fishName)
    local tierNum = fishData and fishData.Data.Tier or 0
    local tierName = GameData.TierMap[tierNum] or "Unknown"

    local sellPrice = fishData and fishData.SellPrice or "Unknown"
    local chance    = fishData and fishData.Probability and fishData.Probability.Chance or 0

    local currentData = {
        Fish = fishName,
        Weight = fishWeight,
        Bag = GameData.UI.BagLabel.Text,
        Rarity = GameData.UI.RarityLabel.Text
    }

    -- avoid duplicate spam
    if GameData.LastFishData
    and GameData.LastFishData.Fish == currentData.Fish
    and GameData.LastFishData.Weight == currentData.Weight
    and GameData.LastFishData.Bag == currentData.Bag
    and GameData.LastFishData.Rarity == currentData.Rarity then
        return
    end

    GameData.LastFishData = currentData

    -- tier filter
    if #GameData.SelectedTiers > 0 then
        if not table.find(GameData.SelectedTiers, "All") and not table.find(GameData.SelectedTiers, tierName) then
            return
        end
    end

    -- stats
    if GameData.FishCounter[tierName] then
        GameData.FishCounter[tierName] = GameData.FishCounter[tierName] + 1
    end

    -- thumbnail
    local assetId = string.match(GameData.UI.VectorFrame.Image, "%d+")
    local imageUrl = GameData.GetRobloxImage(assetId)


    -- DISCORD EMBED
    local embed = {{

        ["title"] = "üé£ **Fish Caught!**",

        ["description"] = string.format(
            "### üêü **%s**\n" ..
            "```\nWeight : %s\nTier   : %s\nRarity : %s\nBag    : %s\n```\n\n" ..
            "### üí∞ Stats\n" ..
            "- **Sell Price:** `%s`\n" ..
            "- **Chance:** `%s`\n",
            fishName,
            fishWeight,
            tierName,
            currentData.Rarity,
            currentData.Bag,
            GameData.FormatNumber(sellPrice),
            GameData.FormatChance(chance)
        ),

        ["color"] = GameData.TierColor[tierName] or 5814783,

        ["thumbnail"] = {
            ["url"] = imageUrl or "https://i.imgur.com/zwCkN8P.png"
        },

        ["image"] = {
            ["url"] = "https://i.imgur.com/4PfH6rb.jpeg"
        },

        ["author"] = {
            ["name"] = "Nexa | Fishing1 System",
            ["icon_url"] = "https://i.imgur.com/4PfH6rb.jpeg"
        },

        ["footer"] = {
            ["text"] = "Caught by " .. GameData.LocalPlayer.Name .. " | " .. os.date("%H:%M:%S"),
            ["icon_url"] = "https://tr.rbxcdn.com/180DAY-f446c1264701227ae463835b155f44af/768/432/Image/Webp/noFilter"
        },

        ["fields"] = {
            {
                ["name"] = "üìä Total " .. tierName .. " Caught",
                ["value"] = "**" .. tostring(GameData.FishCounter[tierName]) .. "**",
                ["inline"] = true
            },
            {
                ["name"] = "üß≠ Rarity",
                ["value"] = currentData.Rarity,
                ["inline"] = true
            }
        }
    }}

    GameData.SendEmbed({embeds = embed})

end)

sections.Fishing7:Header({
	Name = "Equipment Feature"
})

-- Module
local Net = require(ReplicatedStorage.Packages.Net)
local Replion = require(ReplicatedStorage.Packages.Replion).Client

-- RemoteEvent EquipItem
local EquipItemEvent = Net:RemoteEvent("EquipItem")

-- Data player
local data = Replion:WaitReplion("Data")

local RodIDs = GameData.RodIDs

--------------------------------------------------------------------
-- BUILD ROD NAME LIST (AUTO)
--------------------------------------------------------------------
local RodNames = {}
for name, _ in pairs(RodIDs) do
    table.insert(RodNames, name)
end

--------------------------------------------------------------------
-- SELECT ROD (EQUIP)
--------------------------------------------------------------------
local SelectedRodName = "Starter Rod"

sections.Fishing7:Dropdown({
    Name = "Select Rod",
    Search = true,
    Multi = false,
    Options = RodNames,
    Default = SelectedRodName,
    Callback = function(Value)
        SelectedRodName = Value
    end,
}, "RodDropdown")

sections.Fishing7:Button({
    Name = "Equip Selected Rod",
    Callback = function()

        local selectedID = RodIDs[SelectedRodName]
        if not selectedID then return end

        local rods = data:GetExpect({"Inventory", "Fishing1 Rods"})
        if not rods then return end

        for _, rod in ipairs(rods) do
            if rod and rod.Id == selectedID then
                EquipItemEvent:FireServer(rod.UUID, "Fishing1 Rods")
                break
            end
        end
    end,
})

local BaitIDs = GameData.BaitIDs

--------------------------------------------------------------------
-- REMOTE EQUIP BAIT
--------------------------------------------------------------------
local equipBaitRemote = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RE/EquipBait")

--------------------------------------------------------------------
-- GENERATE BAIT NAME LIST (AUTO)
--------------------------------------------------------------------
local baitNames = {}
for name, _ in pairs(BaitIDs) do
    table.insert(baitNames, name)
end

--------------------------------------------------------------------
-- SELECT BAIT FOR EQUIP
--------------------------------------------------------------------
local selectedBaitID = BaitIDs["Starter Bait"]

sections.Fishing7:Dropdown({
    Name = "Select Bait",
    Options = baitNames,
    Default = "Starter Bait",
    Search = true,

    Callback = function(selected)
        selectedBaitID = BaitIDs[selected]
    end,
})

sections.Fishing7:Button({
    Name = "Equip Selected Bait",
    Callback = function()
        if selectedBaitID then
            equipBaitRemote:FireServer(selectedBaitID)
        end
    end,
})
---------------------------------------------------------------------
-- AUTO EQUIP ROD
---------------------------------------------------------------------

-- Ambil RemoteEvent untuk equip rod
local netEvent = ReplicatedStorage
	:WaitForChild("Packages")
	:WaitForChild("_Index")
	:WaitForChild("sleitnick_net@0.2.0")
	:WaitForChild("net")
	:WaitForChild("RE/EquipToolFromHotbar")

local args = {1}
local autoEquipRod = false

-- Toggle auto-equip
sections.Fishing7:Toggle({
	Name = "Auto Equip Rod",
	Default = false,
	Callback = function(state)
		autoEquipRod = state
	end,
})

-- Loop auto equip
task.spawn(function()
	while true do
		if autoEquipRod then
			netEvent:FireServer(unpack(args))
		end
		task.wait(1)
	end
end)


sections.Fishing8:Header({
	Name = "Sell Feature"
})

-- ==========================================================
-- AUTO SELL VARIABLES
-- ==========================================================
local sellRemote = ReplicatedStorage:WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/SellAllItems")

local autoSell = false
local sellDelay = 2
local mode = "Sell Delay"
local autoSellLoop = nil

-- ==========================================================
-- WINDUI: Slider Sell Delay
-- ==========================================================
sections.Fishing8:Slider({
	Name = "Sell Delay (seconds)",
	Default = 2,
	Minimum = 1,
	Maximum = 100,
	Rounding = 0,
	Callback = function(value)
		sellDelay = value
	end,
}, "SellDelaySlider")

-- ==========================================================
-- WINDUI: Dropdown Mode
-- ==========================================================
sections.Fishing8:Dropdown({
	Name = "Select Mode",
	Options = { "Backpack Full", "Sell Delay" },
	Default = "Sell Delay",
	Multi = false,
	Search = false,
	MaxVisibleDropdownItems = 5,
	Callback = function(option)
		mode = option
	end,
}, "SellModeDropdown")

-- ==========================================================
-- WINDUI: Toggle Auto Sell
-- ==========================================================
sections.Fishing8:Toggle({
	Name = "Auto Sell All Items",
	Default = false,
	Callback = function(state)
		autoSell = state

		if state then
			autoSellLoop = task.spawn(function()
				while autoSell do
					pcall(function()
						if mode == "Sell Delay" then
							sellRemote:InvokeServer()
							task.wait(sellDelay)
						elseif mode == "Backpack Full" then
							local bagLabel = LocalPlayer.PlayerGui.Inventory.Main.Top.Options.Fish.Label.BagSize
							if bagLabel and bagLabel.Text == "4,400/4,400" then
								sellRemote:InvokeServer()
							end
							task.wait(1)
						end
					end)
				end
			end)
		else
			if autoSellLoop then
				task.cancel(autoSellLoop)
				autoSellLoop = nil
			end
		end
	end,
}, "AutoSellToggle")

sections.Event:Header({
	Name = "Event Hunt"
})

-- Setup player
GameData.Player = GameData.Players.LocalPlayer
GameData.Character = GameData.Player.Character or GameData.Player.CharacterAdded:Wait()
GameData.HRP = GameData.Character:WaitForChild("HumanoidRootPart")

-- ===========================================================
-- üî• FUNGSI: Ambil semua Sunken Wreckage
-- ===========================================================
GameData.GetAllSunkenModels = function()
    GameData.TempList = {}

    for _, v in pairs(workspace:GetChildren()) do
        if v.Name == "Sunken Wreckage" and v:IsA("Model") then
            table.insert(GameData.TempList, v)
        end
    end

    return GameData.TempList
end

-- ===========================================================
-- üî• FUNGSI: Proses 1 Wreckage
-- ===========================================================
GameData.ProcessOneWreckage = function(Wreck)
    if not Wreck then return end

    GameData.TempTreasure = Wreck:FindFirstChild("Treasure")
    if not GameData.TempTreasure then return end

    GameData.TempShine = GameData.TempTreasure:FindFirstChild("Shine")
    if not GameData.TempShine then return end

    GameData.TempPrompt = GameData.TempShine:FindFirstChild("ProximityPrompt")
    if not GameData.TempPrompt then return end

    -- Teleport
    GameData.HRP.CFrame = GameData.TempTreasure.CFrame + Vector3.new(0, 3, 0)

    repeat task.wait() until GameData.TempPrompt.Enabled and GameData.TempPrompt.Parent ~= nil

    task.wait(0.15)
    fireproximityprompt(GameData.TempPrompt)
end

-- ===========================================================
-- üî• LOOP OTOMATIS
-- ===========================================================
GameData.AutoTreasureLoop = function()
    while GameData.AutoTreasure do

        GameData.TempList = GameData.GetAllSunkenModels()

        for _, wreck in ipairs(GameData.TempList) do

            if not GameData.AutoTreasure then break end

            GameData.ProcessOneWreckage(wreck)

            task.wait(0.5)
            while wreck:FindFirstChild("Treasure") do
                if not GameData.AutoTreasure then break end
                task.wait(0.2)
            end
        end

        task.wait(1)
    end
end

-- ===========================================================
-- üîò TOGGLE UI
-- ===========================================================
sections.Event:Toggle({
    Name = "Auto Treasure Hunt",
    Default = false,

    Callback = function(state)
        GameData.AutoTreasure = state

        Window:Notify({
            Title = "Treasure Hunt",
            Description = (state and "Enabled" or "Disabled") .. " Auto Treasure Hunt"
        })

        if state then
            GameData.AutoTreasureThread = task.spawn(GameData.AutoTreasureLoop)
        end
    end,
}, "AutoTreasureHuntToggle")


-- Character
GameData.char = GameData.player.Character or GameData.player.CharacterAdded:Wait()
GameData.hrp = GameData.char:WaitForChild("HumanoidRootPart")

-- Folder
GameData.exclaimFolder = workspace:WaitForChild("!!! MENU RINGS")


---------------------------------------------------------
--‚≠ï DROPDOWN BARU: Select Auto Events
---------------------------------------------------------
sections.Event:Dropdown({
	Name = "Select Auto Events",
	Search = true,
	Multi = true,
	Required = false,
	Options = GameData.eventsList,
	Default = {},
	Callback = function(Value)
		local result = {}

		for eventName, state in next, Value do
			if state then table.insert(result, eventName) end
		end

		GameData.SelectedAutoEvents = result
	end
}, "SelectAutoEventsNew")


---------------------------------------------------------
--‚≠ï DROPDOWN BARU: Auto Event Priority
---------------------------------------------------------
sections.Event:Dropdown({
	Name = "Priority Events",
	Search = true,
	Multi = true,
	Required = false,
	Options = GameData.eventsList,
	Default = {},
	Callback = function(Value)
		local result = {}

		for eventName, state in next, Value do
			if state then table.insert(result, eventName) end
		end

		GameData.AutoEventPriority = result
	end
}, "PriorityEventsNew")


---------------------------------------------------------
--‚≠ï TOGGLE BARU: Auto Join Event
---------------------------------------------------------
sections.Event:Toggle({
	Name = "Auto Join Event",
	Default = false,
	Callback = function(v)

		if v and not GameData.savedCFrame then
			if GameData.hrp then
				GameData.savedCFrame = GameData.hrp.CFrame
			else
				Window:Notify({
					Title = "Error",
					Description = "Character not loaded!",
				})
				return false
			end
		end

		GameData.AutoEventToggle = v

		if not v and GameData.savedCFrame then
			task.wait(0.1)
			if GameData.hrp then
				GameData.hrp.CFrame = GameData.savedCFrame + Vector3.new(0, 5, 0)
			end
		end
	end
}, "ToggleAutoEventNew")


---------------------------------------------------------
--‚≠ï AUTO EVENT LOOP
---------------------------------------------------------
task.spawn(function()

    while task.wait(1) do
        if GameData.AutoEventToggle and GameData.hrp then
            
            local searchOrder = {}

            for _, v in ipairs(GameData.AutoEventPriority) do
                table.insert(searchOrder, v)
            end

            for _, v in ipairs(GameData.SelectedAutoEvents) do
                if not table.find(searchOrder, v) then
                    table.insert(searchOrder, v)
                end
            end

            local targetFound = nil

            for _, eventName in ipairs(searchOrder) do
                for _, prop in pairs(GameData.exclaimFolder:GetChildren()) do
                    for _, d in pairs(prop:GetDescendants()) do
                        if d.Name == eventName then
                            targetFound = d
                            break
                        end
                    end
                    if targetFound then break end
                end
                if targetFound then break end
            end

            if targetFound and targetFound:IsA("BasePart") then
                local pos = targetFound.CFrame.Position

                if not GameData.platform or not GameData.platform.Parent then
                    GameData.platform = Instance.new("Part")
                    GameData.platform.Anchored = true
                    GameData.platform.CanCollide = true
                    GameData.platform.Transparency = 1
                    GameData.platform.Size = Vector3.new(10, 1, 10)
                    GameData.platform.Parent = workspace
                end

                GameData.platform.Position = pos + Vector3.new(0,5,0)
                GameData.hrp.CFrame = CFrame.new(GameData.platform.Position + Vector3.new(0, 3, 0))

                GameData.atEvent = true
            else
                if GameData.atEvent and GameData.savedCFrame then
                    GameData.hrp.CFrame = GameData.savedCFrame + Vector3.new(0,5,0)
                    GameData.atEvent = false
                    if GameData.platform then GameData.platform:Destroy() GameData.platform = nil end
                end
            end
        end
    end
end)


GameData.player.CharacterAdded:Connect(function()
    task.wait(0.2)
    GameData.hrp = GameData.player.Character:WaitForChild("HumanoidRootPart")
end)

sections.Quest:Header({
	Name = "View Quest Status"
})

-- Init Deep Sea UI components
GameData2.surfaceGui = GameData2.board:WaitForChild("Gui")
GameData2.content = GameData2.surfaceGui:WaitForChild("Content")

GameData2.deepSeaParagraph = sections.Quest:Paragraph({
    Header = "Deep Sea Status",
    Body = "Loading..."
})

-- Init Aura UI
GameData2.auraParagraph = sections.Quest:Paragraph({
    Header = "Aura Boat Status",
    Body = "Loading..."
})

-- Init Element Tracker UI
GameData2.contentElement = GameData2.boardElement:WaitForChild("Gui"):WaitForChild("Content")

GameData2.elementParagraph = sections.Quest:Paragraph({
    Header = "Element Status",
    Body = "Loading..."
})

local function updateDeepSea()
    local lines = {}
    for _, name in ipairs(GameData2.labelNames) do
        local label = GameData2.content:FindFirstChild(name)
        if label then
            table.insert(lines, label.Text)
        end
    end

    if GameData2.deepSeaParagraph and GameData2.deepSeaParagraph.UpdateBody then
        GameData2.deepSeaParagraph:UpdateBody(table.concat(lines, "\n"))
    end
end

-- Update pertama
updateDeepSea()

-- Listener untuk perubahan
for _, name in ipairs(GameData2.labelNames) do
    local label = GameData2.content:FindFirstChild(name)
    if label then
        label:GetPropertyChangedSignal("Text"):Connect(updateDeepSea)
    end
end


--====================================================--
-- AURA BOAT TRACKER
--====================================================--

local function updateAura()
    local contentAura = MenuRings["Aura Tracker"].Board.Gui.Content

    local combinedText = table.concat({
        contentAura.Label1.Text,
        contentAura.Label2.Text,
        contentAura.Label3.Text
    }, "\n")

    if GameData2.auraParagraph and GameData2.auraParagraph.UpdateBody then
        GameData2.auraParagraph:UpdateBody(combinedText)
    end
end

-- Update berkala tiap 1 detik
task.spawn(function()
    while task.wait(1) do
        pcall(updateAura)
    end
end)


--====================================================--
-- ELEMENT TRACKER
--====================================================--

local function updateElement()
    local lines = {}
    for _, name in ipairs(GameData2.elementLabelNames) do
        local label = GameData2.contentElement:FindFirstChild(name)
        if label then
            table.insert(lines, label.Text)
        end
    end

    if GameData2.elementParagraph and GameData2.elementParagraph.UpdateBody then
        GameData2.elementParagraph:UpdateBody(table.concat(lines, "\n"))
    end
end

-- Update pertama
updateElement()

-- Listener perubahan text
for _, name in ipairs(GameData2.elementLabelNames) do
    local label = GameData2.contentElement:FindFirstChild(name)
    if label then
        label:GetPropertyChangedSignal("Text"):Connect(updateElement)
    end
end
-- ============================================
-- BUAT PARAGRAPH UI
-- ============================================
GameData.ParagraphStatus = sections.Quest:Paragraph({
    Header = "TempleLever Status",
    Body = "Checking...",
})

-- ============================================
-- FUNGSI CEK STATUS QUEST
-- ============================================
local function CheckQuest()
    local resultText = ""

    for _, lever in ipairs(GameData.Jungle:GetChildren()) do
        if lever:IsA("Model") and lever:FindFirstChild("Crystal") then

            local crystal = lever.Crystal
            local meshId = tostring(crystal.MeshId)

            local artifactName = GameData.StageList[meshId] or "Unknown Artifact"

            local root = lever:FindFirstChild("RootPart")
            local prompt = root and root:FindFirstChildOfClass("ProximityPrompt")

            -- cek selesai / belum
            if not root or (root and not prompt) then
                resultText = resultText .. artifactName .. " ‚Üí 100%\n"
            else
                resultText = resultText .. artifactName .. " ‚Üí 0%\n"
            end
        end
    end

    GameData.ParagraphStatus:UpdateBody(resultText)
end

-- ============================================
-- UPDATE STATUS TIAP 2 DETIK
-- ============================================
task.spawn(function()
    while true do
        CheckQuest()
        task.wait(2)
    end
end)

sections.Quest1:Header({
	Name = "Auto Quest"
})

---------------------------------------------------------------------
-- REQUIRED VARIABLES
---------------------------------------------------------------------
local LocalPlayer = game.Players.LocalPlayer
local RunService = game:GetService("RunService")

local selectedQuest = "Deep Sea"
local autoQuestEnabled = false
local freezeBV, freezeBG
local savedCFrame = nil

---------------------------------------------------------------------
-- FREEZE FUNCTIONS
---------------------------------------------------------------------
local function Freeze(char, cf)
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    if freezeBV then freezeBV:Destroy() freezeBV = nil end
    if freezeBG then freezeBG:Destroy() freezeBG = nil end

    freezeBV = Instance.new("BodyVelocity")
    freezeBV.Velocity = Vector3.zero
    freezeBV.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    freezeBV.Parent = hrp

    freezeBG = Instance.new("BodyGyro")
    freezeBG.CFrame = cf or hrp.CFrame
    freezeBG.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
    freezeBG.Parent = hrp
end

local function Unfreeze()
    if freezeBV then freezeBV:Destroy() freezeBV = nil end
    if freezeBG then freezeBG:Destroy() freezeBG = nil end
end

local function TeleportOnce(cf)
    local char = LocalPlayer.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        char:SetPrimaryPartCFrame(cf)
        savedCFrame = cf
        Freeze(char, cf)
    end
end

---------------------------------------------------------------------
-- CHECK QUEST
---------------------------------------------------------------------
local function CheckQuest()
    if not autoQuestEnabled or not selectedQuest then return end
    local char = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    local quest = GameData.Quests[selectedQuest]
    if not quest then return end

    -------------------------------------------------------------
    -- SPECIAL QUEST: Aura Boat
    -------------------------------------------------------------
    if selectedQuest == "Aura Boat" then
        local overhead = hrp:WaitForChild("Overhead")
        local lvl = overhead
            :WaitForChild("LevelContainer")
            :WaitForChild("Label")
            .Text

        local level = tonumber(lvl:match("%d+")) or 0
        if level >= quest.MinLevel then
            TeleportOnce(quest.PosTarget)
        end
        return
    end

    -------------------------------------------------------------
    -- NORMAL QUEST (Deep Sea / Element)
    -------------------------------------------------------------
    if quest.Label then
        local text = quest.Label.Text
        local persen = tonumber(text:match("(%d+)%%")) or 0

        if persen < 100 then
            TeleportOnce(quest.PosBelum100)
        else
            TeleportOnce(quest.PosSudah100)
        end
    end
end

---------------------------------------------------------------------
-- AUTO UPDATE WHEN LABEL CHANGES
---------------------------------------------------------------------
for name, quest in pairs(GameData.Quests) do
    if quest.Label then
        quest.Label:GetPropertyChangedSignal("Text"):Connect(function()
            if autoQuestEnabled and selectedQuest == name then
                CheckQuest()
            end
        end)
    end
end

---------------------------------------------------------------------
-- HEARTBEAT LOCK TO POSITION
---------------------------------------------------------------------
RunService.Heartbeat:Connect(function()
    if autoQuestEnabled and savedCFrame then
        local char = LocalPlayer.Character
        if char and char:FindFirstChild("HumanoidRootPart") then
            local hrp = char.HumanoidRootPart
            if (hrp.Position - savedCFrame.Position).Magnitude > 2 then
                hrp.CFrame = savedCFrame
            end
        end
    end
end)

---------------------------------------------------------------------
-- WINDUI: QUEST DROPDOWN
---------------------------------------------------------------------
sections.Quest1:Dropdown({
    Name = "Select Quest",
    Options = { "Deep Sea", "Element", "Aura Boat" },
    Default = "Deep Sea",
    Multi = false,
    Search = false,
    Callback = function(option)
        selectedQuest = option
        if autoQuestEnabled then
            CheckQuest()
        end
    end,
}, "QuestDropdown")

---------------------------------------------------------------------
-- WINDUI: AUTO QUEST TOGGLE
---------------------------------------------------------------------
sections.Quest1:Toggle({
    Name = "Auto Quest",
    Default = false,
    Callback = function(state)
        autoQuestEnabled = state
        if state then
            CheckQuest()
        else
            Unfreeze()
            savedCFrame = nil
        end
    end,
}, "AutoQuestToggle")


_G.Jungle = workspace:FindFirstChild("JUNGLE INTERACTIONS")

-- =========================
--  TELEPORT CFrame PER STAGE
-- =========================
_G.StageTP = {
    CFrame.new(1490.81421, 2.86463475, -842.592163, -0.991618156, 3.0407854e-09, -0.129203171, 2.10214846e-09, 1, 7.40118855e-09, 0.129203171, 7.06754877e-09, -0.991618156), -- Stage 1
    CFrame.new(1842.94128, 3.15022254, -290.12735, 0.303114563, 9.22644432e-08, -0.952954113, -8.85028655e-08, 1, 6.86685055e-08, 0.952954113, 6.35247446e-08, 0.303114563),  -- Stage 2
    CFrame.new(875.505676, 3.23971534, -357.766693, -0.152344614, -6.19773388e-08, 0.988327444, -3.3319314e-09, 1, 6.21957241e-08, -0.988327444, 6.18214413e-09, -0.152344614), -- Stage 3
    CFrame.new(1404.37671, 4.17689037, 121.881737, -0.958127379, -5.75146117e-08, 0.286342412, -4.29739515e-08, 1, 5.70648808e-08, -0.286342412, 4.23701572e-08, -0.958127379),  -- Stage 4
}

-- =========================
--  MESH ORDER PER STAGE
-- =========================
_G.MeshOrder = {
    "rbxassetid://112089909495700", -- Stage 1
    "rbxassetid://108196402536011", -- Stage 2
    "rbxassetid://140438616753774", -- Stage 3
    "rbxassetid://122936451238995"  -- Stage 4
}

-- =========================
--  STATE
-- =========================
_G.autoArtifactEnabled = false
_G.isRunning = false

-- (Tambahan) HRP pemain ke _G biar tidak aslinya undefined
local plr = game:GetService("Players").LocalPlayer
local char = plr.Character or plr.CharacterAdded:Wait()
_G.hrp = char:WaitForChild("HumanoidRootPart")

-- =========================
--  CEK STAGE BELUM SELESAI
-- =========================
function _G.IsQuestNotFinished(meshId)
    if not _G.Jungle then return false end

    for _, lever in ipairs(_G.Jungle:GetChildren()) do
        if lever.Name == "TempleLever" then
            local crystal = lever:FindFirstChild("Crystal")
            if crystal and crystal:IsA("MeshPart") and tostring(crystal.MeshId) == meshId then
                local root = lever:FindFirstChild("RootPart")
                local prompt = root and root:FindFirstChildOfClass("ProximityPrompt")
                if prompt then
                    return true
                end
            end
        end
    end
    return false
end

-- =========================
--  FIRE SEMUA PROMPT
-- =========================
function _G.FireAllForMesh(meshId)
    if not _G.Jungle then return end

    for _, lever in ipairs(_G.Jungle:GetChildren()) do
        if lever.Name == "TempleLever" then
            local crystal = lever:FindFirstChild("Crystal")
            if crystal and crystal:IsA("MeshPart") and tostring(crystal.MeshId) == meshId then
                local root = lever:FindFirstChild("RootPart")
                local prompt = root and root:FindFirstChildOfClass("ProximityPrompt")

                if prompt then
                    pcall(fireproximityprompt, prompt)
                end
            end
        end
    end
end

-- =========================
--  TELEPORT PLAYER
-- =========================
function _G.TeleportToStage(stage)
    if _G.StageTP[stage] then
        _G.hrp.CFrame = _G.StageTP[stage]
    end
end

-- =========================
--  MAIN SYSTEM
-- =========================
task.spawn(function()
    while true do
        task.wait(1)

        if _G.autoArtifactEnabled and not _G.isRunning then
            _G.isRunning = true

            local currentStage = 1

            while _G.autoArtifactEnabled and currentStage <= #_G.MeshOrder do

                _G.TeleportToStage(currentStage)
                task.wait(1)

                local meshId = _G.MeshOrder[currentStage]

                if _G.IsQuestNotFinished(meshId) then
                    _G.FireAllForMesh(meshId)
                else
                    -- perbaikan di sini: gunakan penjumlahan biasa (Luau tidak mendukung +=)
                    currentStage = currentStage + 1
                    task.wait(1)
                end

                task.wait(2)
            end

            _G.isRunning = false
        end
    end
end)

--======================================================
--  TOGGLE RAYFIELD
--======================================================
if sections and sections.Quest and sections.Quest.Toggle then
    sections.Quest1:Toggle({
        Name = "Auto Quest Artifact",
        Default = false,
        Callback = function(value)
            _G.autoArtifactEnabled = value

            if Window and Window.Notify then
                Window:Notify({
                    Title = "",
                    Description = (value and "Enabled" or "Disabled") .. " Auto Quest Artifact"
                })
            end
        end,
    }, "AutoQuestArtifact")
end

sections.Quest1:Header({
	Name = "Unlock Door"
})

sections.Quest1:Toggle({
    Name = "Auto Unlock Ancient Ruin",
    Default = false,
    Callback = function(state)

        GameData.AutoUnlock = state

        Window:Notify({
            Title = "Ancient Ruin",
            Description = state and "Auto Unlock Enabled" or "Auto Unlock Disabled"
        })

        -- mulai loop kalau ON
        if state then
            task.spawn(function()
                while GameData.AutoUnlock do

                    GameData.PlacePressureItemEvent =
                        game:GetService("ReplicatedStorage")
                            :WaitForChild("Packages")
                            :WaitForChild("_Index")
                            :WaitForChild("sleitnick_net@0.2.0")
                            :WaitForChild("net")
                            :WaitForChild("RE/PlacePressureItem")

                    for _, fish in ipairs(GameData.FishList) do
                        if not GameData.AutoUnlock then break end
                        GameData.PlacePressureItemEvent:FireServer(fish)
                        task.wait(2.5)
                    end

                    task.wait(10)
                end
            end)
        end

    end
}, "AutoUnlockAncientRuinToggle")

sections.Quest1:Toggle({
    Name = "Auto Unlock Iron Cafe",
    Default = false,
    Callback = function(value)

        GameData.AutoIronCafe = value

        Window:Notify({
            Title = "Iron Cafe",
            Description = value and "Enabled Auto Unlock" or "Disabled Auto Unlock"
        })

        -- ambil event tanpa local
        GameData.IronCafeEvent =
            game:GetService("ReplicatedStorage")
                :WaitForChild("Packages")
                :WaitForChild("_Index")
                :WaitForChild("sleitnick_net@0.2.0")
                :WaitForChild("net")
                :WaitForChild("RE/PlaceCavernTotemItem")

        -- kalau toggle ON
        if GameData.AutoIronCafe then
            GameData.TaskIronCafe = task.spawn(function()
                while GameData.AutoIronCafe do

                    for _, guppy in ipairs(GameData.GuppyList) do
                        if not GameData.AutoIronCafe then
                            break
                        end

                        GameData.IronCafeEvent:FireServer(guppy)
                        task.wait(2.5)
                    end

                    task.wait(10)
                end
            end)
        end
    end
}, "IronCafeToggle")

sections.Auto:Header({
	Name = "Auto Favorite"
})

local Net = require(ReplicatedStorage.Packages.Net)
local ReplionClient = require(ReplicatedStorage.Packages.Replion).Client
local DataReplion = ReplionClient:WaitReplion("Data")
local ItemUtility = require(ReplicatedStorage.Shared.ItemUtility)

-- Remotes
local FavoriteRemote = Net:RemoteEvent("FavoriteItem")

local ItemsFolder = ReplicatedStorage:WaitForChild("Items")

-- ========================================================================
-- STATE
-- ========================================================================
local state = {
    selectedTiers = {},

    autoFavorite = false,
    autoUnfavorite = false,

    stopFavorite = false,
    stopUnfavorite = false,
}

local TierList = GameData.TierList

-- bikin map kebalikan: "Common" ‚Üí 1
local nameToTier = {}
for num, name in pairs(GameData.TierMap) do
    nameToTier[name] = num
end

-- normalizer dropdown multi
local function normalize(value)
    if not value then return {} end
    if type(value) == "string" then return { value } end

    local out = {}
    for k, v in pairs(value) do
        if type(k) == "string" and v == true then
            table.insert(out, k)
        elseif type(v) == "string" then
            table.insert(out, v)
        end
    end
    return out
end

local function isTierMatch(itemTier, selected)
    for _, tName in ipairs(selected) do
        if nameToTier[tName] == tonumber(itemTier) then
            return true
        end
    end
    return false
end

-- ========================================================================
-- SAFE CALL
-- ========================================================================
local function safeFavorite(uuid)
    pcall(function()
        FavoriteRemote:FireServer(uuid)
    end)
end

-- ========================================================================
-- WORKER FAVORITE
-- ========================================================================
local function workerFavorite()
    local RATE = 0.06
    local LOOP_DELAY = 1.1

    while state.autoFavorite do
        if state.stopFavorite then return end

        local inventory = DataReplion:GetExpect("Inventory")
        if inventory and inventory.Items then
            for _, item in ipairs(inventory.Items) do
                if state.stopFavorite then return end

                local ok, data = pcall(function()
                    return ItemUtility.GetItemDataFromItemType("Items", item.Id)
                end)

                if ok and data and data.Data then
                    local tier = data.Data.Tier

                    if isTierMatch(tier, state.selectedTiers) and not item.Favorited then
                        safeFavorite(item.UUID)
                        task.wait(RATE)
                    end
                end
            end
        end

        task.wait(LOOP_DELAY)
    end
end

-- ========================================================================
-- WORKER UNFAVORITE
-- ========================================================================
local function workerUnfavorite()
    local RATE = 0.06
    local LOOP_DELAY = 1.1

    while state.autoUnfavorite do
        if state.stopUnfavorite then return end

        local inventory = DataReplion:GetExpect("Inventory")
        if inventory and inventory.Items then
            for _, item in ipairs(inventory.Items) do
                if state.stopUnfavorite then return end

                local ok, data = pcall(function()
                    return ItemUtility.GetItemDataFromItemType("Items", item.Id)
                end)

                if ok and data and data.Data then
                    local tier = data.Data.Tier

                    if isTierMatch(tier, state.selectedTiers) and item.Favorited then
                        safeFavorite(item.UUID)
                        task.wait(RATE)
                    end
                end
            end
        end

        task.wait(LOOP_DELAY)
    end
end

-- ========================================================================
-- UI SECTION (TRADE DIHAPUS TOTAL)
-- ========================================================================

sections.Auto:Dropdown({
	Name = "Select Tier(s)",
	Search = true,
	Multi = true,
	Options = TierList,
	Default = {"Rare"},
	Callback = function(val)
		state.selectedTiers = normalize(val)

		Window:Notify({
			Title = "Tier Selected",
			Description = table.concat(state.selectedTiers, ", ")
		})
	end
}, "TierDropdown")

sections.Auto:Toggle({
	Name = "Auto Favorite",
	Default = false,
	Callback = function(b)
		state.autoFavorite = b
		state.stopFavorite = not b
		if b then task.spawn(workerFavorite) end
	end
}, "AutoFavoriteToggle")

sections.Auto:Toggle({
	Name = "Auto Unfavorite",
	Default = false,
	Callback = function(b)
		state.autoUnfavorite = b
		state.stopUnfavorite = not b
		if b then task.spawn(workerUnfavorite) end
	end
}, "AutoUnfavoriteToggle")

sections.Auto1:Header({
	Name = "Auto Enchant"
})

-- Anggap PlayerGui sudah ada dan AutoEnchant juga sudah terdefinisi
local playerGui = PlayerGui

-- Buat Paragraph status ENCHANT hanya sekali
local EnchantParagraph = sections.Auto1:Paragraph({
    Header = "Enchant Status",
    Body = "Loading..."
}, nil)

task.spawn(function()
    -- Tunggu GUI "Roll Enchant"
    local rollEnchant = playerGui:WaitForChild("Roll Enchant")
    local main = rollEnchant:WaitForChild("Main")

    -- Tunggu folder "Inside" muncul
    local inside
    repeat
        inside = main:FindFirstChild("Inside")
        task.wait(1)
    until inside

    -- Update status awal
    EnchantParagraph:UpdateBody("Inside Loaded...")

    -- Akses label enchant
    local top = inside:WaitForChild("Top")
    local enchantLabel = top:WaitForChild("EnchantLabel")

    -- GUI siap
    EnchantParagraph:UpdateBody("Ready...")

    -- Loop monitoring text enchant dan update body saja
    local lastText = ""
    while task.wait(1) do
        local currentText = enchantLabel.Text or "Unknown"
        if currentText ~= lastText then
            lastText = currentText
            EnchantParagraph:UpdateBody(currentText)
        end
    end
end)

sections.Auto1:Divider()

-- === FIX TAMBAHAN WAJIB ===
local Options = { SelectedEnchants = {} }
local Toggles = { AutoEnchant = false }

-- Library utama
local Net = require(ReplicatedStorage.Packages.Net)
local Replion = require(ReplicatedStorage.Packages.Replion).Client

-- RemoteEvent
local EquipItemEvent = Net:RemoteEvent("EquipItem")
local EquipToolEvent = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net"):WaitForChild("RE/EquipToolFromHotbar")
local ActivateAltarEvent = ReplicatedStorage:WaitForChild("Packages"):WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0"):WaitForChild("net"):WaitForChild("RE/ActivateEnchantingAltar")

-- === UI baru (Dropdown dan Toggle) ===
sections.Auto1:Dropdown({
    Name = "Select Enchant",
    Search = true,
    Multi = true,
    Required = false,
    Options = {
        "Leprechaun I",
        "Leprechaun II",
        "Mutation Hunter I",
        "Mutation Hunter II",
        "Gold Digger I",
        "Reeler I",
        "Big Hunter I",
        "Empowered I",
        "Glistening I",
        "Stargazer I",
        "Stormhunter I",
        "XPerienced I",
        "Cursed I",
        "Prismatic I"
    },
    Default = {"Leprechaun I"},
    Callback = function(Value)
        Options.SelectedEnchants = {}
        for enchantName, state in pairs(Value) do
            if state then
                Options.SelectedEnchants[enchantName] = true
            end
        end
    end,
}, "EnchantDropdown")

sections.Auto1:Toggle({
    Name = "Auto Enchant",
    Default = false,
    Callback = function(value)
        Toggles.AutoEnchant = value
        if value then
            if currentTask then task.cancel(currentTask) end
            currentTask = task.spawn(function()
                while Toggles.AutoEnchant do
                    local success = doEnchantCycle()
                    if success then
                        Toggles.AutoEnchant = false
                        break
                    else
                        task.wait(3)
                    end
                end
            end)
        else
            if currentTask then
                task.cancel(currentTask)
                currentTask = nil
            end
        end
    end,
}, "AutoEnchantToggle")

-- === Fungsi cek enchant yang dipilih ===
local function isTargetEnchant(text)
    local selected = Options.SelectedEnchants
    if typeof(selected) == "table" then
        for name, state in pairs(selected) do
            if state == true and string.find(text, name) then
                return true
            end
        end
    end
    return false
end

local currentTask

-- === Fungsi utama proses enchant ===
function doEnchantCycle()
    local data = Replion:WaitReplion("Data")
    local inventory = data:GetExpect("Inventory")
    local items = inventory and inventory["Items"]
    if not items then return false end

    local moduleTarget = ReplicatedStorage.Items:FindFirstChild("Enchant Stone")
    if not moduleTarget then return false end

    local ok, moduleData = pcall(require, moduleTarget)
    local targetId = ok and moduleData.Data and moduleData.Data.Id
    if not targetId then return false end

    -- Equip item Enchant Stone
    local equipped = false
    for _, item in pairs(items) do
        if item.Id == targetId and not item.Equip then
            EquipItemEvent:FireServer(item.UUID, "Enchant Stones")
            item.Equip = true
            equipped = true
            break
        end
    end

    if not equipped then return false end
    task.wait(1)

    -- Equip tool di slot 5
    EquipToolEvent:FireServer(5)
    task.wait(1)

    -- Aktifkan altar enchant
    ActivateAltarEvent:FireServer()

    -- Tunggu GUI Roll Enchant
    local rollEnchant = playerGui:WaitForChild("Roll Enchant")
    local main = rollEnchant:WaitForChild("Main")

    local inside
    repeat
        inside = main:FindFirstChild("Inside")
        task.wait(1)
    until inside or not Toggles.AutoEnchant

    if not Toggles.AutoEnchant then return false end

    local top = inside:WaitForChild("Top")
    local enchantLabel = top:WaitForChild("EnchantLabel")

    task.wait(3)

    -- Pantau enchant
    while Toggles.AutoEnchant and task.wait(1) do
        local currentText = enchantLabel.Text
        if isTargetEnchant(currentText) then
            Window:Notify({
                Title = "Enchant Found!",
                Description = currentText,
                Lifetime = 4
            })
            return true
        end

        if currentText ~= "" and currentText ~= "..." and currentText ~= "Rolling..." then
            return false
        end
    end

    return false
end

sections.Shop:Header({
	Name = "Rod Shop"
})

--------------------------------------------------------------------
-- MULTI SELECT SHOP (AUTO OPTIONS)
--------------------------------------------------------------------
local selectedRods = {}
local autoBuyRods = false

sections.Shop:Dropdown({
    Name = "Select Rods",
    Search = true,
    Multi = true,
    Required = false,
    Options = RodNames,
    Default = {},
    Callback = function(value)
        selectedRods = {}

        for rodName, state in pairs(value) do
            if state then
                local id = RodIDs[rodName]
                if id then
                    table.insert(selectedRods, id)
                end
            end
        end
    end,
}, "SelectRodsDropdown")

--------------------------------------------------------------------
-- MANUAL PURCHASE
--------------------------------------------------------------------
sections.Shop:Button({
    Name = "Purchase Selected Rods",
    Callback = function()
        if #selectedRods == 0 then return end

        local remote = ReplicatedStorage
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RF/PurchaseFishing1Rod")

        for _, id in ipairs(selectedRods) do
            pcall(function()
                remote:InvokeServer(id)
            end)
        end
    end,
}, "PurchaseRodsButton")

--------------------------------------------------------------------
-- AUTO PURCHASE LOOP
--------------------------------------------------------------------
sections.Shop:Toggle({
    Name = "Auto Purchase Loop",
    Default = false,
    Callback = function(state)
        autoBuyRods = state

        if state then
            task.spawn(function()

                local remote = ReplicatedStorage
                    :WaitForChild("Packages")
                    :WaitForChild("_Index")
                    :WaitForChild("sleitnick_net@0.2.0")
                    :WaitForChild("net")
                    :WaitForChild("RF/PurchaseFishing1Rod")

                while autoBuyRods do
                    if #selectedRods > 0 then
                        for _, id in ipairs(selectedRods) do
                            pcall(function()
                                remote:InvokeServer(id)
                            end)
                        end
                    end

                    task.wait(5)
                end
            end)
        end
    end,
}, "AutoBuyRodToggle")


sections.Shop1:Header({
	Name = "Bait Shop"
})

--------------------------------------------------------------------
-- MULTI-SELECT BAIT PURCHASE
--------------------------------------------------------------------
local selectedBaits = {}
local autoBuyBait = false

sections.Shop1:Dropdown({
    Name = "Select Baits",
    Search = true,
    Multi = true,
    Required = false,
    Options = baitNames,
    Default = {},
    Callback = function(value)

        selectedBaits = {}

        for baitName, state in pairs(value) do
            if state then
                local id = BaitIDs[baitName]
                if id then
                    table.insert(selectedBaits, id)
                end
            end
        end
    end,
}, "SelectBaitsDropdown")

--------------------------------------------------------------------
-- PURCHASE BUTTON
--------------------------------------------------------------------
sections.Shop1:Button({
    Name = "Purchase Selected Baits",
    Callback = function()
        if #selectedBaits == 0 then return end

        local purchaseRemote = ReplicatedStorage
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RF/PurchaseBait")

        for _, id in ipairs(selectedBaits) do
            pcall(function()
                purchaseRemote:InvokeServer(id)
            end)
        end
    end,
}, "PurchaseBaitsButton")

--------------------------------------------------------------------
-- AUTO PURCHASE LOOP
--------------------------------------------------------------------
sections.Shop1:Toggle({
    Name = "Auto Purchase Loop",
    Default = false,
    Callback = function(state)
        autoBuyBait = state

        if state then
            task.spawn(function()

                local purchaseRemote = ReplicatedStorage
                    :WaitForChild("Packages")
                    :WaitForChild("_Index")
                    :WaitForChild("sleitnick_net@0.2.0")
                    :WaitForChild("net")
                    :WaitForChild("RF/PurchaseBait")

                while autoBuyBait do
                    if #selectedBaits > 0 then
                        for _, id in ipairs(selectedBaits) do
                            pcall(function()
                                purchaseRemote:InvokeServer(id)
                            end)
                        end
                    end
                    task.wait(5)
                end
            end)
        end
    end,
}, "AutoBuyBaitToggle")


sections.Shop2:Header({
	Name = "Skin"
})


sections.Shop3:Header({
	Name = "Weather Shop"
})

-- RemoteEvent untuk beli weather
local PurchaseWeather = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/PurchaseWeatherEvent")

local selectedWeathers = {}
local autoPurchase = false

-- Dropdown multi-select weather list
sections.Shop3:Dropdown({
    Name = "Select Weather Events",
    Search = true,
    Multi = true,
    Required = false,
    Options = { "Snow", "Wind", "Cloudy", "Storm", "Radiant", "Shark Hunt" },
    Default = {},
    Callback = function(values)
        selectedWeathers = {}
        for weatherName, state in pairs(values) do
            if state then
                table.insert(selectedWeathers, weatherName)
            end
        end
    end,
}, "SelectWeatherDropdown")

-- Tombol beli manual
sections.Shop3:Button({
    Name = "Purchase Selected Weather",
    Callback = function()
        if #selectedWeathers == 0 then
            return
        end

        for _, weather in ipairs(selectedWeathers) do
            pcall(function()
                PurchaseWeather:InvokeServer(weather)
            end)
        end
    end,
}, "PurchaseWeatherButton")

-- Toggle auto purchase loop
sections.Shop3:Toggle({
    Name = "Auto Purchase Weather",
    Default = false,
    Callback = function(state)
        autoPurchase = state

        if state then
            task.spawn(function()
                while autoPurchase do
                    if #selectedWeathers > 0 then
                        for _, weather in ipairs(selectedWeathers) do
                            pcall(function()
                                PurchaseWeather:InvokeServer(weather)
                            end)
                            task.wait(2)
                        end
                    end
                    task.wait(2)
                end
            end)
        end
    end,
}, "AutoWeatherPurchaseToggle")


sections.Shop4:Header({
	Name = "Boat Shop"
})

----------------------------------------------------------------
-- REMOTE PURCHASE
----------------------------------------------------------------
local PurchaseBoat = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/PurchaseBoat")

-- Auto generate Boat Options
local PurchaseBoatOptions = {}
for boatName in pairs(GameData.BoatList) do
    table.insert(PurchaseBoatOptions, boatName)
end
table.sort(PurchaseBoatOptions)

local selectedPurchaseBoatID = nil
local autoBuyBoat = false

-- Dropdown pilih boat (Auto dari GameData)
sections.Shop4:Dropdown({
    Name = "Select Boat to Purchase",
    Search = true,
    Multi = false,
    Required = false,
    Options = PurchaseBoatOptions,
    Default = nil,
    Callback = function(option)
        selectedPurchaseBoatID = GameData.BoatList[option]
    end,
}, "SelectBoatDropdown")

-- Tombol manual Purchase
sections.Shop4:Button({
    Name = "Purchase Selected Boat",
    Callback = function()
        if not selectedPurchaseBoatID then return end
        pcall(function()
            PurchaseBoat:InvokeServer(selectedPurchaseBoatID)
        end)
    end,
}, "PurchaseBoatButton")

-- Toggle Auto Purchase Loop
sections.Shop1:Toggle({
    Name = "Auto Purchase Loop",
    Default = false,
    Callback = function(state)
        autoBuyBoat = state
        if state then
            task.spawn(function()
                while autoBuyBoat do
                    if selectedPurchaseBoatID then
                        pcall(function()
                            PurchaseBoat:InvokeServer(selectedPurchaseBoatID)
                        end)
                    end
                    task.wait(5)
                end
            end)
        end
    end,
}, "AutoBuyBoatToggle")


sections.Boat:Header({
	Name = "Boat Spawn"
})


GameData.Player = GameData.Services.Players.LocalPlayer

sections.Boat:Button({
    Name = "Access All Boats",
    Callback = function()

        -- Simpan function ke GameData
        GameData.SetOwnerId = function(boat)
            if boat:GetAttribute("OwnerId") ~= nil then
                boat:SetAttribute("OwnerId", GameData.Player.UserId)
            end
        end

        -- Semua boat yang sudah ada
        for _, v in ipairs(GameData.WorkspaceData.Vehicles:GetChildren()) do
            GameData.SetOwnerId(v)
        end

        -- Boat baru yang spawn
        GameData.WorkspaceData.Vehicles.ChildAdded:Connect(function(child)
            task.wait()
            GameData.SetOwnerId(child)
        end)
    end,
})

local SpawnBoat = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/SpawnBoat")

-- Auto list boat untuk Spawn
local SpawnBoatOptions = {}
for boatName in pairs(GameData.BoatList) do
    table.insert(SpawnBoatOptions, boatName)
end
table.sort(SpawnBoatOptions)

-- Default boat pertama
local selectedSpawnBoatID = GameData.BoatList[SpawnBoatOptions[1]]

-- Dropdown Spawn Boat
sections.Boat:Dropdown({
    Name = "Select Boat to Spawn",
    Search = true,
    Multi = false,
    Required = false,
    Options = SpawnBoatOptions,
    Default = SpawnBoatOptions[1],
    Callback = function(option)
        selectedSpawnBoatID = GameData.BoatList[option]
    end,
}, "SpawnBoatDropdown")

-- Tombol Spawn
sections.Boat:Button({
    Name = "Spawn Boat",
    Callback = function()
        pcall(function()
            SpawnBoat:InvokeServer(selectedSpawnBoatID)
        end)
    end,
}, "SpawnBoatButton")


sections.Boat1:Header({
	Name = "Boat Speed"
})

local customSpeed = 1000

-- Input untuk set kecepatan
sections.Boat1:Input({
    Name = "Set Boat Speed",
    Placeholder = "Example: 1000",
    AcceptedCharacters = "0123456789",
    Callback = function(value)
        local number = tonumber(value)
        if number then
            customSpeed = number
        end
    end,
}, "BoatSpeedInput")

-- Toggle Super Speed
sections.Boat1:Toggle({
    Name = "Super Speed Boats",
    Default = false,
    Callback = function(state)
        local BoatsModule = require(ReplicatedStorage.Shared.BoatsHandlingData)

        -- Simpan speed asli kalau belum ada
        if not BoatsModule._OriginalSpeed then
            BoatsModule._OriginalSpeed = {}
            for boatName, boatData in pairs(BoatsModule) do
                if type(boatData) == "table" and boatData.Speed then
                    BoatsModule._OriginalSpeed[boatName] = boatData.Speed
                end
            end
        end

        if state then
            for _, boatData in pairs(BoatsModule) do
                if type(boatData) == "table" and boatData.Speed then
                    boatData.Speed = customSpeed
                end
            end
        else
            for boatName, boatData in pairs(BoatsModule) do
                if type(boatData) == "table" and boatData.Speed and BoatsModule._OriginalSpeed[boatName] then
                    boatData.Speed = BoatsModule._OriginalSpeed[boatName]
                end
            end
        end
    end,
}, "SuperSpeedToggle")

sections.Tp:Header({
	Name = "Island"
})

-- Ambil semua nama Island & sort
local islandNames = {}
for name in pairs(GameData.Islands) do
    table.insert(islandNames, name)
end

table.sort(islandNames, function(a, b)
    return a:lower() < b:lower()
end)

-- Default dropdown value
local selectedIsland = islandNames[1] or "Kohana"

-- Dropdown Select Island
sections.Tp:Dropdown({
    Name = "Select Island",
    Search = true,
    Multi = false,
    Required = false,
    Options = islandNames,
    Default = selectedIsland,
    Callback = function(value)
        selectedIsland = value
    end,
}, "SelectIslandDropdown")

-- Tombol Teleport
sections.Tp:Button({
    Name = "Teleport Now",
    Callback = function()
        local player = game.Players.LocalPlayer
        local char = player.Character or player.CharacterAdded:Wait()
        if not char then return end

        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local targetCFrame = GameData.Islands[selectedIsland]
        if targetCFrame then
            char:PivotTo(targetCFrame)
        end
    end,
}, "TeleportButton")

sections.Tp:Header({
	Name = "Player"
})

GameData.lp = GameData.Players.LocalPlayer

--==============================================--
-- FUNCTION GET PLAYER LIST
--==============================================--
function GameData.GetPlayerList()
    GameData.list = {}
    for _, plr in ipairs(GameData.Players:GetPlayers()) do
        if plr ~= GameData.lp then
            table.insert(GameData.list, plr.Name)
        end
    end
    return GameData.list
end

--==============================================--
-- DROPDOWN
--==============================================--

GameData.TargetDropdown = sections.Tp:Dropdown({
    Name = "Select Player", 
    Search = true,
    Multi = false,
    Required = false,
    Options = GameData.GetPlayerList(),
    Default = {},
    Callback = function(Value)
        GameData.selectedTarget = Value
    end,
}, "TargetDropdown")


--==============================================--
-- AUTO REFRESH
--==============================================--

task.spawn(function()
    while true do
        task.wait(1)

        GameData.currentOptions = GameData.TargetDropdown:GetOptions()
        GameData.newList = GameData.GetPlayerList()

        GameData.newDict = {}
        for _, name in ipairs(GameData.newList) do
            GameData.newDict[name] = true
        end

        -- HAPUS PLAYER KELUAR
        for name in pairs(GameData.currentOptions) do
            if not GameData.newDict[name] then
                GameData.TargetDropdown:RemoveOptions({name})

                if GameData.selectedTarget == name then
                    GameData.selectedTarget = nil
                    GameData.TargetDropdown:UpdateSelection({})
                end
            end
        end

        -- TAMBAH PLAYER BARU
        for _, name in ipairs(GameData.newList) do
            if not GameData.TargetDropdown:IsOption(name) then
                GameData.TargetDropdown:InsertOptions({name})
            end
        end
    end
end)


--==============================================--
-- TELEPORT BUTTON
--==============================================--

sections.Tp:Button({
    Name = "Teleport Now",
    Callback = function()

        if not GameData.selectedTarget or GameData.selectedTarget == "" then return end

        GameData.target = GameData.Players:FindFirstChild(GameData.selectedTarget)
        if not GameData.target then return end

        GameData.char = GameData.lp.Character or GameData.lp.CharacterAdded:Wait()
        GameData.hrp = GameData.char:WaitForChild("HumanoidRootPart")

        GameData.tchar = GameData.target.Character
        if not GameData.tchar or not GameData.tchar:FindFirstChild("HumanoidRootPart") then return end

        GameData.hrp.CFrame = GameData.tchar.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
    end,
})

sections.Tp1:Header({
	Name = "Position"
})

GameData.folder = GameData.rootFolder .. "/" .. tostring(game.PlaceId)

--------------------------------------------------------------------
-- FOLDER CHECK
--------------------------------------------------------------------
if not isfolder(GameData.rootFolder) then makefolder(GameData.rootFolder) end
if not isfolder(GameData.folder) then makefolder(GameData.folder) end

--------------------------------------------------------------------
-- NOTIFY FUNCTION
--------------------------------------------------------------------
local function Notify(title, desc)
    Window:Notify({
        Title = title,
        Description = desc,
        Lifetime = 4
    })
end

--------------------------------------------------------------------
-- SAVE POSITION TO FILE
--------------------------------------------------------------------
local function savePosToFile(slotName, cframe)
    local path = GameData.folder .. "/" .. slotName .. ".txt"
    local data = string.format(
        "CFrame.new(%f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f, %f)",
        cframe:GetComponents()
    )
    writefile(path, data)
end

--------------------------------------------------------------------
-- LOAD POSITION FROM FILE
--------------------------------------------------------------------
local function loadPosFromFile(slotName)
    local path = GameData.folder .. "/" .. slotName .. ".txt"
    if not isfile(path) then return nil end

    local raw = readfile(path)
    local ok, res = pcall(function()
        return loadstring("return " .. raw)()
    end)

    if ok and typeof(res) == "CFrame" then
        return res
    end

    return nil
end

--------------------------------------------------------------------
-- LOAD ALL SAVES ON STARTUP
--------------------------------------------------------------------
for _, file in pairs(listfiles(GameData.folder)) do
    local name = file:match(".+/(.+)%.txt$")
    if name then
        GameData.SavedPositions[name] = loadPosFromFile(name)
    end
end

--------------------------------------------------------------------
-- UI SETUP
--------------------------------------------------------------------
GameData.SaveDropdown = sections.Tp1:Dropdown({
    Name = "Save Position Slot",
    Search = true,
    Multi = false,
    Required = false,
    Options = {},
    Default = "",
    Callback = function(Value)
        if not Value or Value == "" then
            GameData.selectedSlot = nil
            Notify("No Selection", "Please pick a slot.")
            return
        end

        GameData.selectedSlot = Value
        if GameData.SavedPositions[Value] then
            Notify("Selected!", "Slot valid: " .. Value)
        else
            Notify("Empty Slot!", Value .. " is empty.")
        end
    end,
}, "SavePosDropdown")

GameData.SaveButton = sections.Tp1:Button({
    Name = "Save Position",
    Callback = function() end
})

GameData.DeleteButton = sections.Tp1:Button({
    Name = "Delete Save",
    Callback = function() end
})

GameData.RefreshButton = sections.Tp1:Button({
    Name = "Refresh Slot List",
    Callback = function() end
})

--------------------------------------------------------------------
-- REFRESH SLOT LIST
--------------------------------------------------------------------
local function refreshSlots()
    GameData.options = {}

    for _, file in pairs(listfiles(GameData.folder)) do
        local name = file:match(".+/(.+)%.txt$")
        if name then
            table.insert(GameData.options, name)
        end
    end

    GameData.SaveDropdown:ClearOptions()
    GameData.SaveDropdown:InsertOptions(GameData.options)
    Notify("Refreshed!", "Total Saves: " .. tostring(#GameData.options))
end
refreshSlots()

--------------------------------------------------------------------
-- SLOT NAME INPUT
--------------------------------------------------------------------
sections.Tp1:Input({
    Name = "Slot Name",
    Placeholder = "Type slot name...",
    AcceptedCharacters = "All",
    Callback = function(text)
        GameData.customSlotName = text:gsub("[^%w%s_%-_]", "")
    end,
}, "SaveSlotNameInput")

--------------------------------------------------------------------
-- SAVE POSITION CALLBACK
--------------------------------------------------------------------
GameData.SaveButton.Settings.Callback = function()
    GameData.char = GameData.LocalPlayer.Character
    GameData.hrp = GameData.char and GameData.char:FindFirstChild("HumanoidRootPart")

    if GameData.customSlotName == "" then
        Notify("Error!", "Input a slot name first.")
        return
    end
    if not GameData.hrp then
        Notify("Error!", "HumanoidRootPart not found.")
        return
    end

    GameData.SavedPositions[GameData.customSlotName] = GameData.hrp.CFrame
    savePosToFile(GameData.customSlotName, GameData.hrp.CFrame)

    refreshSlots()
    GameData.SaveDropdown:UpdateSelection(GameData.customSlotName)

    Notify("Saved!", "Slot " .. GameData.customSlotName .. " saved!")
end

--------------------------------------------------------------------
-- DELETE SAVE CALLBACK
--------------------------------------------------------------------
GameData.DeleteButton.Settings.Callback = function()
    local slot = GameData.selectedSlot
    if not slot then
        Notify("Error!", "Select a slot first.")
        return
    end

    local path = GameData.folder .. "/" .. slot .. ".txt"
    if not isfile(path) then
        Notify("Error!", "No file found for " .. slot)
        return
    end

    delfile(path)
    GameData.SavedPositions[slot] = nil
    GameData.selectedSlot = nil

    refreshSlots()
    GameData.SaveDropdown:UpdateSelection(nil)

    Notify("Deleted!", "Save removed.")
end

--------------------------------------------------------------------
-- REFRESH BUTTON CALLBACK
--------------------------------------------------------------------
GameData.RefreshButton.Settings.Callback = refreshSlots

--------------------------------------------------------------------
-- TELEPORT LOCK SYSTEM
--------------------------------------------------------------------
local function freezeToSlot(slot)
    local target = GameData.SavedPositions[slot]
    if not target then
        Notify("Error!", "Slot empty.")
        return
    end

    GameData.char = GameData.LocalPlayer.Character
    GameData.hrp = GameData.char and GameData.char:FindFirstChild("HumanoidRootPart")
    if not GameData.hrp then return end

    GameData.bv = Instance.new("BodyVelocity")
    GameData.bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
    GameData.bv.Velocity = Vector3.zero
    GameData.bv.Parent = GameData.hrp

    GameData.bg = Instance.new("BodyGyro")
    GameData.bg.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
    GameData.bg.CFrame = target
    GameData.bg.Parent = GameData.hrp

    task.spawn(function()
        while GameData.teleportEnabled and GameData.hrp.Parent do
            if (GameData.hrp.Position - target.Position).Magnitude > 2 then
                GameData.hrp.CFrame = target
            end
            task.wait(0.1)
        end

        if GameData.bv then GameData.bv:Destroy() end
        if GameData.bg then GameData.bg:Destroy() end
    end)
end

--------------------------------------------------------------------
-- TELEPORT TOGGLE
--------------------------------------------------------------------
sections.Tp1:Toggle({
    Name = "Teleport to Saved Position",
    Default = false,
    Callback = function(state)
        GameData.teleportEnabled = state

        if state then
            if not GameData.selectedSlot then
                Notify("Error!", "Select a slot first.")
                GameData.teleportEnabled = false
                return
            end
            freezeToSlot(GameData.selectedSlot)
        end
    end,
}, "TeleportToggleConfig")

print("Teleport system loaded.")


sections.Player:Header({
	Name = "Utility"
})

--// Anti Drown Variable
local AntiDrown_Enabled = false

--// Toggle di WindUI
sections.Player:Toggle({
    Name = "Anti Drown",
    Default = false,
    Callback = function(value)
        AntiDrown_Enabled = value

        Window:Notify({
            Title = "Drown",
            Description = (value and "Enabled " or "Disabled ") .. "Anti Drown"
        })
    end,
}, "AntiDrownToggle")

--// Metamethod Hook (Anti Drown)
local rawmt = getrawmetatable(game)
setreadonly(rawmt, false)

local oldNamecall = rawmt.__namecall

rawmt.__namecall = newcclosure(function(self, ...)
    local method = getnamecallmethod()

    if AntiDrown_Enabled 
        and tostring(self) == "URE/UpdateOxygen" 
        and method == "FireServer" then
        
        return nil
    end

    return oldNamecall(self, ...)
end)

sections.Player:Toggle({
    Name = "Bypass Radar",
    Default = false,
    Callback = function(state)
        Window.AlwayShowTab = state

        local remoteFunc = ReplicatedStorage
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RF/UpdateFishing1Radar")

        pcall(function()
            remoteFunc:InvokeServer(state)
        end)
    end,
}, "BypassRadarToggle")

local volcanoFolder = workspace.Zones["Kohana Volcano"]
local RunService = game:GetService("RunService")

sections.Player:Toggle({
    Name = "Anti Lava",
    Default = false,
    Callback = function(state)
        if state then
            GameData.connection = RunService.Heartbeat:Connect(function()
                for _, obj in ipairs(volcanoFolder:GetDescendants()) do
                    if obj:IsA("TouchTransmitter") then
                        obj:Destroy()
                    end
                end
            end)

        else
            if GameData.connection then
                GameData.connection:Disconnect()
                GameData.connection = nil
            end
        end
    end,
}, "AntiLavaToggle")


sections.Player:Toggle({
    Name = "Hide Notifications",
    Default = false,
    Callback = function(value)
        local gui = player:WaitForChild("PlayerGui")
        
        -- Small Notification
        local smallNotif = gui:FindFirstChild("Small Notification")
        if smallNotif and smallNotif:FindFirstChild("Display") then
            smallNotif.Display.Visible = not value  -- ON: false, OFF: true
        end

        -- Text Notifications
        local textNotif = gui:FindFirstChild("Text Notifications")
        if textNotif and textNotif:FindFirstChild("Frame") then
            textNotif.Frame.Visible = not value  -- ON: false, OFF: true
        end

        -- Notifikasi WindUI
        Window:Notify({
            Title = "Hide Notifications",
            Description = value and "Enabled" or "Disabled"
        })
    end,
}, "HideNotificationsToggle")

-- set player dan userId
GameData.Player = GameData.Players.LocalPlayer
GameData.UserIdString = tostring(GameData.Player.UserId)

-- kembalikan kamera ke normal
function GameData.RestoreCamera()
    if GameData.Player.Character and GameData.Player.Character:FindFirstChild("Humanoid") then
        GameData.Camera.CameraSubject = GameData.Player.Character.Humanoid
        GameData.Camera.CameraType = Enum.CameraType.Custom
    end
end

-- fokus ke part
function GameData.ViewObject(part)
    GameData.Camera.CameraSubject = part
    GameData.Camera.CameraType = Enum.CameraType.Attach
end

-- monitoring muncul/hilang
GameData.RunService.RenderStepped:Connect(function()
    if GameData.ViewBobbersEnabled then
        local part = GameData.CosmeticFolder:FindFirstChild(GameData.UserIdString)

        if part and part:IsA("BasePart") then
            if GameData.Camera.CameraSubject ~= part then
                GameData.ViewObject(part)
            end
        else
            if GameData.Player.Character and GameData.Player.Character:FindFirstChild("Humanoid") then
                if GameData.Camera.CameraSubject ~= GameData.Player.Character.Humanoid then
                    GameData.RestoreCamera()
                end
            end
        end
    else
        GameData.RestoreCamera()
    end
end)

-- toggle GUI
sections.Player:Toggle({
    Name = "View Bobbers",
    Default = false,
    Callback = function(value)
        GameData.ViewBobbersEnabled = value
        Window:Notify({
            Title = "View Bobbers",
            Description = (value and "Enabled" or "Disabled") .. " View Bobbers"
        })
        if not value then
            GameData.RestoreCamera()
        end
    end
}, "ViewBobbersToggle")

sections.Player:Toggle({
    Name = "Infinite Zoom", 
    Default = false,
    Callback = function(val)

        GameData.infiniteZoomEnabled = val

        if GameData.infiniteZoomEnabled then
            -- Enable Infinite Zoom
            GameData.player.CameraMaxZoomDistance = math.huge
            GameData.player.CameraMinZoomDistance = 0.5
        else
            -- Disable Infinite Zoom (default Roblox values)
            GameData.player.CameraMaxZoomDistance = 16
            GameData.player.CameraMinZoomDistance = 0.5
        end

        Window:Notify({
            Title = "Infinite Zoom",
            Description = (GameData.infiniteZoomEnabled and "Enabled " or "Disabled ") .. "Infinite Zoom"
        })
    end,
}, "InfiniteZoomToggle")

-- Initialize folder
GameData.waterVFXFolder = GameData.RS:WaitForChild("VFX")


---------------------------------------------------------
-- REMOVE VFX TOGGLE
---------------------------------------------------------
sections.Player:Toggle({
    Name = "Remove VFX",
    Default = false,
    Callback = function(value)

        Window:Notify({
            Title = "Remove VFX",
            Description = (value and "Enabled" or "Disabled")
        })

        if value then

            -----------------------------------------------------
            -- DELETE EXISTING VFX + SAVE CLONES
            -----------------------------------------------------
            for _, obj in ipairs(GameData.waterVFXFolder:GetChildren()) do
                if not GameData.storedVFX[obj.Name] then
                    GameData.storedVFX[obj.Name] = obj:Clone()
                end
                obj:Destroy()
            end

            -----------------------------------------------------
            -- DELETE NEWLY ADDED VFX AUTOMATICALLY
            -----------------------------------------------------
            if not GameData.childAddedConn then
                GameData.childAddedConn = GameData.waterVFXFolder.ChildAdded:Connect(function(obj)
                    task.wait(0.05)
                    if obj and sections.Player:Get("RemoveVFXToggle") then

                        if not GameData.storedVFX[obj.Name] then
                            GameData.storedVFX[obj.Name] = obj:Clone()
                        end

                        obj:Destroy()
                    end
                end)
            end

        else

            -----------------------------------------------------
            -- DISABLE LISTENER
            -----------------------------------------------------
            if GameData.childAddedConn then
                GameData.childAddedConn:Disconnect()
                GameData.childAddedConn = nil
            end

            -----------------------------------------------------
            -- RESTORE ALL SAVED VFX
            -----------------------------------------------------
            for name, clone in pairs(GameData.storedVFX) do
                if not GameData.waterVFXFolder:FindFirstChild(name) then
                    clone:Clone().Parent = GameData.waterVFXFolder
                end
            end

            GameData.storedVFX = {}
        end
    end,
}, "RemoveVFXToggle")

-- Character Handler
GameData.character = GameData.player.Character or GameData.player.CharacterAdded:Wait()
GameData.hrp = GameData.character:WaitForChild("HumanoidRootPart")

GameData.player.CharacterAdded:Connect(function(char)
    GameData.character = char
    GameData.hrp = char:WaitForChild("HumanoidRootPart")
end)


---------------------------------------------------------
-- üåä WALK ON WATER TOGGLE
---------------------------------------------------------
sections.Player:Toggle({ 
    Name = "Walk On Water", 
    Default = false,
    Callback = function(value)

        Window:Notify({
            Title = "Walk On Water",
            Description = (value and "Enabled" or "Disabled")
        })

        if value then

            -- Create platform if not exist
            if not GameData.waterPlatform then
                GameData.waterPlatform = Instance.new("Part")
                GameData.waterPlatform.Name = "WaterWalkPlatform"
                GameData.waterPlatform.Size = Vector3.new(15, 1, 15)
                GameData.waterPlatform.Anchored = true
                GameData.waterPlatform.CanCollide = false
                GameData.waterPlatform.Transparency = 1
                GameData.waterPlatform.Material = Enum.Material.SmoothPlastic
                GameData.waterPlatform.Parent = workspace
            end

            -- create heartbeat loop
            if not GameData.connection then
                GameData.connection = GameData.RunService.Heartbeat:Connect(function()
                    if not GameData.waterPlatform or not GameData.hrp then return end

                    GameData.waterPlatform.Position = Vector3.new(
                        GameData.hrp.Position.X,
                        GameData.waterHeight,
                        GameData.hrp.Position.Z
                    )

                    GameData.waterPlatform.CanCollide =
                        GameData.hrp.Position.Y > GameData.waterHeight
                end)
            end

        else
            -- Disable all
            if GameData.connection then
                GameData.connection:Disconnect()
                GameData.connection = nil
            end

            if GameData.waterPlatform then
                GameData.waterPlatform:Destroy()
                GameData.waterPlatform = nil
            end
        end
    end,
}, "WalkOnWaterToggle")

sections.Player:Button({
    Name = "Boost FPS",
    Callback = function()
        local Lighting = game:GetService("Lighting")
        local Workspace = game:GetService("Workspace")
        local Terrain = Workspace:FindFirstChildOfClass("Terrain")

        -- Lighting Optimization
        Lighting.GlobalShadows = false
        Lighting.FogEnd = 1e10
        Lighting.BFullness = 1
        Lighting.ExposureCompensation = 0
        Lighting.EnvironmentDiffuseScale = 0
        Lighting.EnvironmentSpecularScale = 0
        Lighting.OutdoorAmbient = Color3.fromRGB(128,128,128)
        Lighting.ShadowSoftness = 0
        Lighting.ColorShift_Bottom = Color3.new(0,0,0)
        Lighting.ColorShift_Top = Color3.new(0,0,0)

        -- Terrain Optimization
        if Terrain then
            Terrain.WaterWaveSize = 0
            Terrain.WaterWaveSpeed = 0
            Terrain.WaterReflectance = 0
            Terrain.WaterTransparency = 1
            sethiddenproperty(Terrain, "Decoration", false)
        end

        -- Disable Visual Effects (Bloom, Blur, SunRays, dll)
        for _, v in pairs(Lighting:GetChildren()) do
            if v:IsA("BloomEffect") or v:IsA("BlurEffect") or v:IsA("SunRaysEffect") or v:IsA("ColorCorrectionEffect") or v:IsA("DepthOfFieldEffect") then
                v.Enabled = false
            end
        end

        -- Mass Disable Visuals (tanpa hapus animasi/suara)
        pcall(function()
            for _, obj in pairs(Workspace:GetDescendants()) do
                if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Fire") or obj:IsA("Smoke") or obj:IsA("Sparkles") or obj:IsA("Explosion") then
                    obj.Enabled = false
                elseif obj:IsA("Decal") or obj:IsA("Texture") then
                    obj.Transparency = 1
                elseif obj:IsA("MeshPart") or obj:IsA("UnionOperation") or obj:IsA("Part") then
                    obj.Material = Enum.Material.SmoothPlastic
                    obj.Reflectance = 0
                end
            end
        end)

        -- Rendering Quality to Lowest
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01

        -- Optimize Camera
        for _, cam in pairs(Workspace:GetDescendants()) do
            if cam:IsA("Camera") then
                cam.FieldOfView = 70
            end
        end

        -- Garbage Clean
        collectgarbage("collect")
    end,
}, "BoostFPSButton")

sections.Player:Button({
    Name = "Reduce Lag",
    Callback = function()
        local Workspace = game:GetService("Workspace")
        local Lighting = game:GetService("Lighting")
        local player = game.Players.LocalPlayer

        Lighting.GlobalShadows = false
        Lighting.FogEnd = 9e9
        Lighting.BFullness = 1
        Lighting.OutdoorAmbient = Color3.fromRGB(128,128,128)
        Lighting.ExposureCompensation = 0
        Lighting.ShadowSoftness = 0

        for _, obj in pairs(Workspace:GetDescendants()) do
            if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Explosion") then
                obj.Enabled = false
            elseif obj:IsA("Decal") or obj:IsA("Texture") then
                obj.Transparency = 1
            end
        end

        for _, gui in pairs(player:WaitForChild("PlayerGui"):GetDescendants()) do
            if gui:IsA("TextLabel") or gui:IsA("TextButton") then
                gui.TextScaled = false
            elseif gui:IsA("ImageLabel") or gui:IsA("ImageButton") then
                gui.ImageTransparency = 0.5
            end
        end
    end,
}, "ReduceLagButton")

sections.Player1:Header({
	Name = "User Settings"
})

-- Paragraph UI
GameData.AntiAFKParagraph = sections.Player1:Paragraph({
    Header = "Anti AFK Time",
    Body = "AFK: 0 Min 0 Sec"
})


----------------------------------------------------
-- RESET AFK SAAT PLAYER BERGERAK
----------------------------------------------------
function GameData.resetAFK()
    GameData.lastInput = tick()
end

GameData.connections.began =
    GameData.UserInputService.InputBegan:Connect(GameData.resetAFK)

GameData.connections.changed =
    GameData.UserInputService.InputChanged:Connect(GameData.resetAFK)

GameData.connections.ended =
    GameData.UserInputService.InputEnded:Connect(GameData.resetAFK)


----------------------------------------------------
-- LOOP UTAMA
----------------------------------------------------
task.spawn(function()
    while true do
        task.wait(1)

        -- ‚õî Tidak ada local ‚õî
        GameData.runtime.totalSeconds = math.floor(tick() - GameData.lastInput)
        GameData.runtime.minutes = math.floor(GameData.runtime.totalSeconds / 60)
        GameData.runtime.seconds = GameData.runtime.totalSeconds % 60

        GameData.AntiAFKParagraph:UpdateBody(
            "AFK: " ..
            GameData.runtime.minutes .. " Min " ..
            GameData.runtime.seconds .. " Sec"
        )

        if GameData.runtime.totalSeconds >= GameData.intervalMinutes * 60 then
            GameData.UserInputService.MouseIconEnabled = true
            task.wait(GameData.showSeconds)
            GameData.UserInputService.MouseIconEnabled = false

            GameData.lastInput = tick()
        end
    end
end)

----------------------------------------------------
-- =============== FUNCTIONS =======================
----------------------------------------------------
function GameData:GetHumanoid()
    return self.char:WaitForChild("Humanoid")
end

function GameData:ApplyWalkspeed()
    if self.hum then
        self.hum.WalkSpeed = self.WalkspeedEnabled and self.WalkspeedValue or 16
    end
end

function GameData:ApplyJumpPower()
    if self.hum then
        self.hum.UseJumpPower = true
        self.hum.JumpPower = self.JumpEnabled and self.JumpValue or 50
    end
end

function GameData:ApplyGravity()
    workspace.Gravity = self.GravityEnabled and self.GravityValue or 196.2
end
----------------------------------------------------
-- =============== INITIALIZE ======================
----------------------------------------------------
GameData.Player = game.Players.LocalPlayer
GameData.char = GameData.Player.Character or GameData.Player.CharacterAdded:Wait()

GameData.hum = GameData:GetHumanoid()
----------------------------------------------------
-- =============== RESPAWN HANDLER =================
----------------------------------------------------
GameData.Player.CharacterAdded:Connect(function(char)
    GameData.char = char
    task.wait(0.3)
    GameData.hum = GameData:GetHumanoid()
    GameData:ApplyWalkspeed()
    GameData:ApplyJumpPower()
end)
----------------------------------------------------
-- ================== WINDUI UI ====================
----------------------------------------------------
--------------------------
-- Walkspeed Controller --
--------------------------
sections.Player1:Slider({
    Name = "Set Walkspeed",
    Default = GameData.WalkspeedValue,
    Minimum = 0,
    Maximum = 300,
    DisplayMethod = "Number",
    Callback = function(Value)
        GameData.WalkspeedValue = Value
        GameData:ApplyWalkspeed()
    end,
}, "WalkspeedSlider")

sections.Player1:Toggle({
    Name = "Walkspeed",
    Default = GameData.WalkspeedEnabled,
    Callback = function(state)
        GameData.WalkspeedEnabled = state
        Window:Notify({
            Title = "Walkspeed",
            Description = state and ("Enabled ("..GameData.WalkspeedValue..")") or "Disabled"
        })
        GameData:ApplyWalkspeed()
    end,
}, "WalkspeedToggle")

--------------------------
-- Jump Power Controller --
--------------------------
sections.Player1:Slider({
    Name = "Set Jump Power",
    Default = GameData.JumpValue,
    Minimum = 0,
    Maximum = 300,
    DisplayMethod = "Number",
    Callback = function(Value)
        GameData.JumpValue = Value
        GameData:ApplyJumpPower()
    end,
}, "JumpPowerSlider")

sections.Player1:Toggle({
    Name = "Auto Jump Power",
    Default = GameData.JumpEnabled,
    Callback = function(state)
        GameData.JumpEnabled = state
        Window:Notify({
            Title = "Jump Power",
            Description = state and ("Enabled ("..GameData.JumpValue..")") or "Disabled"
        })
        GameData:ApplyJumpPower()
    end,
}, "JumpToggle")

--------------------------
-- Gravity Controller ----
--------------------------
sections.Player1:Slider({
    Name = "Set Gravity",
    Default = GameData.GravityValue,
    Minimum = 0,
    Maximum = 400,
    DisplayMethod = "Number",
    Callback = function(Value)
        GameData.GravityValue = Value
        GameData:ApplyGravity()
    end,
}, "GravitySlider")

sections.Player1:Toggle({
    Name = "Gravity Controller",
    Default = GameData.GravityEnabled,
    Callback = function(state)
        GameData.GravityEnabled = state
        Window:Notify({
            Title = "Gravity",
            Description = state and ("Enabled ("..GameData.GravityValue..")") or "Disabled"
        })
        GameData:ApplyGravity()
    end,
}, "GravityToggle")




-- Config

sections.Config:Header({
	Name = "UI Settings"
})

-----------------------------
-- WINDOW WIDTH INPUT
-----------------------------
sections.Config:Input({
    Name = "Window Width",
    Placeholder = "800",
    AcceptedCharacters = "Numbers",
    Callback = function(val)
        GameData.inputValue = val
        GameData.windowWidth = tonumber(GameData.inputValue)

        if GameData.windowWidth then
            GameData.currentSize = Window:GetSize()
            Window:SetSize(UDim2.fromOffset(GameData.windowWidth, GameData.currentSize.Y.Offset))
        end
    end
})

-----------------------------
-- WINDOW HEIGHT INPUT
-----------------------------
sections.Config:Input({
    Name = "Window Height (Not Working)",
    Placeholder = "400",
    AcceptedCharacters = "Numbers",
    Callback = function(val)
        GameData.inputValue = val
        GameData.windowHeight = tonumber(GameData.inputValue)

        if GameData.windowHeight then
            GameData.currentSize = Window:GetSize()
            Window:SetSize(UDim2.fromOffset(GameData.currentSize.X.Offset, GameData.windowHeight))
        end
    end
})


-----------------------------
-- WINDOW SCALE INPUT
-----------------------------
sections.Config:Input({
    Name = "Window Scale",
    Placeholder = "0.70",
    AcceptedCharacters = "Numbers",
    Callback = function(val)
        GameData.inputValue = val
        GameData.windowScale = tonumber(GameData.inputValue)

        if GameData.windowScale then
            Window:SetScale(GameData.windowScale)
        end
    end
})

MacLib:SetFolder("Maclib")
tabs.Config:InsertConfigSection("Full") -- karena yang ada adalah 'Config'

Window.onUnloaded(function()
	print("Unloaded! Enjoyy my script :)")
end)

tabs.Home:Select() -- pilih tab yang benar-benar ada
MacLib:LoadAutoLoadConfig()



-------------------------------------------------------------
-- CREATE TOGGLE GUI
-------------------------------------------------------------
GameData.ScreenGui = Instance.new("ScreenGui")
GameData.ScreenGui.Name = "NexaUIToggle"
GameData.ScreenGui.IgnoreGuiInset = true
GameData.ScreenGui.ResetOnSpawn = false
GameData.ScreenGui.Parent = GameData.CoreGui

-------------------------------------------------------------
-- FRAME
-------------------------------------------------------------
GameData.ToggleFrame = Instance.new("Frame")
GameData.ToggleFrame.Parent = GameData.ScreenGui
GameData.ToggleFrame.Size = UDim2.new(0, 50, 0, 50)
GameData.ToggleFrame.Position = UDim2.new(0, 110, 0, 95)
GameData.ToggleFrame.BackgroundColor3 = Color3.fromRGB(20, 80, 200)
GameData.ToggleFrame.BorderSizePixel = 0

GameData.Corner = Instance.new("UICorner")
GameData.Corner.CornerRadius = UDim.new(0, 14)
GameData.Corner.Parent = GameData.ToggleFrame

GameData.Gradient = Instance.new("UIGradient")
GameData.Gradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(36, 112, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 42, 130)),
})
GameData.Gradient.Rotation = 45
GameData.Gradient.Parent = GameData.ToggleFrame

GameData.Glow = Instance.new("ImageLabel")
GameData.Glow.Parent = GameData.ToggleFrame
GameData.Glow.Size = UDim2.new(1.7, 0, 1.7, 0)
GameData.Glow.Position = UDim2.new(0.5, 0, 0.5, 0)
GameData.Glow.AnchorPoint = Vector2.new(0.5, 0.5)
GameData.Glow.BackgroundTransparency = 1
GameData.Glow.Image = "rbxassetid://12171505282"
GameData.Glow.ImageColor3 = Color3.fromRGB(0, 153, 255)
GameData.Glow.ImageTransparency = 0.35

GameData.Stroke = Instance.new("UIStroke")
GameData.Stroke.Parent = GameData.ToggleFrame
GameData.Stroke.Thickness = 2
GameData.Stroke.Color = Color3.fromRGB(140, 200, 255)
GameData.Stroke.Transparency = 0.25

-------------------------------------------------------------
-- BUTTON
-------------------------------------------------------------
GameData.ToggleBtn = Instance.new("ImageButton")
GameData.ToggleBtn.Parent = GameData.ToggleFrame
GameData.ToggleBtn.Size = UDim2.new(0, 40, 0, 40)
GameData.ToggleBtn.Position = UDim2.new(0.5, -20, 0.5, -20)
GameData.ToggleBtn.BackgroundTransparency = 1
GameData.ToggleBtn.Image = "rbxassetid://123906607434048"

-------------------------------------------------------------
-- DRAG FUNCTIONS
-------------------------------------------------------------
GameData.beginDrag = function(input)
    GameData.Dragging = true
    GameData.DragStart = input.Position
    GameData.StartPos = GameData.ToggleFrame.Position
end

GameData.updateDrag = function(input)
    local delta = input.Position - GameData.DragStart
    GameData.ToggleFrame.Position = UDim2.new(
        GameData.StartPos.X.Scale,
        GameData.StartPos.X.Offset + delta.X,
        GameData.StartPos.Y.Scale,
        GameData.StartPos.Y.Offset + delta.Y
    )
end

GameData.endDrag = function()
    GameData.Dragging = false
end

-------------------------------------------------------------
-- DRAG CONNECTIONS
-------------------------------------------------------------
for _, obj in ipairs({GameData.ToggleFrame, GameData.ToggleBtn}) do
    obj.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then

            GameData.beginDrag(input)

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    GameData.endDrag()
                end
            end)
        end
    end)
end

GameData.UIS.InputChanged:Connect(function(input)
    if GameData.Dragging then
        if input.UserInputType == Enum.UserInputType.MouseMovement
        or input.UserInputType == Enum.UserInputType.Touch then
            GameData.updateDrag(input)
        end
    end
end)

-------------------------------------------------------------
-- BUTTON TOGGLE
-------------------------------------------------------------
GameData.ToggleBtn.MouseButton1Click:Connect(function()
    GameData.TweenService:Create(GameData.ToggleBtn, TweenInfo.new(0.08), {
        Size = UDim2.new(0, 35, 0, 35)
    }):Play()

    task.wait(0.08)

    GameData.TweenService:Create(GameData.ToggleBtn, TweenInfo.new(0.12), {
        Size = UDim2.new(0, 40, 0, 40)
    }):Play()

    GameData.uiVisible = not GameData.uiVisible

    if Window and Window.SetState then
        Window:SetState(GameData.uiVisible)
    end
end)

-------------------------------------------------------------
-- DELETE TOGGLE WHEN WINDOW CLOSED
-------------------------------------------------------------
Window.onUnloaded(function()
    print("NexaHub Window Closed")

    if GameData.ScreenGui then
        GameData.ScreenGui:Destroy()
        GameData.ScreenGui = nil
    end

    GameData.uiVisible = false
end)
