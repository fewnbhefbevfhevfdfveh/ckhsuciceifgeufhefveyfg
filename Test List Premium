--// SERVICES
local Players = game:GetService("Players")
local player = Players.LocalPlayer

--// EXECUTOR REQUEST (MULTI EXECUTOR)
local Request =
    (syn and syn.request)
    or (http and http.request)
    or http_request
    or (fluxus and fluxus.request)
    or (krnl and request)

if not Request then
    player:Kick("❌ Executor tidak support HTTP request.")
    return
end

--// CEK KEY
if typeof(script_key) ~= "string" or script_key == "" then
    player:Kick("❌ Key is required.")
    return
end

--// AUTH URL
local url =
    "https://han2343.pythonanywhere.com/check"
    .. "?userid=" .. player.UserId
    .. "&key=" .. script_key

--// REQUEST KE SERVER
local response
local success, err = pcall(function()
    response = Request({
        Url = url,
        Method = "GET"
    })
end)

if not success or not response or not response.Body then
    player:Kick("❌ Auth server unreachable.")
    return
end

--// PARSE JSON
local data
success, err = pcall(function()
    data = game:GetService("HttpService"):JSONDecode(response.Body)
end)

if not success or not data then
    player:Kick("❌ Invalid server response.")
    return
end

--// HASIL AUTH
if not data.allowed then
    if data.reason == "user_not_whitelisted" then
        player:Kick("❌ UserId tidak terdaftar.")
    elseif data.reason == "invalid_key" then
        player:Kick("❌ Key salah.")
    else
        player:Kick("❌ Access denied.")
    end
    return
end

--// ✅ AUTH SUCCESS → LOAD SCRIPT PREMIUM
pcall(function()
    loadstring(game:HttpGet(
        "https://raw.githubusercontent.com/fewnbhefbevfhevfdfveh/ckhsuciceifgeufhefveyfg/refs/heads/main/jduwgfPREMIUM"
    ))()
end)
