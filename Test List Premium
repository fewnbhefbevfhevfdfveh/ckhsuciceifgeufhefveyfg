--// SERVICES
local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer

-- VALIDASI KEY ADA ATAU TIDAK
if typeof(script_key) ~= "string" or script_key == "" then
	player:Kick("❌ Key is required.")
	return
end

-- URL AUTH SERVER
local url =
	"https://han2343.pythonanywhere.com/check"
	.. "?userid=" .. player.UserId
	.. "&key=" .. script_key

-- REQUEST KE SERVER
local success, response = pcall(function()
	return HttpService:GetAsync(url)
end)

if not success then
	player:Kick("❌ Auth server unreachable.")
	return
end

local data = HttpService:JSONDecode(response)

-- ❌ DITOLAK
if not data.allowed then
	if data.reason == "user_not_whitelisted" then
		player:Kick("❌ UserId tidak terdaftar.")
	elseif data.reason == "invalid_key" then
		player:Kick("❌ Key salah.")
	else
		player:Kick("❌ Access denied.")
	end
	return
end

-- ✅ VALID → LOAD SCRIPT UTAMA
pcall(function()
	loadstring(game:HttpGet(
		"https://raw.githubusercontent.com/fewnbhefbevfhevfdfveh/ckhsuciceifgeufhefveyfg/refs/heads/main/jduwgfPREMIUM"
	))()
end)
