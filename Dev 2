local MacLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Enow-Development/maclib-extended/refs/heads/main/maclib.lua"))()
loadstring(game:HttpGet("https://raw.githubusercontent.com/xwvufdwgqudwyfwdvwedyuvwd/gbewufbeufbeugfvr/refs/heads/main/ggegrhrhhr%20Info%20Fish%20Mythic"))()


-- Deklarasi service dan variabel utama (tidak diubah) jangan di ubah ubah sama sekali
local workspace = workspace
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local LocalPlayer = player -- alias supaya sama dengan LocalPlayer
local MenuRings = workspace["!!! MENU RINGS"]
local PlayerGui = player:WaitForChild("PlayerGui")


local GameData = {
    -- ================== [Executor Detect] ==================

    executorName = "Detecting...",

    -- ================== [View Bobbers] ==================

    Players = game:GetService("Players"),
    RunService = game:GetService("RunService"),
    Camera = workspace.CurrentCamera,
    Player = nil, -- nanti diisi
    UserIdString = nil, -- nanti diisi
    CosmeticFolder = workspace:WaitForChild("CosmeticFolder"),
    ViewBobbersEnabled = false,

   -- ================== [Codes] ==================

    Codes = {
        "1BILLION",
        "LUCKYTOTEM",
        "EXPANSION",
        "CRYSTALS"
    },

   -- ================== [Server Info Discord] ==================

    InviteCode = "ECxQFc97F5",
    DiscordAPI = "",
    ServerInfoParagraph = nil,
    AutoRefresh = false,

   -- ================== [Auto Trade] ==================

	-----------------------------------------------------
	-- TIER DATA
	-----------------------------------------------------
	TierMap001 = {
		[1] = "Common",
		[2] = "Uncommon",
		[3] = "Rare",
		[4] = "Epic",
		[5] = "Legendary",
		[6] = "Mythic",
		[7] = "SECRET"
	},

	TierList001 = {
		"Common","Uncommon","Rare","Epic","Legendary","Mythic","SECRET"
	},

	-----------------------------------------------------
	-- CORE
	-----------------------------------------------------
	RS = ReplicatedStorage,
	Players = Players,
	player = Players.LocalPlayer,

	Net = require(ReplicatedStorage.Packages.Net),
	ReplionClient = require(ReplicatedStorage.Packages.Replion).Client,
	DataReplion = nil,

	ItemUtility = require(ReplicatedStorage.Shared.ItemUtility),

	TradeRemote = ReplicatedStorage
		:WaitForChild("Packages")
		:WaitForChild("_Index")
		:WaitForChild("sleitnick_net@0.2.0")
		:WaitForChild("net")
		:WaitForChild("RF/InitiateTrade"),

	ItemsFolder = ReplicatedStorage:WaitForChild("Items"),

	-----------------------------------------------------
	-- STATE
	-----------------------------------------------------
	state = {
		selectedTiers = {},
		Auto2Trade = false,
		stopTrade = false,
		targetPlayer = "",
		fishTarget = 0,
		fishCount = 0
	},

	TierList = nil,
	nameToTier = {},

	notifGui = nil,
	notifFrame = nil,

    -- ==================[Check Enchant Stone]==================

    RS = game:GetService("ReplicatedStorage"),
    Client = nil,
    Data = nil,
    Enchant0001Paragraph = nil,

    -- ==================[Status Info Enchant]==================

    PlayerGui = PlayerGui,

    EnchantParagraph = nil,

    RollEnchantGui = nil,
    RollEnchantMain = nil,
    InsideFrame = nil,
    TopFrame = nil,
    EnchantLabel = nil,

    LastText = "None",
    CurrentText = "",
    
    -- ==================[Jenis Ikan v1]==================

        TierMap = {
        [1] = "Common",
        [2] = "Uncommon",
        [3] = "Rare",
        [4] = "Epic",
        [5] = "Legendary",
        [6] = "Mythic",
        [7] = "SECRET"
    },

    TierList = { "Common","Uncommon","Rare","Epic","Legendary","Mythic","SECRET" },

    FishCounter = {
        Common = 0,
        Uncommon = 0,
        Rare = 0,
        Epic = 0,
        Legendary = 0,
        Mythic = 0,
        SECRET = 0
    },

    -- ==================[Jenis Ikan v2]==================
        -- WEBHOOK
    WebhookURL = "",
    WebhookActive = false,
    SelectedTiers = {},
    TierList = {"All","Common","Uncommon","Rare","Epic","Legendary","Mythic","SECRET"},

    -- SERVICES
    Service = {
        Players = game:GetService("Players"),
        ReplicatedStorage = game:GetService("ReplicatedStorage"),
        HttpService = game:GetService("HttpService"),
    },

    -- EXECUTOR REQUEST
    Request = (syn and syn.request)
        or http_request
        or (fluxus and fluxus.request)
        or (krnl and request),

    -- FISHING SYSTEM DATA
    TierMap = {
        [1] = "Common",
        [2] = "Uncommon",
        [3] = "Rare",
        [4] = "Epic",
        [5] = "Legendary",
        [6] = "Mythic",
        [7] = "SECRET"
    },

    FishCounter = {
        Common = 0,
        Uncommon = 0,
        Rare = 0,
        Epic = 0,
        Legendary = 0,
        Mythic = 0,
        SECRET = 0
    },

    TierColor = {
        Common = 3092790,
        Uncommon = 5294200,
        Rare = 2061822,
        Epic = 11730944,
        Legendary = 15844367,
        Mythic = 14423100,
        SECRET = 16711853
    },

    LastFishData = nil,

    -- RUN-TIME UI STORAGE
    UI = {},

    -- ================== [Instant Fishing] ==================

    Players = game:GetService("Players"),
    ReplicatedStorage = game:GetService("ReplicatedStorage"),

    player = game:GetService("Players").LocalPlayer,
    PlayerGui = game:GetService("Players").LocalPlayer:WaitForChild("PlayerGui"),

    package = game:GetService("ReplicatedStorage").Packages._Index["sleitnick_net@0.2.0"].net,

    miniggameArgs = {-1.233184814453125, 0.9972056628181873, 1763291794.158201},

    autoFishingEnabled = false,
    isFishing = false,

    castDelay = 1.5,
    completedDelay = 1,

    lastCatchTime = os.clock(),
    antiStuckTime = 10,

    -- ================== [Rod] ==================
    RodIDs = {
        ["Starter Rod"] = 1, ["Luck Rod"] = 79, ["Carbon Rod"] = 76,
        ["Grass Rod"] = 85, ["Demascus Rod"] = 77, ["Ice Rod"] = 78,
        ["Lucky Rod"] = 4, ["Midnight Rod"] = 80, ["Steampunk Rod"] = 6,
        ["Chrome Rod"] = 7, ["Fluorescent Rod"] = 255, ["Astral Rod"] = 5,
        ["Angler Rod"] = 168, ["Ares Rod"] = 126, ["Bamboo Rod"] = 258,
        ["Toy Rod"] = 84, ["Lava Rod"] = 2, ["Hazmat Rod"] = 256,
        ["Ghostfinn Rod"] = 169, ["Element Rod"] = 257, ["Angelic Rod"] = 124,
        ["Gold Rod"] = 8, ["Hyper Rod"] = 9
    },

    -- ================== [Bait] ==================
    BaitIDs = {
        ["Starter Bait"] = 1, ["Luck Bait"] = 2, ["Midnight Bait"] = 3,
        ["Gold Bait"] = 4, ["Hyper Bait"] = 5, ["Chroma Bait"] = 6,
        ["Dark Matter Bait"] = 8, ["Beach Ball Bait"] = 9, ["Topwater Bait"] = 10,
        ["Corrupt Bait"] = 15, ["Aether Bait"] = 16, ["Nature Bait"] = 17,
        ["Singularity Bait"] = 18, ["Royal Bait"] = 19, ["Floral Bait"] = 20
    },

    -- ================== [Boat] ==================
    BoatList = {
        ["Small Boat"] = 1, ["Kayak"] = 2, ["Jetski"] = 3, ["Highfield Boat"] = 4,
        ["Speed Boat"] = 5, ["Fishing Boat"] = 6, ["Mini Yacht"] = 14,
        ["Mini Hoverboat"] = 15, ["Hyper Boat"] = 7, ["Dinky Fishing Boat"] = 20,
        ["Aura Boat"] = 17, ["Burger Boat"] = 18, ["Mega Hovercraft"] = 19,
        ["Froen Boat"] = 11, ["Cruiser Boat"] = 13, ["Rubber Ducky"] = 16
    },

    -- ================== [Traveling Merchant] ==================

    ReplicatedStorage = game:GetService("ReplicatedStorage"),

    Replion = nil,
    Merchant = nil,

    MarketItemData = nil,
    ItemUtility = nil,

    PurchaseRF = nil,

    SelectedMarketIDs = {},
    AutoPurchase = false,

    MerchantParagraph = nil,
    MerchantDropdown = nil,

    -- ================== [Quest Ghostfinn Rod & Element Rod] ==================

    Players = game:GetService("Players"),

    LocalPlayer = nil,
    QuestList = nil,

    AutoQuest = false,
    AutoThread = nil,

    SelectedQuest = nil,

    QuestCFrame = {
        ["Element Quest"] = {
            Done = CFrame.new(
                1465.59375, -21.8705444, -640.086975,
                0.654575646, -1.02007647e-07, 0.755996525,
                1.08732081e-07, 1, 4.07862615e-08,
                -0.755996525, 5.55033779e-08, 0.654575646
            ),
            NotDone = CFrame.new(
                1514.1947, 15.4692411, -325.169708,
                -0.458554745, -6.99838267e-08, 0.888666153,
                -2.75111027e-08, 1, 6.45557208e-08,
                -0.888666153, 5.15414555e-09, -0.458554745
            )
        },

        ["Deep Sea Quest"] = {
            Done = CFrame.new(
                -3699.24292, -135.073914, -1008.78424,
                -0.972918034, 4.06628686e-08, 0.231150433,
                2.29877806e-08, 1, -7.91590224e-08,
                -0.231150433, -7.17015993e-08, -0.972918034
            ),
            NotDone = CFrame.new(
                -3621.14893, -279.07373, -1591.07593,
                0.938483, 5.50977823e-08, -0.345325381,
                -1.5321401e-08, 1, 1.1791461e-07,
                0.345325381, -1.05369992e-07, 0.938483
            )
        }
    },

    -- ================== [Status Quest Ghostfinn Rod & Element Rod] ==================

    Players = game:GetService("Players"),

    LocalPlayer = nil,
    QuestList = nil,

    ElementParagraph = nil,
    DeepSeaParagraph = nil,

    -- ================== [Island] ==================
    Islands = {
    ["Kohana"] = CFrame.new(-642.243561, 16.0354481, 624.918884, 0.999580681, 0, -0.0289562326, 0, 1, 0, 0.0289562326, 0, 0.999580681),
    ["Winter Fest"] = CFrame.new(1687.93079, 6.8625145, 3309.67725, 0.96799022, -3.6394315e-08, -0.250987828, 1.06909646e-08, 1, -1.0377223e-07, 0.250987828, 9.77672059e-08, 0.96799022),
    ["Lost Isle"] = CFrame.new(-3660.07031, 26.1918774, -933.131897, -0.77232331, -7.22959044e-08, -0.635229647, -1.90984206e-08, 1, -9.05904614e-08, 0.635229647, -5.7833244e-08, -0.77232331),
    ["Isoteric Island"] = CFrame.new(2029.47913, 27.3972206, 1393.52319, 0.438848287, -3.30229497e-08, -0.89856118, 8.09404801e-08, 1, 2.55982613e-09, 0.89856118, -7.34489944e-08, 0.438848287),
    ["Crater Island"] = CFrame.new(973.268372, 7.36203814, 4879.09277, 0.99999994, -1.67766032e-08, -0.000279307278, 1.67553038e-08, 1, -7.62482344e-08, 0.000279307278, 7.62435519e-08, 0.99999994),
    ["Coral Reefs"] = CFrame.new(-3134.98511, 20.9564934, 2167.80566, 0.610140502, 5.54546098e-08, -0.792293251, -1.07331415e-08, 1, 6.17270004e-08, 0.792293251, -2.91583468e-08, 0.610140502),
    ["Kohana Volcano"] = CFrame.new(-525.122925, 24.0000591, 187.470749, 0.702778041, -1.4945584e-08, 0.711409211, 1.59372149e-09, 1, 1.18378477e-08, -0.711409211, -1.17821113e-08, 0.702778041),
    ["Fisherman Island"] = CFrame.new(33.5687256, 17.0335217, 2834.95557, 0.999833524, -8.21432367e-10, 0.0182459373, 2.40968401e-09, 1, 8.70248726e-08, -0.0182459373, 8.7054351e-08, 0.999833524),
    ["Esoteric Depths"] = CFrame.new(3152.74707, -1302.72986, 1438.05444, 0.442518562, -2.42594727e-08, -0.896759331, -8.6126515e-09, 1, 1.33023953e-08, 0.896759331, -2.15753335e-08, 0.442518562),
    ["Tropical Grove"] = CFrame.new(-2046.1554, 6.26801682, 3660.56006, -0.739083588, 1.74285066e-08, 0.673613727, -5.79817758e-08, 1, -8.94902854e-08, -0.673613727, -1.05198126e-07, -0.739083588),
    ["Treasure Room"] = CFrame.new(-3599.53491, -266.57373, -1566.98657),
    ["Weather Machine"] = CFrame.new(-1525.72632, 6.49999952, 1892.23645, 0.0615941137, 6.608282509e-10, -0.998101294, -6.8356556e-08, 1, 3.55628549e-09, 0.998101294, 6.84458072e-08, 0.0615941137),
    ["Sisyphus Statue"] = CFrame.new(-3692.22021, -135.574417, -1026.96167, -0.928567886, 9.83784361e-08, 0.371162564, 1.22746741e-07, 1, 4.20307664e-08, -0.371162564, 8.45874197e-08, -0.928567886),
    ["Ancient Jungle"] = CFrame.new(1275.54553, 7.85804176, -193.749756, 0.924119413, 5.65956171e-08, -0.382103801, -3.36512187e-08, 1, 6.67302302e-08, 0.382103801, -4.88084417e-08, 0.924119413),
    ["Underground Cellar Door"] = CFrame.new(1954.18994, -41.7413597, -577.574768, -0.817980289, 0.573604001, 0.0434255376, 0.572797239, 0.81913203, -0.0304316022, -0.0530269668, -1.84206292e-05, -0.998593211),
    ["Underground Cellar"] = CFrame.new(2120.27417, -93.1985779, -701.552185, -0.998591185, 0, 0.0530693457, 0, 1, 0, -0.0530693457, 0, -0.998591185),
    ["Temple Guardian"] = CFrame.new(1478.29846, 126.044891, -613.519653, -0.117893577, 0, 0.993026376, 0, 1, 0, -0.993026376, 0, -0.117893577),
    ["Mysterious Door"] = CFrame.new(1899.19629, 13.3589745, -577.593811, -0.0531117916, 0, -0.998588562, 0, 1, 0, 0.998588562, 0, -0.0531117916),
    ["Hourglass Diamond Artifact"] = CFrame.new(1485.66541, 5.41373634, -861.165161, -5.01871109e-05, 0.988927424, 0.148400292, -1, -5.01871109e-05, -3.74019146e-06, 3.74019146e-06, -0.148400292, 0.988927364),
    ["Arrow Artifact"] = CFrame.new(898.490479, 5.41373587, -361.212708, 9.11951065e-06, 0.0998446345, -0.994003104, -1, 9.11951065e-06, -8.2552433e-06, 8.2552433e-06, 0.994003104, 0.0998445749),
    ["Crescent Artifact"] = CFrame.new(1419.39148, 28.1637344, 79.5802917, 3.55243683e-05, -0.332731277, -0.943021655, -1, -3.55243683e-05, -2.51233578e-05, -2.51233578e-05, 0.943021655, -0.332731247),
    ["Diamond Artifact"] = CFrame.new(1818.72156, 5.41373634, -285.160828, -1.15633011e-05, -0.192806393, 0.981236815, -1, 1.15633011e-05, -9.53674316e-06, -9.53674316e-06, -0.981236815, -0.192806482),
    ["Sacred Temple"] = CFrame.new(1478.09546, 0.0774269104, -612.817993, 0.993017375, 0, 0.117968373, 0, 1, 0, -0.117968373, 0, 0.993017375),
    ["Crystalline Passage"] = CFrame.new(6053.09717, -538.900085, 4391.29102, -0.993590963, -1.39414302e-08, 0.10982503, 1.7823354e-10, 1, -7.10982503, 1.27797193e-07, -0.10982503, -0.993590963),
    ["Ancient Ruin"] = CFrame.new(6130.33203, -584.05603, 4632.95166, -0.171970293, -9.77156915e-08, 0.985102117, -7.319955083e-08, 1, 8.64156533e-08, -0.985102117, -5.722441259e-08, -0.171970293),
    ["Classic Island"] = CFrame.new(1258.37341, 9.999999905, 2811.14819, -0.996284008, -1.96166035e-08, 0.086129114, -2.56321329e-08, 1, -6.87372363e-08, -0.086129114, -7.068394809e-08, -0.996284008),
    ["Iron Cavern"] = CFrame.new(-8802.55762, -583.800049, 94.9271545, 0.539917707, 4.95349006e-08, -0.84171778, 2.88506321e-08, 1, 7.7355935e-08, 0.84171778, -6.60499282e-08, 0.539917707),
    ["Iron Cafe"] = CFrame.new(-8641.91016, -547.400183, 161.963455, -0.0101819877, -4.55452422e-08, -0.999948144, 1.64972356e-08, 1, -4.57155878e-08, 0.999948144, -1.69618559e-08, -0.0101819877),
    ["Christmas Island"] = CFrame.new(843.041687, 26.0803814, 1566.52734, 0.00453743944, -9.89134179e-08, -0.999989688, -5.82183262e-08, 1, -9.91785996e-08, 0.999989688, 5.86677444e-08, 0.00453743944),
    },

    -- ==================[Save Posisi] ==================
    rootFolder = "SavedPositions",
    folder = nil,

    SavedPositions = {},
    options = {},

    selectedSlot = nil,
    customSlotName = "",
    teleportEnabled = false,

    LocalPlayer = game.Players.LocalPlayer,
    char = nil,
    hrp = nil,

    SaveDropdown = nil,
    SaveButton = nil,
    DeleteButton = nil,
    RefreshButton = nil,

    bv = nil,
    bg = nil,

    -- ================== [Auto Unclock Ancient Ruin] ==================
    AutoUnlock = false,

    FishList = {
        "Goliath Tiger",
        "Crocodile",
        "Freshwater Piranha",
        "Sacred Guardian Squid"
    },

    -- ================== [Auto Unlock Iron Cafe] ==================
    AutoIronCafe = false,
    TaskIronCafe = nil,

    GuppyList = {
        "Builderman Guppy",
        "Shedletsky Guppy",
        "BFulleyes Guppy",
        "Guest Guppy"
    },

    connection = nil, -- connection event

    Services = {
        TweenService = game:GetService("TweenService"),
        UIS = game:GetService("UserInputService"),
        CoreGui = game:GetService("CoreGui")
    },

    -- ================== [Accses All Boat] ==================

    Services = {
        Players = game:GetService("Players")
    },

    WorkspaceData = {
        Vehicles = workspace:WaitForChild("Vehicles")
    },

    Player = nil,

    AccessAllBoats = false,
    VehicleConnection = nil,

    OriginalOwners = {},

    -- ================== [Spawn Boat] ==================

    RS = game:GetService("ReplicatedStorage"),

    SpawnBoat = nil,

    SpawnBoatOptions = {},
    SelectedSpawnBoatID = nil,


    StageList = {
        ["rbxassetid://112089909495700"] = "Hourglass Diamond Artifact", -- Stage 1
        ["rbxassetid://108196402536011"] = "Arrow Artifact",             -- Stage 2
        ["rbxassetid://140438616753774"] = "Crescent Artifact",          -- Stage 3
        ["rbxassetid://122936451238995"] = "Diamond Artifact",           -- Stage 4
    },

    Jungle = workspace:WaitForChild("JUNGLE INTERACTIONS"),

    -- ================== [Lochness Paragraph] ==================

    Workspace = workspace,

    CountdownLabel = nil,
    CountdownParagraph = nil,

    UpdateDelay = 1,

    -- ================== [Lochness Teleport] ==================

    Players = game:GetService("Players"),
    Workspace = workspace,

    LocalPlayer = nil,
    TimerLabel = nil,

    TargetCFrame = CFrame.new(
        6089.81396, -585.924194, 4637.24023,
        -0.800617278, 5.49377476e-08, 0.599176049,
        6.29061105e-08, 1, -7.63340946e-09,
        -0.599176049, 3.15803952e-08, -0.800617278
    ),

    AutoLochEnabled = false,
    SavedCFrame = nil,
    Teleporting = false,

    LoopDelay = 1,

    -- ================== [Totems Info Paragraph] ==================

    ReplicatedStorage = game:GetService("ReplicatedStorage"),

    Client = nil,
    Data = nil,

    TotemParagraph = nil,

    TotemCount = {
        Luck = 0,
        Mutation = 0,
        Shiny = 0,
    },

    -- ================== [Totems] ==================

    ReplicatedStorage = game:GetService("ReplicatedStorage"),
    Client = nil,
    Data = nil,

    SpawnTotemRE = nil,

    TotemMap = {
        ["Luck Totem"] = 1,
        ["Mutation Totem"] = 2,
        ["Shiny Totem"] = 3,
    },

    SelectedTotemId = nil,
    SpawnToggle = false,

    -- ================== [Range Totem] ==================

    Players = game:GetService("Players"),

    LocalPlayer = nil,
    Totems = workspace:WaitForChild("Totems"),

    ShowTotemRange = false,

    RangeColor = Color3.fromRGB(255, 0, 0),
    RangeAlpha = 0.5,

    -- ================== [Blatant ] ==================

    SVC = {
        RS = game:GetService("ReplicatedStorage")
    },

    net = nil, -- nanti diisi setelah RS
    RF = {},
    RE = {},

    cutsceneController = nil,
    originalPlay = nil,
    originalStop = nil,

    EnableSkip = nil,
    Fastest = nil,
    startBlatantV2 = nil,

    -- ================== [Treasure] ==================


    -- ================== [Event Hunt] ==================


    -- ================== [SKip Rraity] ==================

    Players = game:GetService("Players"),
    RS = game:GetService("ReplicatedStorage"),

    player = nil,

    net = nil,
    RF_CancelFishing = nil,
    RE_TextEffect = nil,

    RARITY_COLORS = {
        Common   = {1, 0.980392, 0.964706},
        Uncommon = {0.764706, 1, 0.333333},
        Rare     = {0.333333, 0.635294, 1},
        Epic     = {0.678431, 0.309804, 1},
    },

    lastProcessed = {},
    COOLDOWN = 1,

    -- ================== [Fish Caught] ==================

    ReplicatedStorage = game:GetService("ReplicatedStorage"),
    REFishCaught = nil,
    FishCount = 0,
    FishCountParagraph = nil,

    -- ================== [Image Botton] ==================

    TweenService = game:GetService("TweenService"),
    UIS = game:GetService("UserInputService"),
    CoreGui = game:GetService("CoreGui"),

    ScreenGui = nil,
    ToggleFrame = nil,
    ToggleBtn = nil,

    Corner = nil,
    Gradient = nil,
    Glow = nil,
    Stroke = nil,

    uiVisible = true,

    Dragging = false,
    DragStart = nil,
    StartPos = nil,

    beginDrag = nil,
    updateDrag = nil,
    endDrag = nil,

    -- ================== [Walkspeed, Jump Power, Gravity] ==================

    Player = nil,
    char = nil,
    hum = nil,

    WalkspeedEnabled = false,
    WalkspeedValue = 16,

    JumpEnabled = false,
    JumpValue = 50,

    GravityEnabled = false,
    GravityValue = 196.2,

    -- ================== [Infinite Zoom] ==================

    player = game:GetService("Players").LocalPlayer,
    infiniteZoomEnabled = false,

    -- ================== [Walk On Water] ==================

    Players = game:GetService("Players"),
    RunService = game:GetService("RunService"),

    -- Player data
    player = game:GetService("Players").LocalPlayer,
    character = nil,
    hrp = nil,

    -- Water settings
    waterHeight = -1.8,

    -- Runtime objects
    waterPlatform = nil,
    connection = nil,

    -- ================== [Remove VFX] ==================

    RS = game:GetService("ReplicatedStorage"),
    RunService = game:GetService("RunService"),

    -- VFX Folder
    waterVFXFolder = nil,

    -- Stored VFX Clones
    storedVFX = {},

    -- Connections
    childAddedConn = nil,

    -- ================== [Global Settings] ==================
    userInfoState = nil,
    notifState = nil,
    blurState = nil,
    GS_UserInfo = nil,
    GS_Notifications = nil,
    GS_Blur = nil,

    -- ================== [Window Settings] ==================

    windowWidth = nil,
    windowHeight = nil,
    windowScale = nil,
    currentSize = nil,
    inputValue = nil,

    -- ================== [Toggle Status] ==================
    toggleStatus = {},
    statusLabel = nil,
    activeList = {},

    -- ================== [Anti AFK Time] ==================

    UserInputService = game:GetService("UserInputService"),

    intervalMinutes = 15,
    showSeconds = 10,

    lastInput = tick(),

    AntiAFKParagraph = nil,

    runtime = {
        totalSeconds = 0,
        minutes = 0,
        seconds = 0,
    },

    connections = {
        began = nil,
        changed = nil,
        ended = nil,
    },

    -- ================== [Teleport Service & Server Job Id] ==================

    TeleportService = game:GetService("TeleportService"),
    Players = game:GetService("Players"),
    HttpService = game:GetService("HttpService"),

    LocalPlayer = nil,
    PlaceId = game.PlaceId,
    targetJobId = "",
    JobIdLabel = nil,

    -- ================== [Hide Quest] ==================
    
    Players = game:GetService("Players"),
    Player = nil,

    PlayerGui = nil,
    QuestGui = nil,
    QuestList = nil,

    -- ================== [Boost FPS] ==================

    Lighting = game:GetService("Lighting"),
    Workspace = game:GetService("Workspace"),
    Terrain = nil,

    MinecraftFPS = false,
    FPSLoop = nil,

    -- ================== [Center Header] ==================

    CenterHeaderEnabled = true,

    CoreGui = game:GetService("CoreGui"),

    GuiItem = nil,
    FullItem = nil,
    DescItem = nil,

    -- ================== [Anti Afk Toggle] ==================

    VIM = game:GetService("VirtualInputManager"),

    AntiAfkRunning = false,
    AntiAfkThread = nil,

    -- ================== [Inf Candy] ==================

    Services = {
        HttpService = game:GetService("HttpService"),
        TeleportService = game:GetService("TeleportService"),
        Players = game:GetService("Players"),
    },

    Player = nil,
    PlaceId = game.PlaceId,
    JobId = game.JobId,

    RejoinDelay = 5,
    SaveFile = "InfCandyConfig.json",

    InfCandy = false,
    InfCandyThread = nil,

    -- ================== [FishCaught Animation] ==================

    Services = {
        ReplicatedStorage = game:GetService("ReplicatedStorage"),
        Players = game:GetService("Players"),
    },

    Player = nil,

    REFishCaught = nil,

    AnimationController = nil,
    OldPlayAnimation = nil,

    AnimationsFolder = nil,
    AnimationList = {},
    AnimationMap = {},
    SelectedAnimationId = nil,

    AnimationEnabled = false,
    AnimDisabled = false,
    CurrentTrack = nil,

    Character = nil,
    Humanoid = nil,
    Animator = nil,
    AnimationInstance = nil,

    -- ================== [Auto Reconnect] ==================

    Services = {
        Players = game:GetService("Players"),
        TeleportService = game:GetService("TeleportService"),
        GuiService = game:GetService("GuiService"),
    },

    Player = nil,
    PlaceId = game.PlaceId,

    AutoReconnect = false,

    Connections = {},
}


local Window = MacLib:Window({
    Title = "NexaHub",
    Subtitle = "Fish It - Premium | V0.0.5",
    Size = UDim2.fromOffset(550, 380),
    DragStyle = 2,
    DisabledWindowControls = {},
    ShowUserInfo = false,
    Keybind = Enum.KeyCode.G,
    AcrylicBlur = true,
})

Window:SetSize(UDim2.fromOffset(550, 380))

Window:SetUserInfoState(false)
GameData.userInfoState = Window:GetUserInfoState()

GameData.GS_UserInfo = Window:GlobalSetting({
    Name = "Hide User Info",
    Default = false,
    Callback = function(state)
        GameData.userInfoState = state
        Window:SetUserInfoState(not GameData.userInfoState)
    end,
})


----------------------------------------------------
-- NOTIFICATIONS STATE
----------------------------------------------------
Window:SetNotificationsState(true)
GameData.notifState = Window:GetNotificationsState()

GameData.GS_Notifications = Window:GlobalSetting({
    Name = "Disable Notifications",
    Default = false,
    Callback = function(state)
        GameData.notifState = state
        Window:SetNotificationsState(not GameData.notifState)
    end,
})


----------------------------------------------------
-- ACRYLIC BLUR STATE
----------------------------------------------------
Window:SetAcrylicBlurState(true)
GameData.blurState = Window:GetAcrylicBlurState()

GameData.GS_Blur = Window:GlobalSetting({
    Name = "Disable Acrylic Blur",
    Default = false,
    Callback = function(state)
        GameData.blurState = state
        Window:SetAcrylicBlurState(not GameData.blurState)
    end,
})

function GameData:ApplyCenter()
    for _, guiItem in ipairs(self.CoreGui:GetChildren()) do
        if guiItem:IsA("Folder") or guiItem:IsA("ScreenGui") then
            local fullItem = guiItem:FindFirstChild("Full", true)
            if fullItem then
                for _, descItem in ipairs(fullItem:GetDescendants()) do
                    if descItem:IsA("TextLabel")
                    and descItem.Name == "HeaderText" then
                        descItem.TextXAlignment = Enum.TextXAlignment.Center
                    end
                end
            end
        end
    end
end

GameData:ApplyCenter()

Window:GlobalSetting({
    Name = "Center Header",
    Default = true,
    Callback = function(State)
        GameData.CenterHeaderEnabled = State
        if State then
            GameData:ApplyCenter()
        end
    end,
})

task.spawn(function()
    while task.wait(1) do
        if GameData.CenterHeaderEnabled then
            GameData:ApplyCenter()
        end
    end
end)

local GameName = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name

Window:Dialog({
    Title = "Support Game " .. GameName .. " | Welcome",
    Description = "Thank you for using NexaHub! Join our Discord for support and updates.",
    Buttons = {
        {
            Name = "Ok",
            Callback = function()
            end,
        }
    }
})

local tabGroups = {
	TabGroup1 = Window:TabGroup()
}

local tabs = {
    Home = tabGroups.TabGroup1:Tab({ Name = "Home", Image = "rbxassetid://103124389616816" }),
	Fishing = tabGroups.TabGroup1:Tab({ Name = "Fishing", Image = "rbxassetid://97899956724998" }),
    Backpack = tabGroups.TabGroup1:Tab({ Name = "Backpack", Image = "rbxassetid://107912851707883" }),
    Exploit = tabGroups.TabGroup1:Tab({ Name = "Exploit", Image = "rbxassetid://97624371540285" }),
    Event = tabGroups.TabGroup1:Tab({ Name = "Event", Image = "rbxassetid://139605405636145" }),
	Quest = tabGroups.TabGroup1:Tab({ Name = "Quest", Image = "rbxassetid://70719631016787" }),
    Auto = tabGroups.TabGroup1:Tab({ Name = "Automatic", Image = "rbxassetid://100691400534443" }),
	Shop = tabGroups.TabGroup1:Tab({ Name = "Shop", Image = "rbxassetid://134257769519180" }),
	Boat = tabGroups.TabGroup1:Tab({ Name = "Boat", Image = "rbxassetid://79620448065359" }),
    Tp = tabGroups.TabGroup1:Tab({ Name = "Teleport", Image = "rbxassetid://124499210049583" }),
	Player = tabGroups.TabGroup1:Tab({ Name = "Player", Image = "rbxassetid://105274848905298" }),
	Config = tabGroups.TabGroup1:Tab({ Name = "Config", Image = "rbxassetid://111411260968321" }),
}
local sections = {
    Home = tabs.Home:Section({ Side = "Full" }),
    Home1 = tabs.Home:Section({ Side = "Full" }),
    Home2 = tabs.Home:Section({ Side = "Full" }),
    Home3 = tabs.Home:Section({ Side = "Full" }),

    Fishing1 = tabs.Fishing:Section({ Side = "Full" }),
	Fishing2 = tabs.Fishing:Section({ Side = "Full" }),
    Fishing3 = tabs.Fishing:Section({ Side = "Full" }),
    Fishing5 = tabs.Fishing:Section({ Side = "Full" }),
    Fishing6 = tabs.Fishing:Section({ Side = "Full" }),

    Exploit = tabs.Exploit:Section({ Side = "Full" }),

    Backpack = tabs.Backpack:Section({ Side = "Full" }),
    Backpack1 = tabs.Backpack:Section({ Side = "Full" }),
    Backpack2 = tabs.Backpack:Section({ Side = "Full" }),

    Event = tabs.Event:Section({ Side = "Full" }),

    Quest = tabs.Quest:Section({ Side = "Full" }),
    Quest1 = tabs.Quest:Section({ Side = "Full" }),
    Quest2 = tabs.Quest:Section({ Side = "Full" }),

    Auto = tabs.Auto:Section({ Side = "Full" }),
    Auto1 = tabs.Auto:Section({ Side = "Full" }),
    Auto2 = tabs.Auto:Section({ Side = "Full" }),

    Shop = tabs.Shop:Section({ Side = "Full" }),
    Shop1 = tabs.Shop:Section({ Side = "Full" }),
    Shop2 = tabs.Shop:Section({ Side = "Full" }),
    Shop3 = tabs.Shop:Section({ Side = "Full" }),
    Shop4 = tabs.Shop:Section({ Side = "Full" }),
    Shop5 = tabs.Shop:Section({ Side = "Full" }),

    Boat = tabs.Boat:Section({ Side = "Full" }),
    Boat1 = tabs.Boat:Section({ Side = "Full" }),

    Tp = tabs.Tp:Section({ Side = "Full" }),
    Tp1 = tabs.Tp:Section({ Side = "Full" }),
    Tp2 = tabs.Tp:Section({ Side = "Full" }),

    Player = tabs.Player:Section({ Side = "Full" }),
    Player1 = tabs.Player:Section({ Side = "Full" }),
    Player2 = tabs.Player:Section({ Side = "Full" }),

    Config = tabs.Config:Section({ Side = "Full" }),
    Config1 = tabs.Config:Section({ Side = "Full" }),
}



sections.Home:Header({
	Name = "What's New?"
})

sections.Home:Paragraph({
    Header = "Update List",
    Body = [[
[+] Added Inf Candy
]]
}, "Info")

sections.Home1:Header({
	Name = "Exploit Exe"
})

GameData.detect_executor = function()
    if type(identifyexecutor) == "function" then
        local ok, res = pcall(identifyexecutor)
        if ok and res then 
            return tostring(res) 
        end
    end
    if syn and syn.request then return "Synapse X" end
    if KRNL_LOADED or type(kronos) == "table" then return "Krnl" end
    if fluxus and fluxus.request then return "Fluxus" end
    if secure_load then return "Sentinel / Secure" end
    if is_sirhurt_closure then return "SirHurt" end
    if PROTOSMASHER_LOADED then return "ProtoSmasher" end
    if OXYGEN then return "Oxygen" end
    if exploit and exploit.request then return "UnknownExploit (exploit.request)" end

    return "Unknown / Undetected"
end

GameData.executorName = GameData.detect_executor()

GameData.executorParagraph = sections.Home1:Paragraph({
    Header = "Executor Detector Exploits",
    Body = "Current Executor: " .. tostring(GameData.executorName)
}, "ExecutorParagraph")

task.delay(1, function()
    GameData.newName = GameData.detect_executor()
    GameData.executorParagraph:UpdateBody("Current Executor: " .. tostring(GameData.newName))
end)


sections.Home2:Header({
	Name = "Reward"
})

local ReplicatedStorage = game:GetService("ReplicatedStorage")

local NetFolder = ReplicatedStorage:WaitForChild("Packages")
	:WaitForChild("_Index")
	:WaitForChild("sleitnick_net@0.2.0")
	:WaitForChild("net")

local RedeemRF = NetFolder:WaitForChild("RF/RedeemCode")

sections.Home2:Button({
	Name = "Redeem All Codes",
	Callback = function()

		Window:Notify({
			Title = "Redeem",
			Description = "Redeeming all codes...",
			Lifetime = 3
		})

		for _, code in ipairs(GameData.Codes) do
			task.wait(1)

			local success, result = pcall(function()
				return RedeemRF:InvokeServer(code)
			end)

			if success then
				Window:Notify({
					Title = "Success",
					Description = "Redeemed: " .. code,
					Lifetime = 3
				})
			else
				Window:Notify({
					Title = "Failed",
					Description = "Failed redeem: " .. code,
					Lifetime = 3
				})
			end
		end

		Window:Notify({
			Title = "Done",
			Description = "All redeem codes processed.",
			Lifetime = 4
		})
	end,
})


sections.Home2:Button({ 
    Name = "Auto Claim Event Reward", 
    Callback = function()
        local ReplicatedStorage = game:GetService("ReplicatedStorage")

        local remote = ReplicatedStorage
            :WaitForChild("Packages")
            :WaitForChild("_Index")
            :WaitForChild("sleitnick_net@0.2.0")
            :WaitForChild("net")
            :WaitForChild("RE/ClaimEventReward")

        for i = 1, 15 do
            remote:FireServer(i)
            task.wait(0.01) -- aman, optional
        end
    end,
})

sections.Home3:Header({
	Name = "Discord Server Info"
})

GameData.DiscordAPI = "https://discord.com/api/v10/invites/" ..
    GameData.InviteCode ..
    "?with_counts=true&with_expiration=true"

GameData.HttpService = game:GetService("HttpService")


-- BUAT PARAGRAPH UI
GameData.ServerInfoParagraph = sections.Home3:Paragraph({
    Header = "Discord Server Info",
    Body = "Click refresh to load."
}, "Info")


-- FUNGSI FETCH DISCORD API
GameData.FetchDiscordInfo = function()
    GameData.success, GameData.Response = pcall(function()
        return GameData.HttpService:JSONDecode(
            (syn and syn.request or http_request or request or fluxus and fluxus.request)({
                Url = GameData.DiscordAPI,
                Method = "GET",
                Headers = {
                    ["User-Agent"] = "RobloxBot/1.0",
                    ["Accept"] = "application/json"
                }
            }).Body
        )
    end)

    if GameData.success
        and GameData.Response
        and GameData.Response.guild
    then
        GameData.ServerInfoParagraph:UpdateHeader(
            "Discord Server: " .. GameData.Response.guild.name
        )

        GameData.ServerInfoParagraph:UpdateBody(
            "Members: " .. tostring(GameData.Response.approximate_member_count) .. "\n" ..
            "Online: " .. tostring(GameData.Response.approximate_presence_count)
        )

    else
        GameData.ServerInfoParagraph:UpdateHeader("Discord Server Info (Error)")
        GameData.ServerInfoParagraph:UpdateBody("Failed to fetch info.\nTry again.")
    end
end


-- BUTTON REFRESH MANUAL
sections.Home3:Button({
    Name = "Refresh Server Info",
    Callback = function()
        GameData.ServerInfoParagraph:UpdateBody("Loading...")
        GameData.FetchDiscordInfo()
    end,
})


-- TOGGLE AUTO REFRESH (3 DETIK)
sections.Home3:Toggle({
    Name = "Auto Refresh Server Info",
    Default = false,
    Callback = function(value)
        GameData.AutoRefresh = value

        Window:Notify({
            Title = "",
            Description = value and "Auto Refresh Enabled" or "Auto Refresh Disabled"
        })

        -- LOOP AUTO REFRESH
        task.spawn(function()
            while GameData.AutoRefresh do
                GameData.ServerInfoParagraph:UpdateBody("Loading...")
                GameData.FetchDiscordInfo()
                task.wait(5)
            end
        end)
    end,
}, "AutoRefreshServerInfoToggle")

sections.Home3:Button({
    Name = "Copy Discord Link",
    Callback = function()
        local discordLink = "https://discord.gg/ECxQFc97F5"

        if setclipboard then
            setclipboard(discordLink)
        elseif toclipboard then
            toclipboard(discordLink)
        end
    end,
})

sections.Fishing1:Header({
	Name = "Status Info Fishing"
})

-- Label awal
GameData.statusLabel = sections.Fishing1:Label({
    Text = 'Status Offline: <font color="rgb(255,0,0)">.....</font>'
})

---------------------------------------------------------
-- Fungsi Update Label (DIPERBAIKI)
---------------------------------------------------------
GameData.UpdateStatusLabel = function()

    -- Reset list
    GameData.activeList = {}

    -- Ambil toggle ON saja
    for name, state in pairs(GameData.toggleStatus) do
        if state == true then
            table.insert(
                GameData.activeList,
                '<font color="rgb(0,255,0)">' .. name .. ' ON</font>'
            )
        end
    end

    -- Jika tidak ada toggle yang aktif
    if #GameData.activeList == 0 then
        GameData.statusLabel:UpdateName('Status Offline: <font color="rgb(255,0,0)">.....</font>')
    else
        GameData.statusLabel:UpdateName(
            'Status Online: ' .. table.concat(GameData.activeList, "|| ")
        )
    end

    GameData.statusLabel:SetVisibility(true)
end

sections.Fishing1:Divider()

GameData.REFishCaught =
    GameData.ReplicatedStorage
        .Packages
        ._Index["sleitnick_net@0.2.0"]
        .net["RE/FishCaught"]

GameData.FishCountParagraph = sections.Fishing1:Paragraph({
    Header = "Fish Caught",
    Body = "Total: 0"
}, "FishCaughtCount")

GameData.REFishCaught.OnClientEvent:Connect(function(fishName, data)
    GameData.FishCount = GameData.FishCount + 1

    local lines = {
        "Total: " .. GameData.FishCount
    }

    if fishName ~= nil then
        table.insert(lines, "Last Fish: " .. tostring(fishName))
    end

    if type(data) == "table" then
        for key, value in pairs(data) do
            table.insert(lines, tostring(key) .. ": " .. tostring(value))
        end
    end

    GameData.FishCountParagraph:UpdateBody(
        table.concat(lines, "\n")
    )
end)

sections.Fishing1:Header({
	Name = "Fishing Feature"
})

-- Controllers & Packages
local FishingController = require(ReplicatedStorage.Controllers.FishingController)
local AutoFishingController = require(ReplicatedStorage.Controllers.AutoFishingController)
local Replion = require(ReplicatedStorage.Packages.Replion)

-- Remote Toggle
local UpdateAutoFishingState = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/UpdateAutoFishingState")

-- Remote Instant
local REReplicateTextEffect = ReplicatedStorage
	.Packages._Index["sleitnick_net@0.2.0"].net["RE/ReplicateTextEffect"]

local REFishingCompleted = ReplicatedStorage
	.Packages._Index["sleitnick_net@0.2.0"].net["RE/FishingCompleted"]

-- ==========================================================
-- GLOBAL STATE
-- ==========================================================
local SelectedMode = "Click"    
local AutoClickEnabled = false
local InstantEnabled = false

local ClickSpeed = 0.05
local remoteDelay = 1
local clickThread = nil

-- ==========================================================
-- DROPDOWN MODE
-- ==========================================================
sections.Fishing1:Dropdown({
	Name = "Select Auto Fish Mode",
	Search = false,
	Multi = false,
	Required = false,
	Options = {"Click", "Instant"},
	Default = {"Click"},
	Callback = function(Value)
		SelectedMode = Value
		Window:Notify({
			Title = "Mode Updated",
			Description = "Mode set to: " .. SelectedMode
		})
	end,
}, "AutoFishModeDropdown")

-- ==========================================================
-- CLICK SPEED INPUT
-- ==========================================================
sections.Fishing1:Input({
	Name = "Click Speed",
	Placeholder = "Default: 0.05",
	AcceptedCharacters = "Numbers",
	Callback = function(value)
		local num = tonumber(value)
		if num and num > 0 then
			ClickSpeed = num
			Window:Notify({
				Title = "Speed Updated",
				Description = "Click Speed = " .. num
			})
		end
	end,
}, "AutoClickSpeedInput")

-- ==========================================================
-- CLICK FUNCTION
-- ==========================================================
local function performClick()
	FishingController:RequestFishingMinigameClick()
	task.wait(ClickSpeed + math.random() * ClickSpeed)
end

-- ==========================================================
-- HOOK MINIGAME (MODE CLICK)
-- ==========================================================
local originalRodStarted = FishingController.FishingRodStarted
local originalFishingStopped = FishingController.FishingStopped

FishingController.FishingRodStarted = function(self, ...)
	originalRodStarted(self, ...)
	if SelectedMode ~= "Click" then return end
	if not AutoClickEnabled then return end

	if clickThread then task.cancel(clickThread) end
	clickThread = task.spawn(function()
		while AutoClickEnabled do
			performClick()
		end
	end)
end

FishingController.FishingStopped = function(self, ...)
	originalFishingStopped(self, ...)
	if clickThread then
		task.cancel(clickThread)
		clickThread = nil
	end
end

-- ==========================================================
-- DELAY REEL INPUT (MODE INSTANT)
-- ==========================================================
sections.Fishing1:Input({
	Name = "Delay Reel",
	Placeholder = "Default: 1",
	AcceptedCharacters = "Numbers",
	Callback = function(input)
		local num = tonumber(input)
		if num then
			remoteDelay = num
			Window:Notify({
				Title = "Delay Updated",
				Description = "Delay Reel = " .. num
			})
		end
	end,
}, "DelayReelInput")

-- ==========================================================
-- LISTEN FOR REEL (AUTO COMPLETE)
-- ==========================================================
REReplicateTextEffect.OnClientEvent:Connect(function(data)
	if SelectedMode ~= "Instant" then return end
	if not InstantEnabled then return end
	if not data or not data.TextData then return end

	local attach = data.TextData.AttachTo
	if not attach or not attach.Parent then return end

	local player = Players:GetPlayerFromCharacter(attach.Parent)
	if player ~= LocalPlayer then return end

	task.delay(remoteDelay, function()
		if InstantEnabled then
			REFishingCompleted:FireServer()
		end
	end)
end)

-- ==========================================================
-- REMOTE AUTO FISH STATE
-- ==========================================================
local function updateRemoteState(bool)
	task.spawn(function()
		pcall(function()
			UpdateAutoFishingState:InvokeServer(bool)
		end)
	end)
end

-- ==========================================================
-- TOGGLE UTAMA
-- ==========================================================
sections.Fishing1:Toggle({
	Name = "Auto Fishing",
	Default = false,
	Callback = function(state)

		-- Update status label (wajib)
		GameData.toggleStatus["Normal Fishing"] = state
		GameData.UpdateStatusLabel()

		-- Kirim remote setiap toggle
        updateRemoteState(state)

		-- Mode selector
		if SelectedMode == "Click" then
			AutoClickEnabled = state
			InstantEnabled = false
		elseif SelectedMode == "Instant" then
			InstantEnabled = state
			AutoClickEnabled = false
		end

		Window:Notify({
			Title = "Auto Fishing",
			Description = "Mode: " .. SelectedMode .. " â†’ " .. (state and "ON" or "OFF")
		})
	end,
}, "UniversalAutoFishToggle")


-- ========= [No Animation] =========
local stopAnimConnections = {}

local function setGameAnimationsEnabled(state)
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if not humanoid then
        return
    end

    -- Bersihkan koneksi animasi lama
    for _, conn in ipairs(stopAnimConnections) do
        conn:Disconnect()
    end
    stopAnimConnections = {}

    if state then
        -- Hentikan semua animasi yg sedang berjalan
        local animator = humanoid:FindFirstChildOfClass("Animator")
        if animator then
            for _, track in ipairs(animator:GetPlayingAnimationTracks()) do
                track:Stop(0)
            end

            -- Cegah animasi baru dimainkan
            local conn = animator.AnimationPlayed:Connect(function(track)
                task.defer(function()
                    track:Stop(0)
                end)
            end)
            table.insert(stopAnimConnections, conn)
        end
    else
        -- Re-enable: cukup matikan koneksi
        for _, conn in ipairs(stopAnimConnections) do
            conn:Disconnect()
        end
        stopAnimConnections = {}
    end

    -- Notify WindUI
    Window:Notify({
        Title = "No Animation",
        Description = (state and "Enabled " or "Disabled ") .. "No Animation"
    })
end



sections.Fishing1:Toggle({
    Name = "No Animation",
    Default = false,
    Callback = function(state)

        -- Update status toggle
        GameData.toggleStatus["No Animation"] = state
        GameData.UpdateStatusLabel()

        -- Logic asli kamu
        setGameAnimationsEnabled(state)
    end,
})

-- ========= [Skip Rarity] =========

_G.RarityFilterEnabled = false
_G.BlacklistedRarity = { "Common" }

GameData.player = GameData.Players.LocalPlayer

GameData.net = GameData.RS.Packages._Index["sleitnick_net@0.2.0"].net
GameData.RF_CancelFishing = GameData.net:WaitForChild("RF/CancelFishingInputs")
GameData.RE_TextEffect = GameData.net:WaitForChild("RE/ReplicateTextEffect")

sections.Fishing1:Toggle({
    Name = "Skip Rarity",
    Default = false,
    Callback = function(value)
        _G.RarityFilterEnabled = value
        Window:Notify({
            Title = "Skip Rarity",
            Description = (value and "Enabled" or "Disabled")
        })
    end,
}, "SkipRarityToggle")

sections.Fishing1:Dropdown({
    Name = "Skip Rarity List",
    Search = true,
    Multi = true,
    Required = false,
    Options = {
        "Common",
        "Uncommon",
        "Rare",
        "Epic"
    },
    Default = {
        "Common"
    },
    Callback = function(Value)
        local Selected = {}
        for rarity, state in next, Value do
            if state then
                table.insert(Selected, rarity)
            end
        end
        _G.BlacklistedRarity = Selected
    end,
}, "SkipRarityDropdown")

function GameData.approx(a, b, tol)
    return math.abs(a - b) <= (tol or 0.02)
end

function GameData.isColor(r,g,b,R,G,B)
    return GameData.approx(r,R) and GameData.approx(g,G) and GameData.approx(b,B)
end

function GameData.detectRarity(color3)
    if not color3 then return "UNKNOWN" end
    for rarity, c in pairs(GameData.RARITY_COLORS) do
        if GameData.isColor(color3.R, color3.G, color3.B, c[1], c[2], c[3]) then
            return rarity
        end
    end
    return "UNKNOWN"
end

GameData.RE_TextEffect.OnClientEvent:Connect(function(data)
    if not _G.RarityFilterEnabled then return end
    if not data or not data.TextData then return end
    if data.TextData.EffectType ~= "Exclaim" then return end

    local head = GameData.player.Character and GameData.player.Character:FindFirstChild("Head")
    if data.Container ~= head then return end

    local id = tostring(data)
    if GameData.lastProcessed[id] and tick() - GameData.lastProcessed[id] < GameData.COOLDOWN then
        return
    end
    GameData.lastProcessed[id] = tick()

    local color = data.TextData.TextColor
    if typeof(color) == "ColorSequence" then
        color = color.Keypoints[1].Value
    end
    if typeof(color) ~= "Color3" then return end

    local rarity = GameData.detectRarity(color):upper()

    for _, blocked in ipairs(_G.BlacklistedRarity) do
        if blocked:upper() == rarity then
            GameData.RF_CancelFishing:InvokeServer()
            return
        end
    end
end)


-- ========= [Cancel Fishing] =========
-- Ambil RemoteFunction CancelFishing
local CancelFishing = ReplicatedStorage
    :WaitForChild("Packages")
    :WaitForChild("_Index")
    :WaitForChild("sleitnick_net@0.2.0")
    :WaitForChild("net")
    :WaitForChild("RF/CancelFishingInputs")

-- Button Baru Format sections.Fishing
sections.Fishing1:Button({
	Name = "Cancel Fishing",
	Callback = function()
		CancelFishing:InvokeServer()
	end,
})

sections.Fishing2:Header({
	Name = "Instant Fishing Feature"
})

-- Remote references
GameData.ChargeFishingRod = GameData.package["RF/ChargeFishingRod"]
GameData.RequestFishingMinigameStarted = GameData.package["RF/RequestFishingMinigameStarted"]
GameData.REReplicateTextEffect = GameData.package["RE/ReplicateTextEffect"]
GameData.REFishingCompleted = GameData.package["RE/FishingCompleted"]
GameData.REFishCaught = GameData.package["RE/FishCaught"]
GameData.CancelFishingInputs = GameData.package["RF/CancelFishingInputs"]

-- ==========================================================
-- SAFE WAIT
-- ==========================================================
local function SafeWait(t)
    local start = os.clock()
    while os.clock() - start < t do
        if not GameData.autoFishingEnabled then return false end
        task.wait()
    end
    return true
end

-- ==========================================================
-- MAIN FISHING CYCLE
-- ==========================================================
local function StartFishingCycle()
    if not GameData.autoFishingEnabled or GameData.isFishing then return end

    GameData.isFishing = true
    GameData.lastCatchTime = os.clock()

    GameData.ChargeFishingRod:InvokeServer()
    if not SafeWait(0.1) then return end

    GameData.RequestFishingMinigameStarted:InvokeServer(unpack(GameData.miniggameArgs))
end

-- ==========================================================
-- ANTI-STUCK CHECKER (AUTO RESTART)
-- ==========================================================
task.spawn(function()
    while true do
        task.wait(0.1)

        if GameData.autoFishingEnabled and GameData.isFishing then
            if os.clock() - GameData.lastCatchTime >= GameData.antiStuckTime then

                print("[Anti-Stuck] Tidak ada FishCaught selama "..GameData.antiStuckTime.." detik. Reset fishing...")

                pcall(function()
                    GameData.CancelFishingInputs:InvokeServer()
                end)

                GameData.isFishing = false
                task.wait(0.1)

                StartFishingCycle()
            end
        end
    end
end)

-- ==========================================================
-- REPLICATE TEXT EFFECT
-- ==========================================================
GameData.REReplicateTextEffect.OnClientEvent:Connect(function(data)
    if not GameData.autoFishingEnabled or not data or not data.TextData then return end

    local attach = data.TextData.AttachTo
    if not attach or not attach.Parent then return end

    local playerFromChar = GameData.Players:GetPlayerFromCharacter(attach.Parent)
    if playerFromChar ~= GameData.player then return end

    task.spawn(function()
        if not SafeWait(GameData.completedDelay) then return end
        GameData.REFishingCompleted:FireServer()
    end)
end)

-- ==========================================================
-- FISH CAUGHT = RESTART
-- ==========================================================
GameData.REFishCaught.OnClientEvent:Connect(function(fishName, data)
    if not GameData.autoFishingEnabled then return end

    GameData.lastCatchTime = os.clock()

    task.spawn(function()
        pcall(function()
            GameData.CancelFishingInputs:InvokeServer()
        end)

        GameData.isFishing = false
        if not SafeWait(GameData.castDelay) then return end

        StartFishingCycle()
    end)
end)

-- ==========================================================
-- WINDUI SETTINGS
-- ==========================================================
sections.Fishing2:Toggle({
    Name = "Instant Fishing",
    Default = false,
    Callback = function(state)

        -- Tambahan status toggle
        GameData.toggleStatus["Instant Fishing"] = state
        GameData.UpdateStatusLabel()

        -- Logic asli kamu
        GameData.autoFishingEnabled = state

        if state then
            StartFishingCycle()
        else
            GameData.isFishing = false
        end

        Window:Notify({
            Title = "Instant Fishing",
            Description = state and "Enabled Instant Fishing" or "Disabled Instant Fishing"
        })
    end,
}, "InstantFishingToggle")


sections.Fishing2:Input({
    Name = "Cast Delay",
    Placeholder = "Default: 1.5",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        GameData.castDelay = tonumber(input) or 1.5

        Window:Notify({
            Title = "Cast Delay",
            Description = "Cast Delay set to: " .. tostring(GameData.castDelay)
        })
    end,
}, "InstantFishingCastDelay")

sections.Fishing2:Input({
    Name = "Completed Delay",
    Placeholder = "Default: 1",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        GameData.completedDelay = tonumber(input) or 1

        Window:Notify({
            Title = "Completed Delay",
            Description = "Completed Delay set to: " .. tostring(GameData.completedDelay)
        })
    end,
}, "InstantFishingCompletedDelay")

-- ADD NEW INPUT FOR ANTI-STUCK TIME
sections.Fishing2:Input({
    Name = "Anti-Stuck Time (Seconds)",
    Placeholder = "Default: 10",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        local value = tonumber(input)

        if value then
            GameData.antiStuckTime = value

            Window:Notify({
                Title = "Anti-Stuck Updated",
                Description = "Anti-Stuck time set to: " .. tostring(value) .. " seconds"
            })
        else
            Window:Notify({
                Title = "Invalid Input",
                Description = "Please enter numbers only."
            })
        end
    end,
}, "AntiStuckTimeInput")

sections.Fishing3:Header({
	Name = "Animation Fishing"
})

GameData.Player = GameData.Services.Players.LocalPlayer

GameData.REFishCaught =
    GameData.Services.ReplicatedStorage
        .Packages._Index["sleitnick_net@0.2.0"]
        .net["RE/FishCaught"]

GameData.AnimationsFolder = GameData.Services.ReplicatedStorage
    :WaitForChild("Modules")
    :WaitForChild("Animations")

GameData.AnimationController =
    require(GameData.Services.ReplicatedStorage.Controllers.AnimationController)

GameData.OldPlayAnimation = GameData.AnimationController.PlayAnimation

GameData.AnimationController.PlayAnimation = function(self, animName, ...)
    if GameData.AnimDisabled then
        return
    end
    return GameData.OldPlayAnimation(self, animName, ...)
end

for _, anim in ipairs(GameData.AnimationsFolder:GetChildren()) do
    if anim:IsA("Animation") and anim.Name:find("FishCaught") then
        table.insert(GameData.AnimationList, anim.Name)
        GameData.AnimationMap[anim.Name] = anim.AnimationId
    end
end

function GameData:PlayFishCaught()
    if not self.AnimationEnabled then return end
    if not self.SelectedAnimationId then return end

    self.Character = self.Player.Character or self.Player.CharacterAdded:Wait()
    if not self.Character then return end

    self.Humanoid = self.Character:FindFirstChildOfClass("Humanoid")
    if not self.Humanoid then return end

    self.Animator = self.Humanoid:FindFirstChildOfClass("Animator")
    if not self.Animator then
        self.Animator = Instance.new("Animator")
        self.Animator.Parent = self.Humanoid
    end

    if self.CurrentTrack then
        self.CurrentTrack:Stop()
        self.CurrentTrack:Destroy()
        self.CurrentTrack = nil
    end

    self.AnimationInstance = Instance.new("Animation")
    self.AnimationInstance.AnimationId = self.SelectedAnimationId

    self.CurrentTrack = self.Animator:LoadAnimation(self.AnimationInstance)
    self.CurrentTrack:Play()
end

GameData.REFishCaught.OnClientEvent:Connect(function()
    GameData:PlayFishCaught()
end)

sections.Fishing3:Dropdown({
    Name = "Select Animation FishCaught",
    Search = true,
    Multi = false,
    Required = false,
    Options = GameData.AnimationList,
    Default = "",
    Callback = function(value)
        GameData.SelectedAnimationId = GameData.AnimationMap[value]
    end,
}, "SelectAnimationDropdown")

sections.Fishing3:Toggle({
    Name = "Load Animation",
    Default = false,
    Callback = function(value)

        GameData.AnimationEnabled = value
        GameData.AnimDisabled = value

        if not value and GameData.CurrentTrack then
            GameData.CurrentTrack:Stop()
            GameData.CurrentTrack:Destroy()
            GameData.CurrentTrack = nil
        end

        if value then
            pcall(function()
                GameData.AnimationController:DestroyActiveAnimationTracks()
            end)
        end

        Window:Notify({
            Title = "Animation",
            Description = value
                and "Animation DISABLED"
                or "Animation NORMAL"
        })
    end,
}, "LoadAnimationToggle")
sections.Fishing5:Header({
	Name = "Blatant"
})

-- SETUP NET
GameData.net = GameData.SVC.RS.Packages._Index["sleitnick_net@0.2.0"]:WaitForChild("net")

GameData.RF = {
    ChargeFishingRod = GameData.net:WaitForChild("RF/ChargeFishingRod"),
    RequestFishingMinigameStarted = GameData.net:WaitForChild("RF/RequestFishingMinigameStarted"),
    CancelFishing = GameData.net:WaitForChild("RF/CancelFishingInputs")
}

GameData.RE = {
    FishingCompleted = GameData.net:WaitForChild("RE/FishingCompleted")
}

-- CUTSCENE CONTROLLER
do
    local ok, controller = pcall(function()
        return require(game:GetService("ReplicatedStorage").Controllers.CutsceneController)
    end)

    if ok and controller then
        GameData.cutsceneController = controller
        GameData.originalPlay = controller.Play
        GameData.originalStop = controller.Stop
    end
end

-- ENABLE SKIP SYSTEM
GameData.EnableSkip = function()
    if GameData.cutsceneController then
        if GameData.cutsceneController.ReplicateCutscene then
            GameData.cutsceneController.ReplicateCutscene.OnClientEvent:Connect(function() end)
        end
        if GameData.cutsceneController.StopCutscene then
            GameData.cutsceneController.StopCutscene.OnClientEvent:Connect(function() end)
        end

        GameData.cutsceneController.Play = function() end
        GameData.cutsceneController.Stop = function() end
    end
end

GameData.EnableSkip()

-- GLOBAL CONFIG
_G.BlatantV2 = false
_G.DelayLoopStartV2 = 1.78
_G.DelayCompleteV2 = 0.7

-- FASTEST FUNCTION
GameData.Fastest = function()
    task.spawn(function()
        pcall(function() GameData.RF.CancelFishing:InvokeServer() end)
        pcall(function() GameData.RF.ChargeFishingRod:InvokeServer(workspace:GetServerTimeNow()) end)
        pcall(function() GameData.RF.RequestFishingMinigameStarted:InvokeServer(-1, 0.999) end)

        task.wait(_G.DelayCompleteV2)

        pcall(function() GameData.RE.FishingCompleted:FireServer() end)
    end)
end

-- LOOP START
GameData.startBlatantV2 = function()
    task.spawn(function()
        while _G.BlatantV2 do
            GameData.Fastest()
            task.wait(_G.DelayLoopStartV2)
        end
    end)
end

-- WINDUI
sections.Fishing5:Toggle({
    Name = "Blatant",
    Default = _G.BlatantV2,
    Callback = function(value)
        _G.BlatantV2 = value
        if value then
            GameData.startBlatantV2()
        end

        Window:Notify({
            Title = "Blatant V2",
            Description = value and "Enabled" or "Disabled"
        })
    end,
}, "BlatantV2Toggle")

sections.Fishing5:Input({
    Name = "Delay Cast",
    Placeholder = "1.78 Or 1.9",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        local num = tonumber(input)
        if num then
            _G.DelayLoopStartV2 = num
        end
    end,
}, "DelayCastV2Input")

sections.Fishing5:Input({
    Name = "Delay Complete",
    Placeholder = "0.7 Or 0.8",
    AcceptedCharacters = "Numbers",
    Callback = function(input)
        local num = tonumber(input)
        if num then
            _G.DelayCompleteV2 = num
        end
    end,
}, "DelayCompleteV2Input")
